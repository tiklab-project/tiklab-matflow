(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{173:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DOMAIN_USER_STORE",{enumerable:!0,get:function(){return u.DOMAIN_USER_STORE}}),Object.defineProperty(t,"ORG_STORE",{enumerable:!0,get:function(){return l.ORG_STORE}}),Object.defineProperty(t,"PRIVILEGE_DOMAIN_ROLE_STORE",{enumerable:!0,get:function(){return o.PRIVILEGE_DOMAIN_ROLE_STORE}}),Object.defineProperty(t,"PRIVILEGE_PROJECT_FEATURE_STORE",{enumerable:!0,get:function(){return c.PRIVILEGE_PROJECT_FEATURE_STORE}}),Object.defineProperty(t,"PRIVILEGE_PROJECT_ROLE_STORE",{enumerable:!0,get:function(){return d.PRIVILEGE_PROJECT_ROLE_STORE}}),Object.defineProperty(t,"PRIVILEGE_SYSTEM_STORE",{enumerable:!0,get:function(){return s.PRIVILEGE_SYSTEM_STORE}}),Object.defineProperty(t,"SYSTEM_ROLE_STORE",{enumerable:!0,get:function(){return f.SYSTEM_ROLE_STORE}}),Object.defineProperty(t,"USER_STORE",{enumerable:!0,get:function(){return i.USER_STORE}}),t.privilegeStores=t.orgStores=void 0;var a=n(r(51)),u=r(264),l=r(265),i=r(261),o=r(266),c=r(267),f=r(268),d=r(269),s=r(270);var p,m=(p={},(0,a.default)(p,l.ORG_STORE,new l.OrgStore),(0,a.default)(p,i.USER_STORE,new i.UserStore),(0,a.default)(p,u.DOMAIN_USER_STORE,new u.DomainUserStore),p);t.orgStores=m;var v,g=(v={},(0,a.default)(v,s.PRIVILEGE_SYSTEM_STORE,new s.SystemFeatureStore),(0,a.default)(v,f.SYSTEM_ROLE_STORE,new f.SystemRoleStore),(0,a.default)(v,d.PRIVILEGE_PROJECT_ROLE_STORE,new d.ProjectRoleStore),(0,a.default)(v,c.PRIVILEGE_PROJECT_FEATURE_STORE,new c.ProjectFeatureStore),(0,a.default)(v,o.PRIVILEGE_DOMAIN_ROLE_STORE,new o.DomainRoleStore),v);t.privilegeStores=g},175:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.sort=t.handlerFeaterNode=void 0,Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"user_cn",{enumerable:!0,get:function(){return u.default}});var a=n(r(51)),u=n(r(262)),l=n(r(263));function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.sort((function(e,t){return e.sort-t.sort}))};t.sort=c;t.handlerFeaterNode=function(e){return function e(t,r){for(var n=[],a=0;a<t.length;a++){var u=t[a];if(u.parentFunction===r||u.parentFunction&&u.parentFunction.id===r){var l=o(o({},u),{},{children:[]});l.children=e(t,u.id),0===l.children.length&&delete l.children,n.push(l)}}return c(n),n}(e,null)}},200:function(e){e.exports=JSON.parse('{"orga-common":{"delete":"删除","edit":"编辑","action":"操作","save":"保存","back":"取消","search":"搜索","add":"添加","orga":"组织","name":"名称","detail":"详情","close":"关闭"},"orga-table":{"name":"账号","nickname":"昵称","phone":"手机号","email":"邮箱","org":"部门","account":"帐号","orgaName":"所属机构","password":"初始密码","type":"用户目录","typeChild":"目录二级","thirdparty":"LDAP/AP","internal":"内部目录","dingding":"钉钉","acc":"ACC","wechat":"企业微信","all":"所有"},"adduser-module":{"addUser":"添加用户","editUser":"编辑用户","detailUser":"详情用户","userType":"用户类型","name":"账号","nickname":"昵称","phone":"手机号","email":"邮箱","org":"部门","account":"帐号","orgaName":"所属机构","password":"初始密码","type":"用户目录","typeChild":"目录二级","thirdparty":"LDAP/AP","internal":"内部目录","dingding":"钉钉","acc":"ACC","wechat":"企业微信","all":"所有","userTypeRequired":"用户类型必填!","emailRequired":"邮箱必填!","emailFormat":"邮箱格式不正确!","passwordRequired":"密码必填!","phoneRequired":"手机号必填!","nameRequired":"账号必填!","nicknameRequired":"请输入中昵称!"},"orga-label":{"addUser":"添加用户","orgaName":"机构名称","parentOrg":"上级机构","parentOrgPlaceholder":"请选择上级机构","parentOrgRequired":"上级机构必填!","user":"用户","searchUser":"搜索用户名称","searchUserPhoneEmail":"搜索姓名、手机号、邮箱","searchUserAccount":"搜索用户名、帐号","userType":"用户目录"},"orga-tab":{"all":"全部","in":"内部","out":"外部"},"privilege-feature-name":"功能名称","privilege-feature-code":"功能编码","privilege-add-feature":"添加功能","privilege-orga-name":"组织名称","privilege-add-user":"添加成员","privilege-search":"搜索","privilege-desc":"描述","privilege-user-and-org":"用户名、部门","privilege-user":"用户名","privilege-select-user":"选择用户","privilege-common":{"edit":"编辑","delete":"删除","action":"操作","please-input":"请输入","please-select":"请输入","save":"保存","cancel":"取消"},"privilege-add-node":"新增子节点","privilege-edit-feature":"编辑功能","privilege-point-node":"挂载节点","privilege-point-node-placeholder":"请选择挂载节点","privilege-role":{"addRole":"添加角色","addSystemRole":"添加系统角色","editRole":"编辑角色","roleName":"角色名称","roleDesc":"角色描述","people":"成员","promise":"权限","name":"账号","phone":"手机号","nickname":"昵称","email":"邮箱","type":"类别","orga":"部门","thirdparty":"第三方","internal":"内部","system":"系统","custom":"自定义","org":"组织"}}')},261:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=t.USER_STORE=void 0;var a,u,l,i,o,c,f,d,s,p,m,v,g,b=n(r(37)),y=n(r(117)),h=n(r(97)),O=n(r(84)),E=n(r(83)),w=(n(r(51)),n(r(98))),P=(n(r(99)),r(4)),j=r(6),S=(a=(0,O.default)((function e(){(0,E.default)(this,e),(0,h.default)(this,"userData",u,this),(0,h.default)(this,"getUserList",l,this),(0,h.default)(this,"editUser",i,this),(0,h.default)(this,"addUser",o,this),(0,h.default)(this,"deleteUser",c,this),(0,h.default)(this,"findUserPageAction",f,this),(0,h.default)(this,"createUserAction",d,this),(0,h.default)(this,"updateUserAction",s,this),(0,h.default)(this,"findRolePageAction",p,this),(0,h.default)(this,"deleteRoleUserAction",m,this),(0,h.default)(this,"createRoleUserAction",v,this),(0,h.default)(this,"findRoleUserListAction",g,this)})),u=(0,w.default)(a.prototype,"userData",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,w.default)(a.prototype,"getUserList",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.userData=t}}}),i=(0,w.default)(a.prototype,"editUser",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.userData=e.userData.map((function(e){return e.id===t.id?t:e}))}}}),o=(0,w.default)(a.prototype,"addUser",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.userData=e.userData.concat(t)}}}),c=(0,w.default)(a.prototype,"deleteUser",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.userData=e.userData.filter((function(e){return e.id!==t}))}}}),f=(0,w.default)(a.prototype,"findUserPageAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/user/user/findUserPage",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),d=(0,w.default)(a.prototype,"createUserAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/user/user/createUser",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),s=(0,w.default)(a.prototype,"updateUserAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/user/user/updateUser",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),p=(0,w.default)(a.prototype,"findRolePageAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/role/findRolePage",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),m=(0,w.default)(a.prototype,"deleteRoleUserAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){var n;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("id",t),e.next=4,j.Axios.post("/roleUser/deleteRoleUser",n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),v=(0,w.default)(a.prototype,"createRoleUserAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/roleUser/createRoleUser",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),g=(0,w.default)(a.prototype,"findRoleUserListAction",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t,r){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Axios.post("/roleUser/findRoleUserList",t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),a);t.UserStore=S;t.USER_STORE="userStore"},262:function(e,t,r){"use strict";r.r(t);var n=r(200);t.default=n},263:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(130)),u=r(0),l=r(6),i=function(e){var t=e.code,r=e.systemRoleStore,n=e.domainId,i=r.setSystemPermissionsCodes,o=r.setDomainPermissionsCodes,c=r.systemPermissions,f=r.domainPermissions,d=(0,u.useState)(null),s=(0,a.default)(d,2),p=s[0],m=s[1];return(0,u.useEffect)((function(){var e=new FormData,r=n?"permission/findDomainPermissions":"permission/findPermissions",a=(0,l.getUser)();if(a.userId){if(e.append("userId",a.userId),n){if(f.hasOwnProperty(n))return void m(f[n].includes(t));e.append("domainId",n)}else if(c.length>0)return void m(c.includes(t));l.Axios.post(r,e).then((function(e){e.code||(n?o(n,e.data):i(e.data),m(e.data.includes(t)))}))}}),[]),p};t.default=i},264:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.DomainUserStore=t.DOMAIN_USER_STORE=void 0;var a,u,l,i,o=n(r(37)),c=n(r(117)),f=n(r(97)),d=n(r(84)),s=n(r(83)),p=n(r(51)),m=n(r(98)),v=(n(r(99)),r(4)),g=r(6),b=(a=(0,d.default)((function e(){(0,s.default)(this,e),(0,f.default)(this,"privilegeDomainUsers",u,this),(0,f.default)(this,"getDomainUser",l,this),(0,f.default)(this,"deleteDomainUser",i,this),(0,p.default)(this,"findDmUserPageAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmUser/findDmUserPage",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"deleteDmUserAction",function(){var e=(0,c.default)(o.default.mark((function e(t){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,g.Axios.post("/dmUser/deleteDmUser",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"findDmUserListAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmUser/findDmUserList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"createDmUserAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmUser/createDmUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"findDmRoleUserListAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmRoleUser/findDmRoleUserList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"createDmRoleUserAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmRoleUser/createDmRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"deleteDmRoleUserAction",function(){var e=(0,c.default)(o.default.mark((function e(t){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,g.Axios.post("/dmRoleUser/deleteDmRoleUser",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)(this,"findDmRoleListAction",function(){var e=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Axios.post("/dmRole/findDmRoleList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),u=(0,m.default)(a.prototype,"privilegeDomainUsers",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,m.default)(a.prototype,"getDomainUser",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeDomainUsers=t}}}),i=(0,m.default)(a.prototype,"deleteDomainUser",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeDomainUsers=e.privilegeDomainUsers.filter((function(e){return e.id!==t}))}}}),a);t.DomainUserStore=b;t.DOMAIN_USER_STORE="domainUserStore"},265:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.OrgStore=t.ORG_STORE=void 0;var a,u,l,i,o,c,f,d,s,p,m,v,g,b=n(r(37)),y=n(r(117)),h=n(r(97)),O=n(r(84)),E=n(r(83)),w=n(r(51)),P=n(r(98)),j=(n(r(99)),r(4)),S=r(6);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,w.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=(a=(0,O.default)((function e(){(0,E.default)(this,e),(0,h.default)(this,"treeData",u,this),(0,h.default)(this,"selectData",l,this),(0,h.default)(this,"selectTreeOrgDetail",i,this),(0,h.default)(this,"addTree",o,this),(0,h.default)(this,"editTree",c,this),(0,h.default)(this,"findOpenUserDirListAction",f,this),(0,h.default)(this,"deleteOrgaAction",d,this),(0,h.default)(this,"findOrgaAction",s,this),(0,h.default)(this,"findOrgaTreeAction",p,this),(0,h.default)(this,"deleteUserOrgaAction",m,this),(0,h.default)(this,"findUserOrgaPageAction",v,this),(0,h.default)(this,"updateOrgaSortAction",g,this)})),u=(0,P.default)(a.prototype,"treeData",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,P.default)(a.prototype,"selectData",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),i=(0,P.default)(a.prototype,"selectTreeOrgDetail",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectData=t}}}),o=(0,P.default)(a.prototype,"addTree",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.treeData=e.treeData.map((function(e){return e.children?_(_({},e),{},{children:e.children.concat(t)}):_(_({},e),{},{children:[t]})}))}}}),c=(0,P.default)(a.prototype,"editTree",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.treeData=e.treeData.map((function(e){return e.orgaId===t.orgaId?_(_({},e),t):(e.children=e.children.map((function(e){return e.orgaId===t.orgaId?_(_({},e),t):e})),e)}))}}}),f=(0,P.default)(a.prototype,"findOpenUserDirListAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.default)(b.default.mark((function e(){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.Axios.post("/user/userdir/findOpenList");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),d=(0,P.default)(a.prototype,"deleteOrgaAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,y.default)(b.default.mark((function t(r){var n,a;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("id",r),t.next=4,S.Axios.post("/user/orga/deleteOrga",n);case 4:return(a=t.sent).code||(e.treeData=e.treeData.filter((function(e){if(e.orgaId!==r)return e.children&&e.children.length>0&&(e.children=e.children.filter((function(e){return e.orgaId!==r}))),e}))),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),s=(0,P.default)(a.prototype,"findOrgaAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t){var r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,S.Axios.post("/user/orga/findOrga",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),p=(0,P.default)(a.prototype,"findOrgaTreeAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,y.default)(b.default.mark((function t(r){var n;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.Axios.post("/user/orga/findOrgaTree",r);case 2:return(n=t.sent).code||(e.treeData=n.data),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),m=(0,P.default)(a.prototype,"deleteUserOrgaAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t){var r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,S.Axios.post("/user/userOrga/deleteUserOrga",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),v=(0,P.default)(a.prototype,"findUserOrgaPageAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t){var r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.Axios.post("/user/userOrga/findUserOrgaPage",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),g=(0,P.default)(a.prototype,"updateOrgaSortAction",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,y.default)(b.default.mark((function e(t){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.Axios.post("/user/orga/updateSort",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),a);t.OrgStore=D;t.ORG_STORE="orgStore"},266:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.PRIVILEGE_DOMAIN_ROLE_STORE=t.DomainRoleStore=void 0;var a,u,l,i,o,c,f,d,s,p,m,v,g,b,y,h=n(r(37)),O=n(r(117)),E=n(r(97)),w=n(r(84)),P=n(r(83)),j=(n(r(51)),n(r(98))),S=(n(r(99)),r(4)),k=r(6),_=(a=(0,w.default)((function e(){(0,P.default)(this,e),(0,E.default)(this,"privilegeDomainRole",u,this),(0,E.default)(this,"createDomainRoleAction",l,this),(0,E.default)(this,"deleteDomainRoleAction",i,this),(0,E.default)(this,"findDomainRoleListAction",o,this),(0,E.default)(this,"setDomainRoleAction",c,this),(0,E.default)(this,"findDmUserPageAction",f,this),(0,E.default)(this,"createDmRoleUserAction",d,this),(0,E.default)(this,"createBatchDmRoleUserAction",s,this),(0,E.default)(this,"updateDmRoleUserAction",p,this),(0,E.default)(this,"deleteDmRoleUserAction",m,this),(0,E.default)(this,"findDmRoleUserAction",v,this),(0,E.default)(this,"findDmRoleUserListAction",g,this),(0,E.default)(this,"getAllUserDirAction",b,this),(0,E.default)(this,"findAllUserGroupAction",y,this)})),u=(0,j.default)(a.prototype,"privilegeDomainRole",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,j.default)(a.prototype,"createDomainRoleAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRole/createDmRole",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),i=(0,j.default)(a.prototype,"deleteDomainRoleAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){var r;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,k.Axios.post("/dmRole/deleteDmRole",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),o=(0,j.default)(a.prototype,"findDomainRoleListAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,O.default)(h.default.mark((function t(r){var n;return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.Axios.post("/dmRole/findDmRoleList",r);case 2:return(n=t.sent).code||(e.privilegeDomainRole=n.data),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),c=(0,j.default)(a.prototype,"setDomainRoleAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRole/setdefaultRole",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),f=(0,j.default)(a.prototype,"findDmUserPageAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmUser/findDmUserPage",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),d=(0,j.default)(a.prototype,"createDmRoleUserAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRoleUser/createDmRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),s=(0,j.default)(a.prototype,"createBatchDmRoleUserAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRoleUser/createBatchDmRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),p=(0,j.default)(a.prototype,"updateDmRoleUserAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRoleUser/updateDmRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),m=(0,j.default)(a.prototype,"deleteDmRoleUserAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){var r;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,k.Axios.post("/dmRoleUser/deleteDmRoleUser",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),v=(0,j.default)(a.prototype,"findDmRoleUserAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRoleUser/findDmRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),g=(0,j.default)(a.prototype,"findDmRoleUserListAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,O.default)(h.default.mark((function e(t){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/dmRoleUser/findDmRoleUserList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),b=(0,j.default)(a.prototype,"getAllUserDirAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,O.default)(h.default.mark((function e(){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/user/userdir/findAllList");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),y=(0,j.default)(a.prototype,"findAllUserGroupAction",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,O.default)(h.default.mark((function e(){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Axios.post("/usergroup/findAllGroup");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),a);t.DomainRoleStore=_;t.PRIVILEGE_DOMAIN_ROLE_STORE="privilegeDomainRoleStore"},267:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectFeatureStore=t.PRIVILEGE_PROJECT_FEATURE_STORE=void 0;var a,u,l,i,o,c,f,d=n(r(190)),s=n(r(97)),p=n(r(84)),m=n(r(83)),v=n(r(51)),g=n(r(98)),b=(n(r(99)),r(4));function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,v.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=(a=(0,p.default)((function e(){(0,m.default)(this,e),(0,s.default)(this,"privilegeProjectTreeData",u,this),(0,s.default)(this,"getDmPrivilegeTree",l,this),(0,s.default)(this,"addDmFeature",i,this),(0,s.default)(this,"addDmChildrenFeature",o,this),(0,s.default)(this,"deleteDmFeature",c,this),(0,s.default)(this,"editDmFeature",f,this)})),u=(0,g.default)(a.prototype,"privilegeProjectTreeData",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,g.default)(a.prototype,"getDmPrivilegeTree",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeProjectTreeData=t}}}),i=(0,g.default)(a.prototype,"addDmFeature",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeProjectTreeData.push(t)}}}),o=(0,g.default)(a.prototype,"addDmChildrenFeature",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){e.privilegeProjectTreeData=e.privilegeProjectTreeData.map((function(e){return e.id===r?h(h({},e),{},{children:[t].concat((0,d.default)(e.children))}):e}))}}}),c=(0,g.default)(a.prototype,"deleteDmFeature",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=[];!function e(r,n){r.forEach((function(r,a){r.id!==t.id&&n.push(h(h({},r),{},{children:[]})),r.children&&r.children.length>0&&e(r.children,n[a].children)}))}(e.privilegeProjectTreeData,r),e.privilegeProjectTreeData=r}}}),f=(0,g.default)(a.prototype,"editDmFeature",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=[];!function e(r,n){r.forEach((function(r,a){r.id===t.id?n.push(h(h(h({},r),t),{},{children:[]})):n.push(h(h({},r),{},{children:[]})),r.children&&n[a].children&&e(r.children,n[a].children)}))}(e.privilegeProjectTreeData,r),e.privilegeProjectTreeData=r}}}),a);t.ProjectFeatureStore=O;t.PRIVILEGE_PROJECT_FEATURE_STORE="privilegeProjectFeatureStore"},268:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRoleStore=t.SYSTEM_ROLE_STORE=void 0;var a,u,l,i,o,c,f,d,s,p,m,v,g,b,y,h,O,E,w,P,j,S=n(r(37)),k=n(r(117)),_=n(r(97)),D=n(r(84)),R=n(r(83)),x=(n(r(51)),n(r(98))),I=(n(r(99)),r(4)),A=r(6),U=(a=(0,D.default)((function e(){(0,R.default)(this,e),(0,_.default)(this,"privilegeSystemRole",u,this),(0,_.default)(this,"systemPermissions",l,this),(0,_.default)(this,"domainPermissions",i,this),(0,_.default)(this,"clearAllPermissions",o,this),(0,_.default)(this,"getInitProjectPermissions",c,this),(0,_.default)(this,"getSystemPermissions",f,this),(0,_.default)(this,"getAllUserAction",d,this),(0,_.default)(this,"getUserPageAction",s,this),(0,_.default)(this,"getAllUserDirAction",p,this),(0,_.default)(this,"findRoleListAction",m,this),(0,_.default)(this,"setDefaultRoleAction",v,this),(0,_.default)(this,"deleteRoleAction",g,this),(0,_.default)(this,"deleteRoleUserAction",b,this),(0,_.default)(this,"findAllUserGroupAction",y,this),(0,_.default)(this,"findRoleUserListAction",h,this),(0,_.default)(this,"createRoleUserAction",O,this),(0,_.default)(this,"createBatchRoleUserAction",E,this),(0,_.default)(this,"createBatchRoleUserGroupAction",w,this),(0,_.default)(this,"findRoleUserGroupListAction",P,this),(0,_.default)(this,"deleteRoleUserGroupAction",j,this)})),u=(0,x.default)(a.prototype,"privilegeSystemRole",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,x.default)(a.prototype,"systemPermissions",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=(0,x.default)(a.prototype,"domainPermissions",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),o=(0,x.default)(a.prototype,"clearAllPermissions",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.systemPermissions=[],e.domainPermissions={}}}}),c=(0,x.default)(a.prototype,"getInitProjectPermissions",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e.domainPermissions["".concat(t,"_").concat(r)]&&t&&r){var a={userId:t,domainId:r,globalPublic:n},u={};return(0,A.getUser)()&&(0,A.getUser)().tenant&&(u={tenant:(0,A.getUser)().tenant}),A.Axios.post("/permission/findDomainPermissions",a,u).then((function(n){return n.code||(e.domainPermissions["".concat(t,"_").concat(r)]=n.data),n}))}}}}),f=(0,x.default)(a.prototype,"getSystemPermissions",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=new FormData;r.append("userId",t);var n={};return(0,A.getUser)()&&(0,A.getUser)().tenant&&(n={tenant:(0,A.getUser)().tenant}),A.Axios.post("/permission/findPermissions",r,n).then((function(t){return t.code||(e.systemPermissions=t.data),t}))}}}),d=(0,x.default)(a.prototype,"getAllUserAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,k.default)(S.default.mark((function e(){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/user/user/findAllUser");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),s=(0,x.default)(a.prototype,"getUserPageAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/user/user/findUserPage",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),p=(0,x.default)(a.prototype,"getAllUserDirAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,k.default)(S.default.mark((function e(){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/user/user/findAllList");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),m=(0,x.default)(a.prototype,"findRoleListAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,k.default)(S.default.mark((function t(r){var n;return S.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.Axios.post("/role/findRoleList",r);case 2:(n=t.sent).code||(e.privilegeSystemRole=n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),v=(0,x.default)(a.prototype,"setDefaultRoleAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/role/setdefaultRole",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),g=(0,x.default)(a.prototype,"deleteRoleAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){var r;return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,A.Axios.post("/role/deleteRole",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),b=(0,x.default)(a.prototype,"deleteRoleUserAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){var r;return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,A.Axios.post("/roleUser/deleteRoleUser",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),y=(0,x.default)(a.prototype,"findAllUserGroupAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,k.default)(S.default.mark((function e(){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/usergroup/findAllGroup");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}),h=(0,x.default)(a.prototype,"findRoleUserListAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/roleUser/findRoleUserList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),O=(0,x.default)(a.prototype,"createRoleUserAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t,r){var n;return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("roleId",t),n.append("userId",r),e.next=5,A.Axios.post("/roleUser/pathRoleWithUser",n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}}),E=(0,x.default)(a.prototype,"createBatchRoleUserAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/roleUser/createBatchRoleUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),w=(0,x.default)(a.prototype,"createBatchRoleUserGroupAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/roleUserGroup/createBatchRoleUserGroup",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),P=(0,x.default)(a.prototype,"findRoleUserGroupListAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Axios.post("/roleUserGroup/findRoleUserGroupList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),j=(0,x.default)(a.prototype,"deleteRoleUserGroupAction",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,k.default)(S.default.mark((function e(t){var r;return S.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,A.Axios.post("/roleUserGroup/deleteRoleUserGroup",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),a);t.SystemRoleStore=U;t.SYSTEM_ROLE_STORE="systemRoleStore"},269:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectRoleStore=t.PRIVILEGE_PROJECT_ROLE_STORE=void 0;var a,u,l,i=n(r(97)),o=n(r(84)),c=n(r(83)),f=(n(r(51)),n(r(98))),d=(n(r(99)),r(4)),s=(a=(0,o.default)((function e(){(0,c.default)(this,e),(0,i.default)(this,"privilegeProjectRole",u,this),(0,i.default)(this,"getProjectRoles",l,this)})),u=(0,f.default)(a.prototype,"privilegeProjectRole",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,f.default)(a.prototype,"getProjectRoles",[d.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeProjectRole=t}}}),a);t.ProjectRoleStore=s;t.PRIVILEGE_PROJECT_ROLE_STORE="privilegeProjectRoleStore"},270:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.SystemFeatureStore=t.PRIVILEGE_SYSTEM_STORE=void 0;var a,u,l,i,o,c,f,d,s,p=n(r(37)),m=n(r(117)),v=n(r(190)),g=n(r(97)),b=n(r(84)),y=n(r(83)),h=n(r(51)),O=n(r(98)),E=(n(r(99)),r(4)),w=r(6),P=r(175);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){(0,h.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k=(a=(0,b.default)((function e(){(0,y.default)(this,e),(0,g.default)(this,"privilegeSystemTreeData",u,this),(0,g.default)(this,"addFeature",l,this),(0,g.default)(this,"addChildrenFeature",i,this),(0,g.default)(this,"deleteFeature",o,this),(0,g.default)(this,"editFeature",c,this),(0,g.default)(this,"getFunctionListListAction",f,this),(0,g.default)(this,"updateFunctionSortAction",d,this),(0,g.default)(this,"deleteFunctionAction",s,this)})),u=(0,O.default)(a.prototype,"privilegeSystemTreeData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,O.default)(a.prototype,"addFeature",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.privilegeSystemTreeData.push(t)}}}),i=(0,O.default)(a.prototype,"addChildrenFeature",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){e.privilegeSystemTreeData=e.privilegeSystemTreeData.map((function(e){return e.id===r?S(S({},e),{},{children:[t].concat((0,v.default)(e.children))}):e}))}}}),o=(0,O.default)(a.prototype,"deleteFeature",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=[];!function e(r,n){r.forEach((function(r,a){r.id!==t.id&&n.push(S(S({},r),{},{children:[]})),r.children&&r.children.length>0&&e(r.children,n[a].children)}))}(e.privilegeSystemTreeData,r),e.privilegeSystemTreeData=r}}}),c=(0,O.default)(a.prototype,"editFeature",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=[];!function e(r,n){r.forEach((function(r,a){r.id===t.id?n.push(S(S(S({},r),t),{},{children:[]})):n.push(S(S({},r),{},{children:[]})),r.children&&n[a].children&&e(r.children,n[a].children)}))}(e.privilegeSystemTreeData,r),e.privilegeSystemTreeData=r}}}),f=(0,O.default)(a.prototype,"getFunctionListListAction",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,m.default)(p.default.mark((function t(r){var n,a;return p.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.Axios.post("/function/findFunctionList",r);case 2:return(n=t.sent).code||(a=(0,P.handlerFeaterNode)(n.data),e.privilegeSystemTreeData=a),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),d=(0,O.default)(a.prototype,"updateFunctionSortAction",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,m.default)(p.default.mark((function e(t){return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.Axios.post("/function/updateFunctionSort",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),s=(0,O.default)(a.prototype,"deleteFunctionAction",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,m.default)(p.default.mark((function e(t){var r;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,w.Axios.post("/function/deleteFunction",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),a);t.SystemFeatureStore=k;t.PRIVILEGE_SYSTEM_STORE="privilegeSystemStore"},458:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BaseModal",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"BreadCrumb",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Profile",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"TitleAction",{enumerable:!0,get:function(){return i.default}});var a=n(r(783)),u=n(r(785)),l=n(r(787)),i=n(r(789))},474:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Directory",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"DomainRole",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"DomainUser",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"MenuAction",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"MenuList",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"Orga",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"PrivilegeButton",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"PrivilegeProjectButton",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"ProjectFeature",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"ProjectRole",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"SystemFeature",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"SystemRole",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"UserGroup",{enumerable:!0,get:function(){return o.default}});var a=n(r(781)),u=n(r(796)),l=n(r(800)),i=n(r(813)),o=n(r(817)),c=n(r(823)),f=n(r(543)),d=n(r(829)),s=n(r(831)),p=n(r(837)),m=n(r(842)),v=n(r(847)),g=n(r(850)),b=n(r(632))},543:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(803)).default;t.default=a},562:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(82);var a=n(r(31)),u=n(r(0)),l=r(6);r(791);var i=function(e){var t=e.link,r=e.module,n=(0,l.getUser)(),i=n.ticket?"".concat(t,"?").concat((0,l.parseUserSearchParams)(n)):t;return u.default.createElement("div",{className:"tiklab_mask"},u.default.createElement("p",null,"当前为统一登录模式"),u.default.createElement(a.default,{type:"link",target:"_blank",href:i},"请前往EAS进行",r,"相关操作。"))};t.default=i},632:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(805)).default;t.default=a},634:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(461));r(50);var l=n(r(19));r(81);var i=n(r(34));r(48);var o=n(r(21));r(320);var c=n(r(256));r(82);var f=n(r(31)),d=n(r(325));r(171);var s=n(r(33)),p=n(r(318));r(322);var m=n(r(144)),v=n(r(319));r(45);var g=n(r(23));r(257);var b=n(r(134)),y=n(r(130)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=S(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),O=r(61),E=r(46),w=n(r(635)),P=r(458),j=r(173);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(S=function(e){return e?r:t})(e)}var k=(0,O.inject)(j.PRIVILEGE_DOMAIN_ROLE_STORE)((0,O.observer)((function(e){var t=e.dmRoleDetail,r=e.domainId,n=e.bgroup,a=e.privilegeDomainRoleStore,O=a.deleteDmRoleUserAction,j=a.findDmRoleUserListAction,S=a.getAllUserDirAction,k=(a.findAllUserGroupAction,(0,E.useTranslation)().t,(0,h.useState)([])),_=(0,y.default)(k,2),D=_[0],R=_[1],x=(0,h.useState)(!1),I=(0,y.default)(x,2),A=I[0],U=I[1],T=(0,h.useState)([]),M=(0,y.default)(T,2),z=M[0],C=M[1],F=(0,h.useState)(!1),L=(0,y.default)(F,2),N=(L[0],L[1]),W=(0,h.useState)([]),G=(0,y.default)(W,2),B=(G[0],G[1],(0,h.useState)([])),K=(0,y.default)(B,2),V=K[0],J=K[1],q=[{title:"名称",dataIndex:"name",render:function(e,t){var r=t.user;return h.default.createElement(g.default,null,r.nickname,1===r.type&&h.default.createElement(b.default,null,"管理员用户"))}},{title:"类型",dataIndex:"type",render:function(e,t){t.user;return"用户"}},{title:"操作",dataIndex:"action",width:100,render:function(e,t){var r=t.user;return Q(r.type,t)}}];(0,h.useEffect)((function(){Y()}),[]);var Y=function(){S().then((function(e){e.code||J(e.data)}))};(0,h.useEffect)((function(){t&&H({dmRoleId:t.id})}),[t]);var H=function(e){j(e).then((function(e){if(!e.code){R(e.data);var t=e.data.map((function(e){return e.user})).filter(Boolean).map((function(e){return e.id}));C(t)}}))},$=function(e){O(e).then((function(e){e.code||H({dmRoleId:t.id})}))},Z=h.default.createElement(m.default,{onClick:function(e){"1"===e.key?U(!0):N(!0)}},h.default.createElement(m.default.Item,{key:"1"},h.default.createElement(v.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),"新增用户")),Q=function(e,r){var n=t.businessType,a=[];return 0===n&&a.push(h.default.createElement(s.default,{title:"删除"},h.default.createElement(p.default,{onClick:function(){return $(r.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),n>0&&e<1&&a.push(h.default.createElement(s.default,{title:"删除"},h.default.createElement(p.default,{onClick:function(){return $(r.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),a};return h.default.createElement("div",{className:"tiklab_promisse"},h.default.createElement(o.default,{justify:"space-between"},h.default.createElement(P.TitleAction,{title:"用户(".concat(D.length,")")}),h.default.createElement(c.default,{overlay:Z},h.default.createElement(f.default,{type:"primary"},h.default.createElement(g.default,null,"新增",h.default.createElement(d.default,null))))),h.default.createElement(o.default,null,h.default.createElement(l.default,{span:24,className:"tiklab_dm_promisse_person"},h.default.createElement(i.default,{columns:q,dataSource:D,rowKey:function(e){return e.id},pagination:!1}))),h.default.createElement(w.default,(0,u.default)({},e,{visible:A,onCancel:function(){return U(!1),void H({dmRoleId:t.id})},dmRoleId:t.id,addSelectedRowKeys:z,domainId:r,userDir:V,bgroup:n})))})));t.default=k},635:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(48);var l=n(r(21));r(50);var i=n(r(19));r(80);var o=n(r(26));r(45);var c=n(r(23)),f=n(r(51)),d=n(r(130)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=v(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),p=r(46),m=r(458);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(v=function(e){return e?r:t})(e)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(e){var t=(0,p.useTranslation)().t,r=e.visible,n=e.onCancel,a=e.dmRoleId,f=void 0===a?"":a,v=e.addSelectedRowKeys,g=e.domainId,y=(e.bgroup,e.privilegeDomainRoleStore),h=y.createBatchDmRoleUserAction,O=y.findDmUserPageAction,E=(0,s.useState)([]),w=(0,d.default)(E,2),P=w[0],j=w[1],S=(0,s.useState)([]),k=(0,d.default)(S,2),_=k[0],D=k[1],R=(0,s.useState)(10),x=(0,d.default)(R,1)[0],I=(0,s.useState)(1),A=(0,d.default)(I,2),U=A[0],T=A[1],M=(0,s.useState)(0),z=(0,d.default)(M,2),C=z[0],F=z[1],L={domainId:g,pageParam:{pageSize:x,currentPage:U}},N=(0,s.useState)(L),W=(0,d.default)(N,2),G=W[0],B=W[1];(0,s.useEffect)((function(){K(G)}),[G]),(0,s.useEffect)((function(){j(v)}),[v]);var K=function(e){O(e).then((function(e){e.code||(F(e.data.totalRecord),D(e.data.dataList.map((function(e){return e.user}))))}))},V=function(){B(b(b({},L),{},{pageParam:{pageSize:x,currentPage:1}})),j([]),T(1),F(0),n()},J=[{title:t("privilege-role.name"),dataIndex:"nickname",key:"name",width:"20%",ellipsis:!0,render:function(e,t){return s.default.createElement(c.default,null,s.default.createElement(m.Profile,{userInfo:t})," ",e)}},{title:t("privilege-role.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:t("privilege-role.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:t("privilege-role.org"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0},{title:t("privilege-role.type"),dataIndex:"userType",key:"userType",width:"10%",ellipsis:!0,render:function(e){switch(e){case 2:return t("privilege-role.thirdparty");case 1:return t("privilege-role.internal");default:return"--"}}}],q={selectedRowKeys:P,onChange:function(e){j(e)}};return s.default.createElement(m.BaseModal,{title:t("privilege-select-userList"),visible:r,onOk:function(){h({dmRole:{id:f},domainId:g,userIds:P}).then((function(e){V()}))},onCancel:V,width:1200,destroyOnClose:!0,cancelText:t("privilege-common.cancel"),okText:t("privilege-common.save")},s.default.createElement(l.default,{style:{paddingBottom:16}},s.default.createElement(i.default,{span:24},s.default.createElement(o.default,{placeholder:t("privilege-userList"),onPressEnter:function(e){var t=e.target.value,r=b(b({},G),{},{name:t,pageParam:{pageSize:x,currentPage:1}});B(r)},style:{width:240}}))),s.default.createElement(l.default,null,s.default.createElement(i.default,{span:24},s.default.createElement("div",{style:{width:"100%"}},s.default.createElement(u.default,{columns:J,dataSource:_,rowSelection:q,rowKey:function(e){return e.id},pagination:{current:U,pageSize:x,total:C,onChange:function(e){T(e);var t=b(b({},G),{},{pageParam:{pageSize:x,currentPage:e}});B(t)}}})))))};t.default=y},636:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34)),l=n(r(51)),i=n(r(190)),o=n(r(130));r(259);var c=n(r(68)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),d=r(6);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=c.default.Group,g=function(e){var t=e.roleDetail,r=e.bgroup,n=(0,f.useState)([]),a=(0,o.default)(n,2),l=a[0],s=a[1],p=(0,f.useState)({}),g=(0,o.default)(p,2),b=g[0],y=g[1],h=(0,f.useState)({}),O=(0,o.default)(h,2),E=O[0],w=O[1],P=[{title:"模块",key:"label",width:"30%",render:function(e){return f.default.createElement(c.default,{indeterminate:e.indeterminate,onChange:function(t){return I(e.value,t)},checked:e.checkAll},e.label)}},{title:"功能点",key:"name",render:function(e){return f.default.createElement(v,{options:b[e.value],value:e.checkedList,onChange:function(t){return D(e.value,t)}})}}];(0,f.useEffect)((function(){t&&j()}),[t]);var j=function(){d.Axios.post("/function/findFunctionList",{bgroup:r,type:"2"}).then((function(e){if(!e.code){var r=S(e.data);s(r.result),y(r.resultChild),_(t.role.id,!0,r.result,r.resultChild)}}))},S=function(e){var t=e.map((function(e){return!e.parentFunction&&{value:e.id,label:e.name}})).filter(Boolean),r=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&{value:e.id,label:e.name,parent:e.parentFunction.id}})).filter(Boolean),n=[],a={};return t.forEach((function(e){var t=e.value,u=r.filter((function(e){return e.parent===t}));n.push({value:e.value,label:e.label,indeterminate:!1,checkedList:[],checkAll:!1}),a[e.value]=u})),{result:n,resultChild:a}},k=function(e){var t=e.filter((function(e){return e.function&&e.function.parentFunction})).map((function(e){return{parentID:e.function.parentFunction.id,id:e.function.id}})),r=e.filter((function(e){return!e.function.parentFunction})).map((function(e){return e.function.id})),n={};return r.forEach((function(e){var r=t.map((function(t){if(t.parentID===e)return t.id})).filter(Boolean);n[e]=[].concat((0,i.default)(r),[e])})),n},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u={roleId:e,bgroup:r};d.Axios.post("roleFunction/findRoleFunctionList",u).then((function(e){if(!e.code){var r=k(e.data),u=e.data.reduce((function(e,t){return e[t.function.id]=t.id,e}),{}),i=t?a:b,o=(t?n:l).map((function(e){var t=r[e.value]?r[e.value]:[],n=0===i[e.value].length,a=t.length===i[e.value].length+1&&0!==t.length,u=a?!a:!!t.length&&t.length<i[e.value].length+1;return n&&1===t.length&&(a=!0,u=!1),m(m({},e),{},{checkedList:t,indeterminate:u,checkAll:a})}));w(u),s(o)}}))},D=function(e,t){R(e,t)},R=function(e,t){var r=t,n=l.filter((function(t){return t.value===e}))[0].checkedList,a=r.length<n.length,u=a?x(n,r):x(r,n);if(a)if(n.length>2){var o=u.filter((function(t){return t!==e}));o.map((function(e,t){U(e,t+1===o.length)}))}else{var c=Array.from(new Set(0===r.length?[e].concat((0,i.default)(u)):u));c.map((function(e,t){U(e,t+1===c.length)}))}else{var f=0===n.length?[e].concat((0,i.default)(u)):u;f.map((function(e,t){A(e,t+1===f.length)}))}},x=function(e,t){for(var r=[],n=function(){var n=e[a];t.some((function(e){return e===n}))&&0!==t.length||r.push(n)},a=0;a<e.length;a++)n();return r},I=function(e,t){var r=Object.keys(E),n=r.includes(e),a=r.filter((function(t){return b[e].some((function(e){return e.value===t}))})),u=b[e].filter((function(e){if(!a.some((function(t){return t===e.value})))return e})),l=(!n||0!==b[e].length)&&b[e].length===u.length;if(n||(l=!0,u=b[e]),l)r.includes(e)||(u=[].concat((0,i.default)(u),[{value:e}])),u.length>0?u.map((function(e,t){A(e.value,t+1===u.length)})):A(e,!0);else{if(r.includes(e)){var o=a.map((function(e){return{value:e}}));u=[].concat((0,i.default)(o),[{value:e}])}u.length>0?u.map((function(e,t){U(e.value,t+1===u.length)})):U(e,!0)}},A=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a={role:{id:t.role.id},function:{id:e},bgroup:r};d.Axios.post("roleFunction/createRoleFunction",a).then((function(e){n&&_(t.role.id)}))},U=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=E[e],a=new FormData;a.append("id",n),d.Axios.post("/roleFunction/deleteRoleFunction",a).then((function(e){r&&_(t.role.id)}))};return f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:"tiklab_dm_promisse"},f.default.createElement(u.default,{pagination:!1,columns:P,dataSource:l,rowKey:function(e){return e.value},bordered:!0})))};t.default=g},638:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(661);var u=n(r(633));r(80);var l=n(r(26));r(116);var i=n(r(20)),o=n(r(130)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),f=r(46),d=r(6),s=r(458);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}var m=function(e){var t=e.visible,r=e.cancelAdd,n=e.editData,a=void 0===n?{}:n,p=e.parentId,m=void 0===p?"":p,v=e.urlType,g=void 0===v?"system":v,b=e.data,y=void 0===b?[]:b,h=i.default.useForm(),O=(0,o.default)(h,1)[0],E=(0,f.useTranslation)().t,w=(0,c.useState)([]),P=(0,o.default)(w,2),j=(P[0],P[1]);(0,c.useEffect)((function(){t&&k()}),[t]),(0,c.useEffect)((function(){"{}"!==JSON.stringify(a)&&(O.setFieldsValue({code:a.code}),O.setFieldsValue({name:a.name}),O.setFieldsValue({parent:a.parentFunction?a.parentFunction.id:a.parentFunction})),m&&O.setFieldsValue({parent:m})}),[a,m]);var S,k=function(){var e=new FormData;e.append("type","system"===g?"1":"2"),d.Axios.post("/function/findFunctionListByParentId",e).then((function(e){e.code||j(e.data)}))},_=function(){O.resetFields(),r()};return c.default.createElement(s.BaseModal,{title:"{}"!==JSON.stringify(a)?E("privilege-edit-feature"):E("privilege-add-feature"),visible:t,onOk:function(){O.submit()},onCancel:_,forceRender:!0,destroyOnClose:!0,cancelText:E("privilege-common.cancel"),okText:E("privilege-common.save")},c.default.createElement(i.default,{form:O,onFinish:function(e){if("{}"===JSON.stringify(a)){var t={name:e.name,code:e.code,parentFunction:{id:e.parent},type:"system"===g?"1":"2"};d.Axios.post("/function/createFunction",t).then((function(e){e.code||_()}))}else{var r={id:a.id,name:e.name,code:e.code,parentFunction:{id:e.parent},type:"system"===g?"1":"2"};d.Axios.post("/function/updateFunction",r).then((function(e){e.code||_()}))}},preserve:!1,layout:"vertical"},c.default.createElement(i.default.Item,{label:E("privilege-feature-name"),name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},c.default.createElement(l.default,{placeholder:E("privilege-feature-name")})),c.default.createElement(i.default.Item,{label:E("privilege-feature-code"),name:"code",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},c.default.createElement(l.default,{placeholder:E("privilege-feature-code")})),c.default.createElement(i.default.Item,{label:E("privilege-point-node"),name:"parent"},c.default.createElement(u.default,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:(S=[],function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach((function(t){var u={title:t.name,value:t.id,disabled:n};if(t.id===a.id&&(u.disabled=!0),r.push(u),t.children&&t.children.length>0)return e(t.children,u.children=[],u.disabled)}))}(y,S),S),placeholder:E("privilege-point-node-placeholder"),disabled:m||a.children&&a.children.length>0}))))};t.default=m},639:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(461)),l=n(r(130)),i=n(r(51)),o=n(r(189)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),f=r(567),d=["record","data","index","moveRow","className","style"];function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v="DraggableFeatureBodyRow",g=function(e){var t=e.record,r=(e.data,e.index),n=e.moveRow,a=e.className,i=e.style,s=(0,o.default)(e,d);if(!t)return null;var p=m(m({},t),{},{index:r}),g=(0,c.useRef)(null),b=(0,f.useDrop)({accept:v,collect:function(e){var t=e.getItem()||{},n=t.index;t.sort;return n===r?{}:{isOver:e.isOver(),dropClassName:n<r?" drop-over-downward":" drop-over-upward"}},drop:function(e){var r={dragId:e.id,drag:e,dropId:t.id,drop:m({},t)};n(r)}}),y=(0,l.default)(b,2),h=y[0],O=h.isOver,E=h.dropClassName,w=y[1],P=(0,f.useDrag)({type:v,item:p,collect:function(e){return{isDragging:e.isDragging()}}});return w((0,(0,l.default)(P,2)[1])(g)),c.default.createElement("tr",(0,u.default)({ref:g,className:"".concat(a).concat(O?E:""),style:m({cursor:"move"},i)},s))};t.default=g},640:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.sortNum=t.sort=t.handelPeerFunction=void 0;var a=n(r(51));function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.handelPeerFunction=function(e,t,r,n,a){var u=e.map((function(e){return e.id===t?l(l({},e),{},{sort:a}):e.id===r?l(l({},e),{},{sort:n}):e}));return i(u)};var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.sort((function(e,t){return e.sort-t.sort}))};t.sort=i;t.sortNum=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.sort((function(e,t){return e-t}))}},641:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(80);var u=n(r(26)),l=n(r(51));r(116);var i=n(r(20)),o=n(r(130)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),f=r(46),d=r(6),s=r(458);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e){var t=(0,f.useTranslation)().t,r=e.visible,n=e.cancel,a=e.editData,l=void 0===a?{}:a,p=e.group,m=void 0===p?"system":p,g=e.urlType,b=void 0===g?"system":g;if(!["system","project"].includes(b))throw Error("use RoleAdd Component must have urlType props, value:'system'、 'project'");var y=i.default.useForm(),h=(0,o.default)(y,1)[0];(0,c.useEffect)((function(){h.setFieldsValue({desc:l.desc}),h.setFieldsValue({name:l.name})}),[l]);var O=function(){h.resetFields(),n()};return c.default.createElement(s.BaseModal,{title:"{}"!==JSON.stringify(l)?t("privilege-role.editRole"):t("privilege-role.addRole"),visible:r,onOk:function(){h.submit()},onCancel:O,forceRender:!0,destroyOnClose:!0,cancelText:t("privilege-common.cancel"),okText:t("privilege-common.save")},c.default.createElement(i.default,{form:h,preserve:!1,onFinish:function(e){var t="/role/createRole",r=v(v({},e),{},{group:m,type:"system"===b?"1":"2"});"{}"!==JSON.stringify(l)&&(t="/role/updateRole",r=v(v({},e),{},{group:m,id:l.id,type:"system"===b?"1":"2"})),d.Axios.post(t,r).then((function(e){e.code||O()}))},layout:"vertical"},c.default.createElement(i.default.Item,{label:t("privilege-role.roleName"),name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},c.default.createElement(u.default,{placeholder:t("privilege-role.roleName")})),c.default.createElement(i.default.Item,{label:t("privilege-desc"),name:"desc"},c.default.createElement(u.default,{placeholder:t("privilege-desc")}))))};t.default=g},642:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(461));r(50);var l=n(r(19));r(81);var i=n(r(34)),o=n(r(190));r(48);var c=n(r(21));r(320);var f=n(r(256));r(82);var d=n(r(31)),s=n(r(325));r(171);var p=n(r(33)),m=n(r(318));r(322);var v=n(r(144)),g=n(r(319));r(45);var b=n(r(23));r(257);var y=n(r(134)),h=n(r(130)),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=_(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),E=r(61),w=r(46),P=n(r(643)),j=n(r(644)),S=r(458),k=r(173);function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_=function(e){return e?r:t})(e)}var D=(0,E.inject)(k.SYSTEM_ROLE_STORE)((0,E.observer)((function(e){var t=e.roleDetail,r=e.systemRoleStore,n=r.deleteRoleUserGroupAction,a=r.deleteRoleUserAction,E=r.findAllUserGroupAction,k=r.findRoleUserGroupListAction,_=r.findRoleUserListAction,D=r.getAllUserDirAction,R=((0,w.useTranslation)().t,(0,O.useState)([])),x=(0,h.default)(R,2),I=x[0],A=x[1],U=(0,O.useState)(!1),T=(0,h.default)(U,2),M=T[0],z=T[1],C=(0,O.useState)([]),F=(0,h.default)(C,2),L=F[0],N=F[1],W=(0,O.useState)(!1),G=(0,h.default)(W,2),B=G[0],K=G[1],V=(0,O.useState)([]),J=(0,h.default)(V,2),q=J[0],Y=J[1],H=(0,O.useState)([]),$=(0,h.default)(H,2),Z=$[0],Q=$[1],X=(0,O.useState)([]),ee=(0,h.default)(X,2),te=ee[0],re=ee[1],ne=[{title:"名称",dataIndex:"name",render:function(e,t){var r=t.user,n=t.userGroup;return n?O.default.createElement(b.default,null,n.name,n.type>0&&O.default.createElement(y.default,null,"管理员组")):O.default.createElement(b.default,null,r.nickname,1===r.type&&O.default.createElement(y.default,null,"管理员用户"))}},{title:"类型",dataIndex:"type",render:function(e,t){t.user;return t.userGroup?"用户组":"用户"}},{title:"操作",dataIndex:"action",width:100,render:function(e,t){var r=t.user,n=t.userGroup;return se(n?n.type:r.type,t)}}];(0,O.useEffect)((function(){ae(),fe()}),[]),(0,O.useEffect)((function(){t&&(ue({roleId:t.id}),le({roleId:t.id}))}),[t]);var ae=function(){D().then((function(e){e.code||Q(e.data)}))},ue=function(e){_(e).then((function(e){if(!e.code){A(e.data);var t=e.data.map((function(e){return e.user})).filter(Boolean).map((function(e){return e.id}));N(t)}}))},le=function(e){k(e).then((function(e){e.code||re(e.data)}))},ie=function(e){e.user&&oe(e.id),e.userGroup&&ce(e.id)},oe=function(e){a(e).then((function(e){e.code||ue({roleId:t.id})}))},ce=function(e){n(e).then((function(e){e.code||le({roleId:t.id})}))},fe=function(){E().then((function(e){0===e.code&&Y(e.data)}))},de=O.default.createElement(v.default,{onClick:function(e){"1"===e.key?z(!0):K(!0)}},O.default.createElement(v.default.Item,{key:"1"},O.default.createElement(g.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),"新增用户"),O.default.createElement(v.default.Item,{key:"2"},O.default.createElement(g.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),"新增用户组")),se=function(e,r){var n=t.businessType,a=[];return 0===n&&a.push(O.default.createElement(p.default,{title:"删除"},O.default.createElement(m.default,{onClick:function(){return ie(r)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),n>0&&e<1&&a.push(O.default.createElement(p.default,{title:"删除"},O.default.createElement(m.default,{onClick:function(){return ie(r)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),a};return O.default.createElement("div",{className:"tiklab_projectpromisse"},O.default.createElement(c.default,{justify:"space-between"},O.default.createElement(S.TitleAction,{title:"用户(".concat(I.length,")/用户组(").concat(te.length,")")}),O.default.createElement(f.default,{overlay:de},O.default.createElement(d.default,{type:"primary"},O.default.createElement(b.default,null,"新增",O.default.createElement(s.default,null))))),O.default.createElement(c.default,null,O.default.createElement(l.default,{span:24,className:"tiklab_projectpromisse_person"},O.default.createElement(i.default,{columns:ne,dataSource:[].concat((0,o.default)(te),(0,o.default)(I)),rowKey:function(e){return e.id},pagination:!1}))),O.default.createElement(P.default,(0,u.default)({},e,{visible:M,onCancel:function(){return z(!1),ue({roleId:t.id}),void le({roleId:t.id})},roleId:t.id,addSelectedRowKeys:L,userDir:Z})),O.default.createElement(j.default,{roleId:t.id,onClose:function(){K(!1),ue({roleId:t.id}),le({roleId:t.id})},groupUserList:q,open:B}))})));t.default=D},643:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(50);var u=n(r(19));r(81);var l=n(r(34));r(48);var i=n(r(21));r(80);var o=n(r(26));r(45);var c=n(r(23)),f=n(r(51)),d=n(r(130)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=b(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),p=r(61),m=r(46),v=r(458),g=r(173);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(b=function(e){return e?r:t})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=(0,p.inject)(g.SYSTEM_ROLE_STORE)((0,p.observer)((function(e){var t=(0,m.useTranslation)().t,r=e.visible,n=e.onCancel,a=e.roleId,f=void 0===a?"":a,p=e.addSelectedRowKeys,g=e.systemRoleStore,b=g.createBatchRoleUserAction,y=g.getUserPageAction,O=(0,s.useState)([]),E=(0,d.default)(O,2),w=E[0],P=E[1],j=(0,s.useState)([]),S=(0,d.default)(j,2),k=S[0],_=S[1],D=(0,s.useState)(10),R=(0,d.default)(D,1)[0],x=(0,s.useState)(1),I=(0,d.default)(x,2),A=I[0],U=I[1],T=(0,s.useState)(0),M=(0,d.default)(T,2),z=M[0],C=M[1],F={pageParam:{pageSize:R,currentPage:A}},L=(0,s.useState)(F),N=(0,d.default)(L,2),W=N[0],G=N[1];(0,s.useEffect)((function(){B(W)}),[W]),(0,s.useEffect)((function(){P(p)}),[p]);var B=function(e){y(e).then((function(e){e.code||(C(e.data.totalRecord),_(e.data.dataList))}))},K=function(){G({pageParam:{pageSize:R,currentPage:1}}),P([]),U(1),C(0),n()},V=[{title:t("privilege-role.name"),dataIndex:"nickname",key:"name",width:"20%",ellipsis:!0,render:function(e,t){return s.default.createElement(c.default,null,s.default.createElement(v.Profile,{userInfo:t})," ",e)}},{title:t("privilege-role.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:t("privilege-role.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:t("privilege-role.orga"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0},{title:t("privilege-role.type"),dataIndex:"userType",key:"userType",width:"10%",ellipsis:!0,render:function(e){switch(e){case 2:return t("privilege-role.thirdparty");case 1:return t("privilege-role.internal");default:return"--"}}}],J={selectedRowKeys:w,onChange:function(e){P(e)}};return s.default.createElement(v.BaseModal,{title:t("privilege-select-userList"),visible:r,onOk:function(){b({role:{id:f},userIds:w}).then((function(e){K()}))},onCancel:K,width:1200,destroyOnClose:!0,cancelText:t("privilege-common.cancel"),okText:t("privilege-common.save")},s.default.createElement(i.default,null,s.default.createElement(o.default,{placeholder:t("privilege-userList"),onPressEnter:function(e){var t=e.target.value,r=h(h({},W),{},{name:t,pageParam:{pageSize:R,currentPage:1}});G(r)},style:{width:240}})),s.default.createElement(i.default,null,s.default.createElement(u.default,{span:24},s.default.createElement("div",{style:{width:"100%"}},s.default.createElement(l.default,{columns:V,dataSource:k,rowSelection:J,rowKey:function(e){return e.id},pagination:{current:A,pageSize:R,total:z,onChange:function(e){U(e);var t=h(h({},W),{},{pageParam:{pageSize:R,currentPage:e}});G(t)}}})))))})));t.default=O},644:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(128);var u=n(r(35)),l=n(r(51));r(116);var i=n(r(20)),o=n(r(130)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=m(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),f=r(46),d=r(61),s=r(458),p=r(173);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(m=function(e){return e?r:t})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var g=(0,d.inject)(p.SYSTEM_ROLE_STORE)((0,d.observer)((function(e){var t=e.open,r=e.onClose,n=e.roleId,a=e.groupUserList,d=void 0===a?[]:a,p=e.systemRoleStore,m=p.createBatchRoleUserGroupAction,g=p.findRoleUserGroupListAction,b=i.default.useForm(),y=(0,o.default)(b,1)[0],h=(0,f.useTranslation)().t;(0,c.useEffect)((function(){n&&g({roleId:n}).then((function(e){if(0===e.code){var t=e.data.map((function(e){return e.userGroup.id}));y.setFieldsValue({tagValues:t})}}))}),[n]);var O=function(){y.resetFields(),r()};return c.default.createElement(s.BaseModal,{title:"用户组关联角色",visible:t,onOk:function(){y.submit()},onCancel:O,forceRender:!0,destroyOnClose:!0,cancelText:h("privilege-common.cancel"),okText:h("privilege-common.save")},c.default.createElement(i.default,{form:y,preserve:!1,onFinish:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({role:{id:n}},e);m(t).then((function(e){0===e.code&&O()}))},layout:"vertical"},c.default.createElement(i.default.Item,{label:"用户组",name:"userGroupIds",rules:[{required:!0,message:"选择用户组"}]},c.default.createElement(u.default,{placeholder:"选择用户组",mode:"multiple"},d.map((function(e){return c.default.createElement(u.default.Option,{value:e.id,key:e.id},e.name)}))))))})));t.default=g},645:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34)),l=n(r(51)),i=n(r(190)),o=n(r(130));r(259);var c=n(r(68)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),d=r(6);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=c.default.Group,g=function(e){var t=e.roleDetail,r=(0,f.useState)([]),n=(0,o.default)(r,2),a=n[0],l=n[1],s=(0,f.useState)({}),p=(0,o.default)(s,2),g=p[0],b=p[1],y=(0,f.useState)({}),h=(0,o.default)(y,2),O=h[0],E=h[1],w=[{title:"模块",key:"label",width:"30%",render:function(e){return f.default.createElement(c.default,{indeterminate:e.indeterminate,onChange:function(t){return x(e.value,t)},checked:e.checkAll},e.label)}},{title:"功能点",key:"name",render:function(e){return f.default.createElement(v,{options:g[e.value],value:e.checkedList,onChange:function(t){return _(e.value,t)}})}}];(0,f.useEffect)((function(){t&&P()}),[t]);var P=function(){d.Axios.post("/function/findFunctionList",{type:"2"}).then((function(e){if(!e.code){var r=j(e.data);l(r.result),b(r.resultChild),k(t.id,!0,r.result,r.resultChild)}}))},j=function(e){var t=e.map((function(e){return!e.parentFunction&&{value:e.id,label:e.name}})).filter(Boolean),r=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&{value:e.id,label:e.name,parent:e.parentFunction.id}})).filter(Boolean),n=[],a={};return t.forEach((function(e){var t=e.value,u=r.filter((function(e){return e.parent===t}));n.push({value:e.value,label:e.label,indeterminate:!1,checkedList:[],checkAll:!1}),a[e.value]=u})),{result:n,resultChild:a}},S=function(e){var t=e.filter((function(e){return e.function&&e.function.parentFunction})).map((function(e){return{parentID:e.function.parentFunction.id,id:e.function.id}})),r=e.filter((function(e){return!e.function.parentFunction})).map((function(e){return e.function.id})),n={};return r.forEach((function(e){var r=t.map((function(t){if(t.parentID===e)return t.id})).filter(Boolean);n[e]=[].concat((0,i.default)(r),[e])})),n},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u={roleId:e};d.Axios.post("roleFunction/findRoleFunctionList",u).then((function(e){if(!e.code){var u=S(e.data),i=e.data.reduce((function(e,t){return e[t.function.id]=t.id,e}),{}),o=t?n:g,c=(t?r:a).map((function(e){var t=u[e.value]?u[e.value]:[],r=0===o[e.value].length,n=t.length===o[e.value].length+1&&0!==t.length,a=n?!n:!!t.length&&t.length<o[e.value].length+1;return r&&1===t.length&&(n=!0,a=!1),m(m({},e),{},{checkedList:t,indeterminate:a,checkAll:n})}));E(i),l(c)}}))},_=function(e,t){D(e,t)},D=function(e,t){var r=t,n=a.filter((function(t){return t.value===e}))[0].checkedList,u=r.length<n.length,l=u?R(n,r):R(r,n);if(u)if(n.length>2){var o=l.filter((function(t){return t!==e}));o.map((function(e,t){A(e,t+1===o.length)}))}else{var c=Array.from(new Set(0===r.length?[e].concat((0,i.default)(l)):l));c.map((function(e,t){A(e,t+1===c.length)}))}else{var f=0===n.length?[e].concat((0,i.default)(l)):l;f.map((function(e,t){I(e,t+1===f.length)}))}},R=function(e,t){for(var r=[],n=function(){var n=e[a];t.some((function(e){return e===n}))&&0!==t.length||r.push(n)},a=0;a<e.length;a++)n();return r},x=function(e,t){var r=Object.keys(O),n=r.includes(e),a=r.filter((function(t){return g[e].some((function(e){return e.value===t}))})),u=g[e].filter((function(e){if(!a.some((function(t){return t===e.value})))return e})),l=(!n||0!==g[e].length)&&g[e].length===u.length;if(n||(l=!0,u=g[e]),l)r.includes(e)||(u=[].concat((0,i.default)(u),[{value:e}])),u.length>0?u.map((function(e,t){I(e.value,t+1===u.length)})):I(e,!0);else{if(r.includes(e)){var o=a.map((function(e){return{value:e}}));u=[].concat((0,i.default)(o),[{value:e}])}u.length>0?u.map((function(e,t){A(e.value,t+1===u.length)})):A(e,!0)}},I=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={role:{id:t.id},function:{id:e}};d.Axios.post("roleFunction/createRoleFunction",n).then((function(e){r&&k(t.id)}))},A=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=O[e],a=new FormData;a.append("id",n),d.Axios.post("roleFunction/deleteRoleFunction",a).then((function(e){r&&k(t.id)}))};return f.default.createElement("div",{className:"tiklab_projectpromisse"},f.default.createElement(u.default,{pagination:!1,columns:w,dataSource:a,rowKey:function(e){return e.value},bordered:!0}))};t.default=g},646:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(461));r(50);var l=n(r(19));r(81);var i=n(r(34)),o=n(r(190));r(48);var c=n(r(21));r(320);var f=n(r(256));r(82);var d=n(r(31)),s=n(r(325));r(171);var p=n(r(33)),m=n(r(318));r(322);var v=n(r(144)),g=n(r(319));r(45);var b=n(r(23));r(257);var y=n(r(134)),h=n(r(130)),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=_(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),E=r(61),w=r(46),P=n(r(647)),j=n(r(644)),S=r(458),k=r(173);function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_=function(e){return e?r:t})(e)}var D=(0,E.inject)(k.SYSTEM_ROLE_STORE)((0,E.observer)((function(e){var t=e.roleDetail,r=e.systemRoleStore,n=r.deleteRoleUserGroupAction,a=r.deleteRoleUserAction,E=r.findAllUserGroupAction,k=r.findRoleUserGroupListAction,_=r.findRoleUserListAction,D=r.getAllUserDirAction,R=((0,w.useTranslation)().t,(0,O.useState)([])),x=(0,h.default)(R,2),I=x[0],A=x[1],U=(0,O.useState)(!1),T=(0,h.default)(U,2),M=T[0],z=T[1],C=(0,O.useState)([]),F=(0,h.default)(C,2),L=F[0],N=F[1],W=(0,O.useState)(!1),G=(0,h.default)(W,2),B=G[0],K=G[1],V=(0,O.useState)([]),J=(0,h.default)(V,2),q=J[0],Y=J[1],H=(0,O.useState)([]),$=(0,h.default)(H,2),Z=$[0],Q=$[1],X=(0,O.useState)([]),ee=(0,h.default)(X,2),te=ee[0],re=ee[1],ne=[{title:"名称",dataIndex:"name",render:function(e,t){var r=t.user,n=t.userGroup;return n?O.default.createElement(b.default,null,n.name,n.type>0&&O.default.createElement(y.default,null,"管理员组")):O.default.createElement(b.default,null,r.nickname,1===r.type&&O.default.createElement(y.default,null,"管理员用户"))}},{title:"类型",dataIndex:"type",render:function(e,t){t.user;return t.userGroup?"用户组":"用户"}},{title:"操作",dataIndex:"action",width:100,render:function(e,t){var r=t.user,n=t.userGroup;return se(n?n.type:r.type,t)}}];(0,O.useEffect)((function(){ae(),fe()}),[]),(0,O.useEffect)((function(){t&&(le({roleId:t.id}),ue({roleId:t.id}))}),[t]);var ae=function(){D().then((function(e){e.code||Q(e.data)}))},ue=function(e){k(e).then((function(e){e.code||re(e.data)}))},le=function(e){_(e).then((function(e){if(!e.code){A(e.data);var t=e.data.map((function(e){return e.user})).filter(Boolean).map((function(e){return e.id}));N(t)}}))},ie=function(e){e.user&&oe(e.id),e.userGroup&&ce(e.id)},oe=function(e){a(e).then((function(e){e.code||le({roleId:t.id})}))},ce=function(e){n(e).then((function(e){e.code||ue({roleId:t.id})}))},fe=function(){E().then((function(e){0===e.code&&Y(e.data)}))},de=O.default.createElement(v.default,{onClick:function(e){"1"===e.key?z(!0):K(!0)}},O.default.createElement(v.default.Item,{key:"1"},O.default.createElement(g.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),"新增用户"),O.default.createElement(v.default.Item,{key:"2"},O.default.createElement(g.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),"新增用户组")),se=function(e,r){var n=t.businessType,a=[];return 0===n&&a.push(O.default.createElement(p.default,{title:"删除"},O.default.createElement(m.default,{onClick:function(){return ie(r)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),n>0&&e<1&&a.push(O.default.createElement(p.default,{title:"删除"},O.default.createElement(m.default,{onClick:function(){return ie(r)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),a};return O.default.createElement("div",{className:"tiklab_promisse"},O.default.createElement(c.default,{justify:"space-between"},O.default.createElement(S.TitleAction,{title:"用户(".concat(I.length,")/用户组(").concat(te.length,")")}),O.default.createElement(f.default,{overlay:de},O.default.createElement(d.default,{type:"primary"},O.default.createElement(b.default,null,"新增",O.default.createElement(s.default,null))))),O.default.createElement(c.default,null,O.default.createElement(l.default,{span:24,className:"tiklab_promisse_person"},O.default.createElement(i.default,{columns:ne,dataSource:[].concat((0,o.default)(te),(0,o.default)(I)),rowKey:function(e){return e.id},pagination:!1}))),O.default.createElement(P.default,(0,u.default)({},e,{visible:M,onCancel:function(){return z(!1),le({roleId:t.id}),void ue({roleId:t.id})},roleId:t.id,addSelectedRowKeys:L,userDir:Z})),O.default.createElement(j.default,{roleId:t.id,onClose:function(){K(!1),le({roleId:t.id}),ue({roleId:t.id})},groupUserList:q,open:B}))})));t.default=D},647:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(48);var l=n(r(21));r(50);var i=n(r(19));r(80);var o=n(r(26));r(45);var c=n(r(23)),f=n(r(51)),d=n(r(130)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=b(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),p=r(46),m=r(61),v=r(458),g=r(173);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(b=function(e){return e?r:t})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=(0,m.inject)(g.SYSTEM_ROLE_STORE)((0,m.observer)((function(e){var t=(0,p.useTranslation)().t,r=e.visible,n=e.onCancel,a=e.roleId,f=void 0===a?"":a,m=e.addSelectedRowKeys,g=e.userDir,b=e.systemRoleStore,y=b.createBatchRoleUserAction,O=b.getUserPageAction,E=(0,s.useState)([]),w=(0,d.default)(E,2),P=w[0],j=w[1],S=(0,s.useState)([]),k=(0,d.default)(S,2),_=k[0],D=k[1],R=(0,s.useState)(10),x=(0,d.default)(R,1)[0],I=(0,s.useState)(1),A=(0,d.default)(I,2),U=A[0],T=A[1],M=(0,s.useState)(0),z=(0,d.default)(M,2),C=z[0],F=z[1],L=(0,s.useState)({pageParam:{pageSize:x,currentPage:U}}),N=(0,d.default)(L,2),W=N[0],G=N[1];(0,s.useEffect)((function(){B(W)}),[W]),(0,s.useEffect)((function(){j(m)}),[m]);var B=function(e){O(e).then((function(e){e.code||(F(e.data.totalRecord),D(e.data.dataList))}))},K=function(){G({pageParam:{pageSize:x,currentPage:1}}),j([]),T(1),F(0),n()},V=[{title:t("privilege-role.name"),dataIndex:"nickname",key:"name",width:"20%",ellipsis:!0,render:function(e,t){return s.default.createElement(c.default,null,s.default.createElement(v.Profile,{userInfo:t})," ",e)}},{title:t("privilege-role.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:t("privilege-role.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:t("privilege-role.org"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0},{title:t("privilege-role.type"),dataIndex:"userType",key:"userType",width:"10%",ellipsis:!0,render:function(e){var t=g.findIndex((function(t){return t.id===e}));return t>-1?g[t].name:"--"}}],J={selectedRowKeys:P,onChange:function(e){j(e)}};return s.default.createElement(v.BaseModal,{title:t("privilege-select-userList"),visible:r,onOk:function(){y({role:{id:f},userIds:P}).then((function(e){K()}))},onCancel:K,width:1200,cancelText:t("privilege-common.cancel"),okText:t("privilege-common.save")},s.default.createElement(l.default,{style:{paddingBottom:16}},s.default.createElement(i.default,{span:24},s.default.createElement(o.default,{placeholder:t("privilege-userList"),width:240,onPressEnter:function(e){var t=e.target.value,r=h(h({},W),{},{name:t,pageParam:{pageSize:x,currentPage:1}});G(r)},style:{width:240}}))),s.default.createElement(l.default,null,s.default.createElement(i.default,{span:24},s.default.createElement("div",{style:{width:"100%"}},s.default.createElement(u.default,{columns:V,dataSource:_,rowSelection:J,rowKey:function(e){return e.id},pagination:{current:U,pageSize:x,total:C,onChange:function(e){T(e);var t=h(h({},W),{},{pageParam:{pageSize:x,currentPage:e}});G(t)}}})))))})));t.default=O},648:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34)),l=n(r(51)),i=n(r(190)),o=n(r(130));r(259);var c=n(r(68)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),d=r(6);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=c.default.Group,g=function(e){var t=e.roleDetail,r=e.group,n=(0,f.useState)([]),a=(0,o.default)(n,2),l=a[0],s=a[1],p=(0,f.useState)({}),g=(0,o.default)(p,2),b=g[0],y=g[1],h=(0,f.useState)({}),O=(0,o.default)(h,2),E=O[0],w=O[1],P=[{title:"模块",key:"label",width:"30%",render:function(e){return f.default.createElement(c.default,{indeterminate:e.indeterminate,onChange:function(t){return I(e.value,t)},checked:e.checkAll},e.label)}},{title:"功能点",key:"name",render:function(e){return f.default.createElement(v,{options:b[e.value],value:e.checkedList,onChange:function(t){return D(e.value,t)}})}}];(0,f.useEffect)((function(){t&&j()}),[t]);var j=function(){d.Axios.post("/function/findFunctionList",{group:r}).then((function(e){if(!e.code){var r=S(e.data);s(r.result),y(r.resultChild),_(t.id,!0,r.result,r.resultChild)}}))},S=function(e){var t=e.map((function(e){return!e.parentFunction&&{value:e.id,label:e.name}})).filter(Boolean),r=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&{value:e.id,label:e.name,parent:e.parentFunction.id}})).filter(Boolean),n=[],a={};return t.forEach((function(e){var t=e.value,u=r.filter((function(e){return e.parent===t}));n.push({value:e.value,label:e.label,indeterminate:!1,checkedList:[],checkAll:!1}),a[e.value]=u})),{result:n,resultChild:a}},k=function(e){var t=e.filter((function(e){return e.function&&e.function.parentFunction})).map((function(e){return{parentID:e.function.parentFunction.id,id:e.function.id}})),r=e.filter((function(e){return!e.function.parentFunction})).map((function(e){return e.function.id})),n={};return r.forEach((function(e){var r=t.map((function(t){if(t.parentID===e)return t.id})).filter(Boolean);n[e]=[].concat((0,i.default)(r),[e])})),n},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a={roleId:e};d.Axios.post("roleFunction/findRoleFunctionList",a).then((function(e){if(!e.code){var a=k(e.data),u=e.data.reduce((function(e,t){return e[t.function.id]=t.id,e}),{}),i=t?n:b,o=(t?r:l).map((function(e){var t=a[e.value]?a[e.value]:[],r=0===i[e.value].length,n=t.length===i[e.value].length+1&&0!==t.length,u=n?!n:!!t.length&&t.length<i[e.value].length+1;return r&&1===t.length&&(n=!0,u=!1),m(m({},e),{},{checkedList:t,indeterminate:u,checkAll:n})}));w(u),s(o)}}))},D=function(e,t){R(e,t)},R=function(e,t){var r=t,n=l.filter((function(t){return t.value===e}))[0].checkedList,a=r.length<n.length,u=a?x(n,r):x(r,n);if(a)if(n.length>2){var o=u.filter((function(t){return t!==e}));o.map((function(e,t){U(e,t+1===o.length)}))}else{var c=Array.from(new Set(0===r.length?[e].concat((0,i.default)(u)):u));c.map((function(e,t){U(e,t+1===c.length)}))}else{var f=0===n.length?[e].concat((0,i.default)(u)):u;f.map((function(e,t){A(e,t+1===f.length)}))}},x=function(e,t){for(var r=[],n=function(){var n=e[a];t.some((function(e){return e===n}))&&0!==t.length||r.push(n)},a=0;a<e.length;a++)n();return r},I=function(e,t){var r=Object.keys(E),n=r.includes(e),a=r.filter((function(t){return b[e].some((function(e){return e.value===t}))})),u=b[e].filter((function(e){if(!a.some((function(t){return t===e.value})))return e})),l=(!n||0!==b[e].length)&&b[e].length===u.length;if(n||(l=!0,u=b[e]),l)r.includes(e)||(u=[].concat((0,i.default)(u),[{value:e}])),u.length>0?u.map((function(e,t){A(e.value,t+1===u.length)})):A(e,!0);else{if(r.includes(e)){var o=a.map((function(e){return{value:e}}));u=[].concat((0,i.default)(o),[{value:e}])}u.length>0?u.map((function(e,t){U(e.value,t+1===u.length)})):U(e,!0)}},A=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={role:{id:t.id},function:{id:e}};d.Axios.post("roleFunction/createRoleFunction",n).then((function(e){r&&_(t.id)}))},U=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=E[e],a=new FormData;a.append("id",n),d.Axios.post("roleFunction/deleteRoleFunction",a).then((function(e){r&&_(t.id)}))};return f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:"tiklab_promisse"},f.default.createElement(u.default,{pagination:!1,columns:P,dataSource:l,rowKey:function(e){return e.value},bordered:!0})))};t.default=g},781:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(782)).default;t.default=a},782:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(50);var u=n(r(19));r(171);var l=n(r(33)),i=n(r(350));r(48);var o=n(r(21));r(82);var c=n(r(31));r(45);var f=n(r(23));r(52);var d=n(r(49)),s=n(r(130)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=y(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),m=r(176),v=r(6),g=r(458),b=n(r(562));function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(y=function(e){return e?r:t})(e)}r(792);var h=[{id:2,name:"LDAP",desc:"同步LDAP用户以及组织架构",icon:r(793)},{id:3,name:"钉钉",desc:"同步企业微信用户以及组织架构",icon:r(794)},{id:4,name:"企业微信",desc:"同步企业微信用户以及组织架构",icon:r(795)}],O=function(e){var t=e.router,r=void 0===t?"/setting/dir":t,n=(0,p.useState)([]),a=(0,s.default)(n,2),y=a[0],O=a[1],E=(0,m.useHasPointPlugin)("directory"),w=localStorage.getItem(v.LOCALSTORAGE_KEY.AUTH_CONFIG);if(w){var P=JSON.parse(w);if(!P.authType&&-1===P.appName.indexOf("eas")){var j=P.authUrl+"/#"+r;return p.default.createElement(b.default,{module:"用户目录",link:j})}}(0,p.useEffect)((function(){return S(),function(){return O([])}}),[]);var S=function(){var e={ids:["1"]};try{"mult"===tenant_type&&(e={ids:["0","1"]})}catch(t){e={ids:["1"]}}v.Axios.post("/user/userdir/findDirByIds",e).then((function(e){if(!e.code){var t=e.data;O(t)}}))};return p.default.createElement("div",{className:"directory"},p.default.createElement(o.default,{className:"directory-wrap"},p.default.createElement(u.default,{span:24},p.default.createElement(g.TitleAction,{title:"用户目录"}),p.default.createElement("div",{className:"directory_content"},y.map((function(e){return p.default.createElement(o.default,{justify:"space-between",align:"middle",key:e.id,style:{padding:16}},p.default.createElement("div",{className:"directory_content_item"},p.default.createElement(d.default,{size:64}),p.default.createElement("div",{className:"directory_content_item_title"},p.default.createElement(f.default,{direction:"vertical"},p.default.createElement("div",null,e.name),p.default.createElement("p",{className:"directory_content_desc"},"这是一个描述内容")))),p.default.createElement(f.default,null,p.default.createElement(c.default,{disabled:!0},"同步数据"),p.default.createElement(c.default,{disabled:!0},"开启"),p.default.createElement(c.default,{disabled:!0},"禁止"),p.default.createElement(c.default,{disabled:!0},"配置")))})),E?p.default.createElement(m.RemoteComponent,{point:"directory",isModalType:!0}):p.default.createElement(p.default.Fragment,null,h.map((function(e){return p.default.createElement(o.default,{justify:"space-between",align:"middle",key:e.id,style:{padding:16}},p.default.createElement("div",{className:"directory_content_item"},p.default.createElement(d.default,{size:64,src:e.icon.default}),p.default.createElement("div",{className:"directory_content_item_title"},p.default.createElement(f.default,{direction:"vertical"},p.default.createElement(f.default,null,p.default.createElement("div",null,e.name),p.default.createElement(l.default,{placement:"topRight",title:"增强功能需要去官网购买Licence"},p.default.createElement(i.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}))),p.default.createElement("p",{className:"directory_content_desc"},e.desc)))),p.default.createElement(f.default,null,p.default.createElement(c.default,{disabled:!0},"同步数据"),p.default.createElement(c.default,{disabled:!0},"开启"),p.default.createElement(c.default,{disabled:!0},"禁止"),p.default.createElement(c.default,{disabled:!0},"配置")))})))))))};t.default=O},783:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(111);var a=n(r(95)),u=n(r(461)),l=n(r(189)),i=n(r(0));r(784);var o=["children","title","width"],c=function(e){var t=e.children,r=e.title,n=e.width,c=(0,l.default)(e,o);return i.default.createElement(a.default,(0,u.default)({title:r,width:n,style:{maxWidth:"calc(100vw - 120px)",maxHeight:"calc(100vh - 120px)",marginRight:"auto",marginLeft:"auto",position:"absolute",top:60,right:0,left:0,height:"100%",display:"flex",flexDirection:"column"},wrapClassName:"tiklab_modal",closable:!1},c),t)};t.default=c},784:function(e,t,r){"use strict";r.r(t)},785:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(55);var a=n(r(53));r(45);var u=n(r(23)),l=n(r(236)),i=n(r(0)),o=r(36);r(786);var c=function(e){var t=e.routes,r=e.children;return i.default.createElement("div",{className:"privilege-breadcrumb"},i.default.createElement(a.default,{itemRender:function(e,t,r){var n=r.indexOf(e)===r.length-1,a=0===r.indexOf(e);return e.disabled?i.default.createElement("span",null,e.breadcrumbName):a?e.click?i.default.createElement(u.default,null,i.default.createElement(l.default,{onClick:function(){return e.click()},style:{fontSize:"var(--tiklab-font-16)"}}),e.breadcrumbName):i.default.createElement(o.Link,{to:e.path},i.default.createElement(u.default,null,i.default.createElement(l.default,{style:{fontSize:"var(--tiklab-font-16)"}}),e.breadcrumbName)):n?i.default.createElement("span",null,e.breadcrumbName):e.click?i.default.createElement("a",{onClick:function(){return e.click()},style:{cursor:"pointer"}},e.breadcrumbName):e.path?i.default.createElement(o.Link,{to:e.path},e.breadcrumbName):i.default.createElement(i.default.Fragment,null,e.breadcrumbName)},routes:t}),r)};t.default=c},786:function(e,t,r){"use strict";r.r(t)},787:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(380));r(52);var u=n(r(49)),l=n(r(0)),i=r(6);r(788);var o=function(e){var t=e.userInfo,r=void 0===t?void 0:t,n=r||(0,i.getUser)();return l.default.createElement("div",{className:"tiklab-profile"},n.avatar&&"null"!==n.avatar?l.default.createElement(u.default,{src:n.avatar}):n.nickname&&"null"!==n.nickname?l.default.createElement(u.default,null,n.nickname.substring(0,1)):n.name&&"null"!==n.name?l.default.createElement(u.default,null,n.name.substring(0,1)):l.default.createElement(u.default,{size:32,icon:l.default.createElement(a.default,null)}))};t.default=o},788:function(e,t,r){"use strict";r.r(t)},789:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(48);var a=n(r(21));r(50);var u=n(r(19));r(45);var l=n(r(23)),i=n(r(0));r(790);var o=function(e){var t=e.title,r=e.icon,n=e.children,o=e.style,c=void 0===o?{}:o;return i.default.createElement(a.default,null,i.default.createElement(u.default,{span:24},i.default.createElement("div",{className:"tiklab_title",style:c},i.default.createElement(l.default,null,r,i.default.createElement("span",null,t)),n)))};t.default=o},790:function(e,t,r){"use strict";r.r(t)},791:function(e,t,r){"use strict";r.r(t)},792:function(e,t,r){"use strict";r.r(t)},793:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/ldap.jpeg"},794:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/dingding.jpeg"},795:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/qywechat.jpeg"},796:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(797)).default;t.default=a},797:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37)),l=n(r(461));r(50);var i=n(r(19));r(81);var o=n(r(34));r(48);var c=n(r(21));r(80);var f=n(r(26)),d=n(r(321));r(128);var s=n(r(35));r(82);var p=n(r(31)),m=n(r(319)),v=n(r(51)),g=n(r(117)),b=n(r(318));r(171);var y=n(r(33)),h=n(r(381));r(45);var O=n(r(23));r(116);var E=n(r(20)),w=n(r(130)),P=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=I(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),j=r(61),S=r(6),k=r(46),_=r(458),D=r(173),R=n(r(798));r(799);var x=r(4);function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(I=function(e){return e?r:t})(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,v.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T=(0,j.inject)(D.DOMAIN_USER_STORE,D.USER_STORE)((0,j.observer)((function(e){var t=e.domainId,r=e.domainUserStore,n=e.userStore,a=e.bgroup,v=void 0===a?"eas":a,j=r.getDomainUser,D=r.deleteDomainUser,I=r.privilegeDomainUsers,A=r.createDmRoleUserAction,T=r.deleteDmRoleUserAction,M=r.deleteDmUserAction,z=r.findDmRoleListAction,C=r.findDmRoleUserListAction,F=r.findDmUserPageAction,L=n.createRoleUserAction,N=(0,k.useTranslation)().t,W=E.default.useForm(),G=(0,w.default)(W,1)[0],B=(0,P.useState)([]),K=(0,w.default)(B,2),V=K[0],J=K[1],q=(0,P.useState)({}),Y=(0,w.default)(q,2),H=Y[0],$=Y[1],Z=(0,P.useState)(!1),Q=(0,w.default)(Z,2),X=Q[0],ee=Q[1],te=(0,P.useState)([]),re=(0,w.default)(te,2),ne=re[0],ae=re[1],ue=(0,P.useState)(!1),le=(0,w.default)(ue,2),ie=le[0],oe=le[1],ce=(0,P.useState)(""),fe=(0,w.default)(ce,2),de=fe[0],se=fe[1],pe=(0,P.useState)(10),me=(0,w.default)(pe,1)[0],ve=(0,P.useState)(1),ge=(0,w.default)(ve,2),be=ge[0],ye=ge[1],he=(0,P.useState)(0),Oe=(0,w.default)(he,2),Ee=Oe[0],we=Oe[1],Pe=(0,P.useState)({domainId:t,pageParam:{pageSize:me,currentPage:be}}),je=(0,w.default)(Pe,2),Se=je[0],ke=je[1],_e=[{title:N("orga-table.nickname"),dataIndex:["user","nickname"],key:"nickname",width:"20%",render:function(e,t){return P.default.createElement(O.default,null,P.default.createElement(_.Profile,{userInfo:t})," ",e)}},{title:N("orga-table.name"),dataIndex:["user","name"],key:"name",width:"10%"},{title:N("orga-table.org"),dataIndex:["user","org"],key:"org",width:"20%"},{title:"角色",dataIndex:"role",key:"role",width:"20%",render:function(e,t){var r=t.roleList;return P.default.createElement(O.default,null,r.map((function(e){return P.default.createElement("span",{key:e.id},e.dmRole.role.name)})))}},{title:N("orga-table.type"),dataIndex:["user","dirId"],key:"dirId",width:"15%",render:function(e){var t=ne.findIndex((function(t){return t.id===e}));return t>-1?ne[t].name:"--"}},{title:N("orga-common.action"),key:"action",width:"10%",render:function(e,t){return P.default.createElement(O.default,{size:"middle"},P.default.createElement(y.default,{title:"角色修改"},P.default.createElement(h.default,{onClick:function(){return Ue(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),P.default.createElement(y.default,{title:"删除"},P.default.createElement(b.default,{onClick:function(){return Te(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}],De=(0,P.useRef)(null);(0,P.useEffect)((function(){Re(),Ae()}),[]),(0,P.useEffect)((function(){return De.current=!0,xe(Se),function(){De.current=!1}}),[Se]);var Re=function(){S.Axios.post("/user/userdir/findAllList").then((function(e){e.code||ae(e.data)}))},xe=function(e){F(e).then(function(){var e=(0,g.default)(u.default.mark((function e(t){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code||!De.current){e.next=6;break}return we(t.data.totalRecord),e.next=4,Promise.all(Ie(t.data.dataList));case 4:r=e.sent,j(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Ie=function(e){return e.map(function(){var e=(0,g.default)(u.default.mark((function e(r){var n,a,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],a={domainId:t,userId:r.user.id},e.next=4,C(a);case 4:return(l=e.sent).code||(n=l.data.map((function(e){var t=e.dmRole,r=e.role;return{dmRole:U(U({},t),{},{role:r}),roleUserId:e.id}}))),e.abrupt("return",U(U({},r),{},{roleList:n}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Ae=function(){z({domainId:t}).then((function(e){e.code||J(e.data)}))},Ue=function(e){var t=e.roleList;G.setFieldsValue({role:t.map((function(e){return e.dmRole.id}))}),$(e),ee(!0)},Te=function(e){M(e).then((function(t){t.code||(D(e),Ee-1<me*(be-1)+1&&(ye(1===be?1:be-1),ke({pageParam:{pageSize:me,currentPage:1===be?1:be-1}})),we(Ee-1))}))},Me=function(){oe(!1),xe(Se)},ze=function(){G.resetFields(),ee(!1),xe(Se)},Ce=function(e){var t=e.map((function(e){return T(e)}));return Promise.all(t)},Fe=function(e,r){var n={bgroup:v,userId:r,domainId:t};if(Array.isArray(e)){var a=e.map((function(e){var t=U(U({},n),{},{dmRole:{id:e}});return A(t)}));Promise.all(a).then((function(e){ze()}))}else n=U(U({},n),{},{dmRole:{id:e}}),L(n).then((function(e){0===e.code&&ze()}))};return P.default.createElement("div",{className:"privilege-domain-user"},P.default.createElement("div",{className:"privilege-domain-userList-content"},P.default.createElement(_.TitleAction,{title:"项目用户",style:{paddingLeft:8}},P.default.createElement(p.default,{onClick:function(){return oe(!0)},icon:P.default.createElement(m.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),type:"primary"},N("orga-label.addUser"))),P.default.createElement(c.default,{style:{paddingBottom:"var(--tiklab-padding-item)",paddingLeft:8},justify:"space-between"},P.default.createElement(O.default,null,P.default.createElement(s.default,{placeholder:"用户目录",defaultValue:"-1",style:{width:"240px"}},P.default.createElement(s.default.Option,{key:"-1",value:"-1"},"用户目录"),ne.map((function(e){return P.default.createElement(s.default.Option,{key:e.id,value:e.id},e.name)}))),P.default.createElement(f.default,{placeholder:N("orga-label.searchUserPhoneEmail"),value:de,onChange:function(e){return se(e.target.value)},onPressEnter:function(e){return function(e){ye(1);var t=U(U({},Se),{},{pageParam:{pageSize:me,currentPage:1}});e.target.value?t.name=e.target.value:delete t.name,ke(t)}(e)},prefix:P.default.createElement(d.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),style:{width:"240px"}}))),P.default.createElement(c.default,null,P.default.createElement(i.default,{span:24},P.default.createElement(o.default,{columns:_e,dataSource:I,rowKey:function(e){return e.id},tableLayout:"fixed",pagination:{current:be,pageSize:me,total:Ee,showSizeChanger:!1,position:["bottomCenter"]},onChange:function(e,t,r){return function(e,t,r){var n=[];ye(e.current),Array.isArray(r)?n=r.map((function(e){return{name:e.field,sortType:void 0!==e.order?"ascend"===e.order?"asc":"desc":void 0}})):r.field&&n.push({name:r.field,sortType:void 0!==r.order?"ascend"===r.order?"asc":"desc":void 0});var a=U(U({},Se),{},{orderParams:n,pageParam:{pageSize:me,currentPage:e.current}});ke(a)}(e,0,r)}})))),(0,P.useMemo)((function(){return P.default.createElement(R.default,(0,l.default)({},e,{domainId:t,visible:ie,params:Se,onCancel:Me}))}),[ie]),P.default.createElement(_.BaseModal,{title:"修改角色",visible:X,onOk:function(){G.submit()},onCancel:ze,destroyOnClose:!0,cancelText:N("orga-common.back"),okText:N("orga-common.save")},P.default.createElement(E.default,{form:G,onFinish:function(e){var t=(0,x.toJS)(H),r=t.user.id,n=(t.roleList||[]).map((function(e){return e.dmRole.id})),a=e.role,u=n.filter((function(e){return!a.includes(e)})),l=(t.roleList||[]).map((function(e){if(u.includes(e.dmRole.id))return e.roleUserId})).filter(Boolean);0===l.length?Fe(a,r):Ce(l).then((function(){Fe(a,r)}))},preserve:!1,layout:"vertical"},P.default.createElement(E.default.Item,{label:"角色",name:"role",rules:[{required:!0,message:N("adduser-module.userTypeRequired")}]},P.default.createElement(s.default,{mode:"multiple"},V.map((function(e){return P.default.createElement(s.default.Option,{key:e.id,value:e.id},e.role.name)})))))))})));t.default=T},798:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(48);var l=n(r(21));r(50);var i=n(r(19));r(80);var o=n(r(26)),c=n(r(321)),f=n(r(51));r(67);var d=n(r(18));r(45);var s=n(r(23)),p=n(r(130)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=y(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),v=r(458),g=r(6),b=r(46);function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(y=function(e){return e?r:t})(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){i=!0,u=e},f:function(){try{l||null==r.return||r.return()}finally{if(i)throw u}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P=function(e){var t=(0,b.useTranslation)().t,r=e.visible,n=e.onCancel,a=e.domainId,f=e.domainUserStore,y=e.userStore,h=f.createDmUserAction,w=f.findDmUserListAction,P=y.findUserPageAction,j=(0,m.useState)([]),S=(0,p.default)(j,2),k=S[0],_=S[1],D=(0,m.useState)([]),R=(0,p.default)(D,2),x=R[0],I=R[1],A=(0,m.useState)(10),U=(0,p.default)(A,1)[0],T=(0,m.useState)(1),M=(0,p.default)(T,2),z=M[0],C=M[1],F=(0,m.useState)(0),L=(0,p.default)(F,2),N=L[0],W=L[1],G=(0,m.useState)({pageParam:{pageSize:U,currentPage:z}}),B=(0,p.default)(G,2),K=B[0],V=B[1],J=(0,m.useState)([]),q=(0,p.default)(J,2),Y=q[0],H=q[1],$=(0,m.useState)(""),Z=(0,p.default)($,2),Q=Z[0],X=Z[1];(0,m.useEffect)((function(){return ee(),function(){return H([])}}),[]);var ee=function(){g.Axios.post("/user/userdir/findAllList").then((function(e){e.code||H(e.data)}))},te=[{title:t("orga-table.name"),dataIndex:"name",key:"name",width:"20%",ellipsis:!0,render:function(e,t){return m.default.createElement(s.default,null,m.default.createElement(v.Profile,{userInfo:t})," ",e)}},{title:t("orga-table.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:t("orga-table.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:t("orga-table.org"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0},{title:t("orga-table.type"),dataIndex:"dirId",key:"dirId",width:"10%",ellipsis:!0,render:function(e){var t=Y.findIndex((function(t){return t.id==e}));return t>-1?Y[t].name:"--"}}],re=(0,m.useRef)(null);(0,m.useEffect)((function(){return re.current=!0,ne(K),function(){re.current=!1}}),[K]);var ne=function(e){P(e).then((function(e){!e.code&&re.current&&(W(e.data.totalRecord),I(e.data.dataList))}))},ae={selectedRowKeys:k,onChange:function(e){_(e)}};return m.default.createElement(v.BaseModal,{title:"添加用户",visible:r,onOk:function(){w({domainId:a}).then((function(e){if(!e.code){var t,r=!1,u=e.data.map((function(e){return e.user.id})),l=E(k);try{var i=function(){var e=t.value;if(r)return"break";r=u.some((function(t){return e===t}))};for(l.s();!(t=l.n()).done;){if("break"===i())break}}catch(e){l.e(e)}finally{l.f()}if(r)return d.default.error("存在关联的用户");var o=k.map((function(e){return h({domainId:a,user:{id:e}})}));Promise.all(o).then((function(e){V({pageParam:{pageSize:U,currentPage:1}}),_([]),C(1),W(0),X(""),n()}))}}))},onCancel:function(){V({pageParam:{pageSize:U,currentPage:1}}),_([]),C(1),W(0),X(""),n()},width:1200,destroyOnClose:!0,cancelText:t("orga-common.back"),okText:t("orga-common.save")},m.default.createElement(l.default,null,m.default.createElement(i.default,{span:24},m.default.createElement(o.default,{placeholder:"账号搜索",prefix:m.default.createElement(c.default,null),style:{width:240},value:Q,onChange:function(e){return X(e.target.value)},onPressEnter:function(e){return function(e){var t={name:e.target.value,pageParam:{pageSize:U,currentPage:1}};C(1),V(t)}(e)}}))),m.default.createElement(l.default,null,m.default.createElement(i.default,{span:24},m.default.createElement("div",{style:{width:"100%"}},m.default.createElement(u.default,{columns:te,dataSource:x,rowSelection:ae,rowKey:function(e){return e.id},pagination:{current:z,pageSize:U,total:N,onChange:function(e){C(e);var t=O(O({},K),{},{pageParam:{pageSize:U,currentPage:e}});V(t)},position:["bottomCenter"]}})))))},j=function(e,t){return e.visible===t.visible},S=(0,m.memo)(P,j);t.default=S},799:function(e,t,r){"use strict";r.r(t)},800:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(801)).default;t.default=a},801:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(258);var u=n(r(85)),l=n(r(51)),i=n(r(130)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),c=r(61),f=r(6),d=n(r(802)),s=n(r(809)),p=n(r(562)),m=r(458),v=r(173);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}r(812);var y=(0,c.inject)(v.ORG_STORE,v.SYSTEM_ROLE_STORE)((0,c.observer)((function(e){var t=e.orgStore,r=e.systemRoleStore,n=e.router,a=void 0===n?"/setting/orga":n,c=t.treeData,v=t.selectData,g=t.selectTreeOrgDetail,y=t.findOrgaAction,h=t.findOrgaTreeAction,O=t.findUserOrgaPageAction,E=(0,o.useState)(""),w=(0,i.default)(E,2),P=w[0],j=w[1],S=(0,o.useState)(null),k=(0,i.default)(S,2),_=k[0],D=k[1],R=(0,o.useState)(10),x=(0,i.default)(R,1)[0],I=(0,o.useState)(1),A=(0,i.default)(I,2),U=A[0],T=A[1],M=(0,o.useState)(0),z=(0,i.default)(M,2),C=z[0],F=z[1],L=(0,o.useState)([]),N=(0,i.default)(L,2),W=N[0],G=N[1],B=(0,o.useState)({}),K=(0,i.default)(B,2),V=K[0],J=K[1],q=localStorage.getItem(f.LOCALSTORAGE_KEY.AUTH_CONFIG);if(q){var Y=JSON.parse(q);if(!Y.authType&&-1===Y.appName.indexOf("eas")){var H=Y.authUrl+"/#"+a;return o.default.createElement(p.default,{module:"部门",link:H})}}(0,o.useEffect)((function(){$()}),[V]);var $=function(){h(V).then((function(e){if(!e.code)if(e.data.length){var t=e.data[0];Q({orgaId:t.orgaId}),j(t.orgaId)}else g(null),j("")}))},Z=function(e,t,r){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({pageParam:{currentPage:t,pageSize:x}},e);O(n).then((function(e){e.code||(F(e.data.totalRecord),G(e.data.dataList))}))},Q=function(e){e.parentOrga?D(e.parentOrga.orgaId):D(null),y(e.orgaId).then((function(t){t.code||(j(e.orgaId),T(1),g({orgName:t.data.orgaName,parentOrg:t.data.parentOrga?t.data.parentOrga.orgaName:null,userDirType:t.data.dirId}),Z({orgaId:e.orgaId},1))})).catch((function(e){}))},X=function(e){T(e),Z({orgaId:P},e)};return o.default.createElement("div",{className:"orga_container"},o.default.createElement("div",{className:"orga_container_body"},o.default.createElement(d.default,{treeData:c,onSelect:Q,treeParams:V,getAllTree:$,setTreeParams:J,orgStore:t,systemRoleStore:r}),o.default.createElement("div",{className:"orga_table"},o.default.createElement("div",{className:"orga_table_right"},o.default.createElement(m.TitleAction,{title:"部门",style:{paddingLeft:8}}),v?o.default.createElement(s.default,{data:v,tableData:W,pagination:{current:U,pageSize:x,total:C,onChange:X,showSizeChanger:!1,position:["bottomCenter"]},orgId:P,parentOrgaId:_,getOrgaUser:Z,restTableData:X}):o.default.createElement("div",{className:"org-table"},o.default.createElement(u.default,{description:o.default.createElement("span",null,"组织树结构为空，你需要创建一个")}))))))})));t.default=y},802:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(875);var l=n(r(856));r(80);var i=n(r(26)),o=n(r(321));r(128);var c=n(r(35)),f=n(r(336));r(45);var d=n(r(23));r(320);var s=n(r(256)),p=n(r(357));r(171);var m=n(r(33)),v=n(r(319)),g=n(r(51));r(67);var b=n(r(18)),y=n(r(117)),h=n(r(130)),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=k(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),E=r(4),w=r(46),P=n(r(543)),j=n(r(632)),S=n(r(807));function k(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(k=function(e){return e?r:t})(e)}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,g.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r(808);var R=function(e){var t=e.treeData,r=e.onSelect,n=e.orgStore,a=e.getAllTree,g=e.setTreeParams,k=e.treeParams,_=void 0===k?{}:k,R=e.systemRoleStore,x=n.deleteOrgaAction,I=n.findOpenUserDirListAction,A=n.findOrgaAction,U=n.updateOrgaSortAction,T=(0,w.useTranslation)().t,M=(0,O.useState)(!1),z=(0,h.default)(M,2),C=z[0],F=z[1],L=(0,O.useState)({}),N=(0,h.default)(L,2),W=N[0],G=N[1],B=(0,O.useState)(!1),K=(0,h.default)(B,2),V=K[0],J=K[1],q=(0,O.useState)([]),Y=(0,h.default)(q,2),H=Y[0],$=Y[1];(0,O.useEffect)((function(){return X(),function(){return $([])}}),[]);var Z,Q,X=function(){I().then((function(e){e.code||$(e.data)}))},ee=function(e){G(e),F(!0)},te=function(){var e=(0,y.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.children.length>0)){e.next=2;break}return e.abrupt("return",b.default.error("组织中存在部门,不能删除"));case 2:return e.next=4,x(t.orgaId);case 4:e.sent.code||a();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(e,t){switch(e.key){case"1":ee(t);break;case"2":A(t.orgaId).then((function(e){e.code||(G(e.data),J(!0),F(!0))}));break;case"3":te(t);break;default:ee(t.orgaId)}},ne=function(e){return O.default.createElement("span",{className:"orga-tree_item_action"},"111111"===e.orgaId?O.default.createElement(d.default,null,O.default.createElement(f.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),e.orgaName):e.orgaName,"1"===e.dirId&&function(e){return O.default.createElement("div",{className:"tiklab_tree_actions"},O.default.createElement(d.default,null,O.default.createElement(P.default,{code:"orga_add_orga"},O.default.createElement(m.default,{title:"添加部门"},O.default.createElement(v.default,{onClick:function(){return ee(e)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),O.default.createElement(s.default,{overlay:(t=e,"111111"===t.orgaId?O.default.createElement(j.default,{style:{width:140},onClick:function(e){return re(e,t)},data:[{id:"2",title:"编辑组织",purviewCode:"orga_update_orga"}],allPromise:R.systemPermissions}):O.default.createElement(j.default,{style:{width:140},onClick:function(e){return re(e,t)},data:[{id:"2",title:"编辑组织",purviewCode:"orga_update_orga"},{id:"3",title:"删除组织",purviewCode:"orga_delete_orga"}],allPromise:R.systemPermissions}))},O.default.createElement(p.default,{style:{fontSize:"var(--tiklab-icon-size-16)",padding:4}}))));var t}(e))};return O.default.createElement("div",{className:"orga-tree-wrap"},O.default.createElement(i.default.Group,{compact:!0},O.default.createElement(c.default,{placeholder:"目录类型",style:{width:"40%"},onSelect:function(e){-1===e?_.orgaName?g({orgaName:_.orgaName}):g({}):g(D(D({},_),{},{dirId:e}))}},O.default.createElement(c.default.Option,{key:"-1",value:-1},T("orga-table.all")),H.map((function(e){return O.default.createElement(c.default.Option,{key:e.id,value:e.id},e.name)}))),O.default.createElement(i.default,{placeholder:T("orga-common.search")+T("orga-common.orga")+T("orga-common.name"),style:{width:"60%"},onPressEnter:function(e){return function(e){var t=e.target.value;g(D(D({},_),{},{orgaName:t}))}(e)},prefix:O.default.createElement(o.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})})),O.default.createElement("div",{className:"orga-tree-wrap-tree"},O.default.createElement("div",{className:"orga-tree-content"},O.default.createElement(l.default,{className:"draggable-tree",draggable:!0,blockNode:!0,onDrop:function(e){var t=e.node.props.eventKey,r=e.dragNode.props.eventKey,n=e.node.parentOrga.orgaId,u=e.dragNode.parentOrga.orgaId,l=e.node.sort,i=e.dragNode.sort;if(n!==u)return b.default.error("仅允许同层级部门排序");var o={list:[{parentOrga:e.node.parentOrga,orgaName:e.node.orgaName,orgaId:t,sort:i,dirId:e.node.dirId},{parentOrga:e.dragNode.parentOrga,orgaName:e.dragNode.orgaName,orgaId:r,sort:l,dirId:e.dragNode.dirId}]};U(o).then((function(e){a()}))},defaultSelectedKeys:["111111"],treeData:(Z=(0,E.toJS)(t),Q=[],function e(t,r){t.forEach((function(t,n){var a={key:t.orgaId,orgaName:t.orgaName,title:ne(t),sort:t.sort,dirId:t.dirId,parentOrga:t.parentOrga,children:[]};r.push(a),t.children&&t.children.length>0&&e(t.children,r[n].children)}))}(Z,Q),Q),onSelect:function(e,t){var n=t.node,a={orgaName:n.orgaName,parentOrga:n.parentOrga,sort:n.sort,orgaId:n.key,dirId:n.dirId,path:n.path};r(a)},defaultExpandAll:!0}))),O.default.createElement(S.default,{visible:C,cancelAddOrg:function(){F(!1),G({}),J(!1)},editData:W,isEdit:V,getAllTree:a,userDir:H}))};t.default=R},803:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(189)),u=(n(r(0)),r(61)),l=r(173);r(804);var i=["code","disabled","systemRoleStore"],o=(0,u.inject)(l.SYSTEM_ROLE_STORE)((0,u.observer)((function(e){var t=e.code,r=void 0===t?"":t,n=(e.disabled,e.systemRoleStore),u=(0,a.default)(e,i),l=n.systemPermissions;try{return l.includes(r)?u.children:null}catch(e){return l.includes(r)?u.children:null}})));t.default=o},804:function(e,t,r){"use strict";r.r(t)},805:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(189));r(322);var u=n(r(144)),l=n(r(0)),i=r(61);r(806);var o=["allPromise","data"],c=u.default.SubMenu,f=(0,i.observer)((function(e){var t=e.allPromise,r=void 0===t?[]:t,n=e.data,i=void 0===n?[]:n,f=(0,a.default)(e,o);return l.default.createElement(u.default,f,function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t,n){if(t.children&&t.children.length&&r.includes(t.purviewCode))return l.default.createElement(c,{key:"".concat(t.id),title:t.title,icon:t.icon},e(t.children));if(r.includes(t.purviewCode))return l.default.createElement(u.default.Item,{icon:t.icon,key:"".concat(t.id)},t.title)}))}(i))}));t.default=f},806:function(e,t,r){"use strict";r.r(t)},807:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(128);var u=n(r(35));r(661);var l=n(r(633));r(80);var i=n(r(26)),o=n(r(51));r(116);var c=n(r(20)),f=n(r(130)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=y(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),s=r(4),p=r(61),m=r(6),v=r(46),g=r(458),b=r(173);function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(y=function(e){return e?r:t})(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=(0,p.inject)(b.ORG_STORE)((0,p.observer)((function(e){var t=e.visible,r=e.cancelAddOrg,n=e.editData,a=void 0===n?{}:n,o=e.isEdit,p=void 0!==o&&o,b=e.getAllTree,y=e.userDir,h=void 0===y?[]:y,E=e.orgStore.findOrgaTreeAction,w=c.default.useForm(),P=(0,f.default)(w,1)[0],j=(0,v.useTranslation)().t,S=(0,d.useState)(null),k=(0,f.default)(S,2),_=k[0],D=k[1],R=(0,d.useState)([]),x=(0,f.default)(R,2),I=x[0],A=x[1];(0,d.useEffect)((function(){a&&(p?(P.setFieldsValue({parentOrga:a.parentOrga?a.parentOrga.orgaId:null,orgaName:a.orgaName,dirId:a.dirId}),D(a.path)):(P.setFieldsValue({parentOrga:a.orgaId}),a.path?D("".concat(a.orgaId,",").concat(a.path)):D("".concat(a.orgaId))))}),[a,p]),(0,d.useEffect)((function(){t&&E({dirId:"1"}).then((function(e){e.code||A(e.data)}))}),[t]);var U;return d.default.createElement(g.BaseModal,{title:p?j("orga-common.edit")+j("orga-common.orga"):j("orga-common.add")+j("orga-common.orga"),visible:t,onOk:function(){P.submit()},onCancel:function(){P.resetFields(),r()},destroyOnClose:!0,preserve:!1,forceRender:!0,cancelText:j("orga-common.back"),okText:j("orga-common.save")},d.default.createElement(c.default,{form:P,onFinish:function(e){var t="/user/orga/createOrga",n={orgaName:e.orgaName,parentOrga:{orgaId:e.parentOrga},dirId:e.dirId,path:_};p&&(t="/user/orga/updateOrga",n=O(O({},n),{},{orgaId:a.orgaId})),m.Axios.post(t,n).then((function(e){e.code||(b(),P.resetFields(),r())}))},layout:"vertical"},d.default.createElement(c.default.Item,{label:j("orga-label.orgaName"),name:"orgaName",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},d.default.createElement(i.default,null)),d.default.createElement(c.default.Item,{label:j("orga-label.parentOrg"),name:"parentOrga"},d.default.createElement(l.default,{disabled:!0,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:(U=[],function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach((function(t){var u={};if(t.orgaId===a.orgaId){if(u={title:t.orgaName,value:t.orgaId,path:t.path,disabled:!0},r.push(u),t.children&&t.children.length>0)return e(t.children,u.children=[],u.disabled)}else u={title:t.orgaName,value:t.orgaId,path:t.path,disabled:n},r.push(u);if(t.children&&t.children.length>0)return e(t.children,u.children=[],n)}))}((0,s.toJS)(I.filter((function(e){return!e.parentOrga}))),U),U),placeholder:j("orga-label.parentOrgPlaceholder"),treeDefaultExpandedKeys:[I.length>0&&I[0].orgaId],onChange:function(e,t,r){var n=r.triggerNode.props.path;D(n?"".concat(n,",").concat(e):e)}})),d.default.createElement(c.default.Item,{label:j("orga-label.userType"),name:"dirId",initialValue:"1",rules:[{required:!0,message:j("orga-table.userTypeRequired")}]},d.default.createElement(u.default,{disabled:!0},h.map((function(e){return d.default.createElement(u.default.Option,{key:e.id,value:e.id},e.name)}))))))})));t.default=E},808:function(e,t,r){"use strict";r.r(t)},809:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(461));r(81);var l=n(r(34));r(82);var i=n(r(31)),o=n(r(319));r(48);var c=n(r(21));r(50);var f=n(r(19));r(171);var d=n(r(33)),s=n(r(318));r(45);var p=n(r(23)),m=n(r(130)),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=w(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),g=r(61),b=r(46),y=n(r(543)),h=r(458),O=n(r(810)),E=r(173);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(w=function(e){return e?r:t})(e)}r(811);var P=(0,g.inject)(E.ORG_STORE)((0,g.observer)((function(e){var t=e.data,r=e.tableData,n=e.pagination,a=e.orgId,g=e.parentOrgaId,E=e.getOrgaUser,w=e.restTableData,P=e.orgStore,j=P.deleteUserOrgaAction,S=P.findOpenUserDirListAction,k=(0,v.useMemo)((function(){return n}),[n]),_=(0,v.useState)(!1),D=(0,m.default)(_,2),R=D[0],x=D[1],I=(0,v.useState)([]),A=(0,m.default)(I,2),U=A[0],T=A[1],M=(0,b.useTranslation)().t;(0,v.useEffect)((function(){return z(),function(){return T([])}}),[]);var z=function(){S().then((function(e){e.code||T(e.data)}))},C=[{title:M("orga-table.nickname"),dataIndex:["user","nickname"],width:"25%",render:function(e,t){return v.default.createElement(p.default,null,v.default.createElement(h.Profile,{userInfo:t.user})," ",e)}},{title:M("orga-table.name"),dataIndex:["user","name"],width:"25%"},{title:M("orga-table.orgaName"),dataIndex:["orga","orgaName"],width:"20%"},{title:M("orga-table.type"),dataIndex:["user","dirId"],width:"20%",render:function(e){var t=U.findIndex((function(t){return t.id==e}));return t>-1?U[t].name:"--"}},{title:M("orga-common.action"),key:"action",width:"10%",render:function(e,t){return"1"===t.user.dirId&&v.default.createElement(p.default,{size:"middle"},v.default.createElement(y.default,{code:"orga_delete_orga"},v.default.createElement(d.default,{title:"删除"},v.default.createElement(s.default,{onClick:function(){return F(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))))}}],F=function(e){j(e).then((function(e){e.code||w(1)}))};return v.default.createElement("div",{className:"org-detail"},v.default.createElement(c.default,{style:{margin:"10px 0",paddingLeft:8}},v.default.createElement(f.default,{span:24},v.default.createElement(p.default,null,v.default.createElement("div",{className:"org-detail-item"},v.default.createElement("label",null,M("orga-label.orgaName"),":"),t.orgName),v.default.createElement("div",{className:"org-detail-item"},v.default.createElement("label",null,M("orga-label.parentOrg"),":")," ",t.parentOrg||"无上级")))),v.default.createElement(c.default,{style:{paddingLeft:8}},v.default.createElement(f.default,{span:24},v.default.createElement("div",{className:"org-detail_title2_main"},v.default.createElement("span",{className:"org-detail_user_title2"},"用户(",k.total,")"),v.default.createElement(y.default,{code:"orga_add_user"},v.default.createElement(i.default,{type:"primary",onClick:function(){x(!0)},disabled:"1"!==t.userDirType,icon:v.default.createElement(o.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},M("orga-label.addUser")))))),v.default.createElement(c.default,null,v.default.createElement("div",{className:"org-detail-table"},v.default.createElement(l.default,{columns:C,dataSource:r,pagination:k,rowKey:function(e){return e.id},tableLayout:"fixed"}))),v.default.createElement(O.default,(0,u.default)({},e,{orgId:a,parentOrgaId:g,visible:R,onCancel:function(){return x(!1)},getOrgaUser:E,dirId:t.dirId})))})));t.default=P},810:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(48);var l=n(r(21));r(50);var i=n(r(19));r(80);var o=n(r(26)),c=n(r(321));r(45);var f=n(r(23));r(67);var d=n(r(18)),s=n(r(51)),p=n(r(130)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=O(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),v=r(61),g=r(458),b=r(6),y=r(46),h=r(173);function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(O=function(e){return e?r:t})(e)}function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){i=!0,u=e},f:function(){try{l||null==r.return||r.return()}finally{if(i)throw u}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S=(0,v.inject)(h.USER_STORE)((0,v.observer)((function(e){var t=(0,y.useTranslation)().t,r=e.visible,n=e.onCancel,a=e.orgId,s=e.getOrgaUser,v=e.userStore.findUserPageAction,h=(0,m.useState)([]),O=(0,p.default)(h,2),w=O[0],P=O[1],S=(0,m.useState)([]),k=(0,p.default)(S,2),_=k[0],D=k[1],R=(0,m.useState)(10),x=(0,p.default)(R,1)[0],I=(0,m.useState)(1),A=(0,p.default)(I,2),U=A[0],T=A[1],M=(0,m.useState)(0),z=(0,p.default)(M,2),C=z[0],F=z[1],L=(0,m.useState)({pageParam:{pageSize:x,currentPage:U}}),N=(0,p.default)(L,2),W=N[0],G=N[1],B=(0,m.useState)([]),K=(0,p.default)(B,2),V=K[0],J=K[1];(0,m.useEffect)((function(){return q(),function(){return J([])}}),[]),(0,m.useEffect)((function(){Y(j({},W))}),[W]);var q=function(){b.Axios.post("/user/userdir/findAllList").then((function(e){e.code||J(e.data)}))},Y=function(e){v(e).then((function(e){e.code||(F(e.data.totalRecord),D(e.data.dataList))}))},H=[{title:t("orga-table.name"),dataIndex:"nickname",key:"nickname",width:"20%",ellipsis:!0,render:function(e,t){return m.default.createElement(f.default,null,m.default.createElement(g.Profile,{userInfo:t})," ",e)}},{title:t("orga-table.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:t("orga-table.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:t("orga-table.org"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0},{title:t("orga-table.type"),dataIndex:"dirId",key:"dirId",width:"10%",ellipsis:!0,render:function(e){var t=V.findIndex((function(t){return t.id===e}));return t>-1?V[t].name:"--"}}],$={selectedRowKeys:w,onChange:function(e){P(e)}};return m.default.createElement(g.BaseModal,{title:"选择用户",visible:r,onOk:function(){(function(){var e={orgaId:a,pageParam:{pageSize:9999999,currentPage:1}};return b.Axios.post("/user/userOrga/findUserOrgaList",e)})().then((function(e){if(!e.code){var t,r=!1,u=e.data.map((function(e){return e.user.id})),l=E(w);try{var i=function(){var e=t.value;if(r)return"break";r=u.some((function(t){return e===t}))};for(l.s();!(t=l.n()).done;){if("break"===i())break}}catch(e){l.e(e)}finally{l.f()}if(r)return d.default.error("存在关联的用户");var o=w.map((function(e){return t={user:{id:e},orga:{orgaId:a}},b.Axios.post("/user/userOrga/createUserOrga",t);var t}));Promise.all(o).then((function(e){G({pageParam:{pageSize:x,currentPage:1}}),P([]),T(1),F(0),n(),s({orgaId:a},1)}))}}))},onCancel:function(){G({pageParam:{pageSize:x,currentPage:1}}),P([]),T(1),F(0),n(),s({orgaId:a},1)},width:800,destroyOnClose:!0,okText:t("orga-common.save"),cancelText:t("orga-common.back")},m.default.createElement(l.default,{style:{paddingBottom:16}},m.default.createElement(i.default,{span:24},m.default.createElement(o.default,{placeholder:"搜索账号、手机号、邮箱",style:{width:240},onPressEnter:function(e){return function(e){var t=e.target.value,r=j(j({},W),{},{name:t,pageParam:{pageSize:x,currentPage:1}});G(r)}(e)},prefix:m.default.createElement(c.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})}))),m.default.createElement(l.default,null,m.default.createElement(i.default,{span:24},m.default.createElement("div",{style:{width:"100%"}},m.default.createElement(u.default,{columns:H,dataSource:_,rowSelection:$,rowKey:function(e){return e.id},pagination:{current:U,pageSize:x,total:C,onChange:function(e){T(e);var t=j(j({},W),{},{pageParam:{pageSize:x,currentPage:e}});G(t)}}})))))})));t.default=S},811:function(e,t,r){"use strict";r.r(t)},812:function(e,t,r){"use strict";r.r(t)},813:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(814)).default;t.default=a},814:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37)),l=n(r(461));r(50);var i=n(r(19));r(81);var o=n(r(34));r(48);var c=n(r(21));r(80);var f=n(r(26)),d=n(r(321));r(128);var s=n(r(35));r(82);var p=n(r(31)),m=n(r(319)),v=n(r(318));r(171);var g=n(r(33)),b=n(r(323));r(45);var y=n(r(23)),h=n(r(51)),O=n(r(117)),E=n(r(130)),w=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=A(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),P=r(61),j=r(4),S=r(6),k=r(46),_=n(r(543)),D=r(458),R=n(r(815)),x=r(261),I=n(r(562));function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(A=function(e){return e?r:t})(e)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,h.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r(816);var M=(0,P.inject)(x.USER_STORE)((0,P.observer)((function(e){var t=e.userStore,r=e.SASSComponentSearch,n=e.saasRefresh,a=void 0!==n&&n,h=e.setSaasRefreshStatus,P=e.bgroup,x=void 0===P?"eas":P,A=e.router,U=void 0===A?"/setting/userList":A,M=t.userData,z=t.getUserList,C=t.editUser,F=t.addUser,L=t.deleteUser,N=t.findRoleUserListAction,W=t.findUserPageAction,G=(0,k.useTranslation)().t,B=(0,w.useState)(!1),K=(0,E.default)(B,2),V=K[0],J=K[1],q=(0,w.useState)(!1),Y=(0,E.default)(q,2),H=Y[0],$=Y[1],Z=(0,w.useState)({}),Q=(0,E.default)(Z,2),X=Q[0],ee=Q[1],te=(0,w.useState)(10),re=(0,E.default)(te,1)[0],ne=(0,w.useState)(1),ae=(0,E.default)(ne,2),ue=ae[0],le=ae[1],ie=(0,w.useState)(0),oe=(0,E.default)(ie,2),ce=oe[0],fe=oe[1],de=(0,w.useState)({pageParam:{pageSize:re,currentPage:ue}}),se=(0,E.default)(de,2),pe=se[0],me=se[1],ve=(0,w.useState)(""),ge=(0,E.default)(ve,2),be=ge[0],ye=ge[1],he=(0,w.useState)([]),Oe=(0,E.default)(he,2),Ee=Oe[0],we=Oe[1],Pe=localStorage.getItem(S.LOCALSTORAGE_KEY.AUTH_CONFIG);if(Pe){var je=JSON.parse(Pe);if(!je.authType&&-1===je.appName.indexOf("eas")){var Se=je.authUrl+"/#"+U;return w.default.createElement(I.default,{module:"用户",link:Se})}}var ke=(0,w.useRef)(null);(0,w.useEffect)((function(){return ke.current=!0,Re(pe),function(){return ke.current=!1}}),[pe]),(0,w.useEffect)((0,O.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De();case 2:return e.abrupt("return",(function(){return we([])}));case 3:case"end":return e.stop()}}),e)}))),[]),(0,w.useEffect)((function(){a&&_e()}),[a]);var _e=function(){Re(pe),h()},De=function(){S.Axios.post("/user/userdir/findAllList").then((function(e){e.code||we(e.data)}))},Re=function(e){W(e).then(function(){var e=(0,O.default)(u.default.mark((function e(t){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code||!ke.current){e.next=6;break}return fe(t.data.totalRecord),e.next=4,Promise.all(xe(t.data.dataList));case 4:r=e.sent,z(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},xe=function(e){return e.map(function(){var e=(0,O.default)(u.default.mark((function e(t){var r,n,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n={userId:t.id,scope:1,type:1},e.next=4,N(n);case 4:return 0===(a=e.sent).code&&(r=a.data.map((function(e){return T(T({},e.role),{},{roleUserId:e.id})})).filter((function(e){return"1"===e.type&&1===e.scope}))),e.abrupt("return",T(T({},t),{},{roleList:r}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Ie=[{title:G("orga-table.nickname"),dataIndex:"nickname",key:"nickname",width:"20%",render:function(e,t){return w.default.createElement(y.default,null,w.default.createElement(D.Profile,{userInfo:t})," ",w.default.createElement("a",{onClick:function(){return Ue(t)}},e))}},{title:G("orga-table.name"),dataIndex:"name",key:"name",width:"10%"},{title:G("orga-table.org"),dataIndex:"org",key:"org",width:"20%"},{title:"角色",dataIndex:"role",key:"role",width:"20%",render:function(e,t){var r=t.roleList;return w.default.createElement(y.default,null,r.map((function(e){return w.default.createElement("span",{key:e.id},e.name)})))}},{title:G("orga-table.type"),dataIndex:"dirId",key:"dirId",width:"20%",render:function(e){if("0"===e)return"个人账号";var t=Ee.findIndex((function(t){return t.id===e}));return t>-1?Ee[t].name:"--"}},{title:G("orga-common.action"),key:"action",width:"10%",render:function(e,t){var r=t.dirId;if(t.type<1)return w.default.createElement(w.default.Fragment,null,"1"===r?w.default.createElement(y.default,{size:"middle"},w.default.createElement(_.default,{code:"user_update_user"},"admin"!==t.name&&w.default.createElement(g.default,{title:"编辑"},w.default.createElement(b.default,{onClick:function(){return Ue(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))),w.default.createElement(_.default,{code:"user_delete_user"},"admin"!==t.name&&w.default.createElement(g.default,{title:"删除"},w.default.createElement(v.default,{onClick:function(){return Ae(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))):w.default.createElement(y.default,{size:"middle"},w.default.createElement(_.default,{code:"user_update_user"},w.default.createElement(g.default,{title:"编辑"},w.default.createElement(b.default,{onClick:function(){return Ue(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))))}}],Ae=function(e){var t=new FormData;t.append("id",e),S.Axios.post("/user/user/deleteUser",t).then((function(t){t.code||L(e)}))},Ue=function(e){ee(e),J(!0),$(!0)};return w.default.createElement("div",{className:"user_content"},w.default.createElement("div",{className:"user-detail"},w.default.createElement(D.TitleAction,{title:"用户",style:{paddingLeft:8}},w.default.createElement(y.default,null,w.default.createElement(_.default,{code:"user_add_user"},w.default.createElement(p.default,{type:"primary",onClick:function(){return J(!0)},icon:w.default.createElement(m.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},G("orga-label.addUser"))),r)),w.default.createElement(c.default,{justify:"space-between",style:{marginBottom:16,paddingLeft:8}},w.default.createElement(y.default,null,w.default.createElement(s.default,{placeholder:"请选择用户目录",onSelect:function(e){le(1);var t=T(T({},pe),{},{pageParam:{pageSize:re,currentPage:1}});"-1"!==e?t.dirId=e:delete t.dirId,me(t)},style:{width:"240px"},defaultValue:"-1"},w.default.createElement(s.default.Option,{key:"-1",value:"-1"},"用户目录"),Ee.map((function(e){return w.default.createElement(s.default.Option,{key:e.id,value:e.id},e.name)}))),w.default.createElement(f.default,{placeholder:G("orga-label.searchUserAccount"),value:be,onChange:function(e){return ye(e.target.value)},onPressEnter:function(e){return function(e){le(1);var t=T(T({},pe),{},{pageParam:{pageSize:re,currentPage:1}});e.target.value?t.name=e.target.value:delete t.name,me(t)}(e)},style:{width:"240px"},prefix:w.default.createElement(d.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})}))),w.default.createElement(c.default,null,w.default.createElement(i.default,{span:24},w.default.createElement(o.default,{columns:Ie,dataSource:M,rowKey:function(e){return e.id},pagination:{current:ue,pageSize:re,total:ce,showSizeChanger:!1,position:["bottomCenter"]},onChange:function(e,t,r){return function(e,t,r){var n=[];le(e.current),Array.isArray(r)?n=r.map((function(e){return{name:e.field,sortType:void 0!==e.order?"ascend"===e.order?"asc":"desc":void 0}})):r.field&&n.push({name:r.field,sortType:void 0!==r.order?"ascend"===r.order?"asc":"desc":void 0});var a=T(T({},pe),{},{orderParams:n,pageParam:{pageSize:re,currentPage:e.current}});me(a)}(e,0,r)}}))),w.default.createElement(R.default,(0,l.default)({},e,{visible:V,onCancel:function(){ee({}),$(!1),J(!1),Re(pe)},addUser:F,isEdit:H,data:(0,j.toJS)(X),editUser:C,getList:Re,listParams:pe,userDir:Ee,bgroup:x}))))})));t.default=M},815:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(531);var l=n(r(519));r(82);var i=n(r(31));r(128);var o=n(r(35));r(80);var c=n(r(26));r(67);var f=n(r(18)),d=n(r(51)),s=n(r(189)),p=n(r(117));r(116);var m=n(r(20)),v=n(r(130)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),b=r(46),y=["role"];function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=function(e){var t=e.visible,r=e.onCancel,n=e.isEdit,a=void 0!==n&&n,d=e.data,h=void 0===d?{}:d,O=e.userDir,w=void 0===O?[]:O,P=e.bgroup,j=e.userStore,S=j.createRoleUserAction,k=j.createUserAction,_=j.deleteRoleUserAction,D=j.findRolePageAction,R=j.updateUserAction,x=m.default.useForm(),I=(0,v.default)(x,1)[0],A=(0,b.useTranslation)().t,U=(0,g.useState)(1),T=(0,v.default)(U,2),M=T[0],z=T[1],C=(0,g.useState)(10),F=(0,v.default)(C,1)[0],L=(0,g.useState)([]),N=(0,v.default)(L,2),W=N[0],G=N[1],B=(0,g.useState)(0),K=(0,v.default)(B,2),V=K[0],J=K[1];(0,g.useEffect)((function(){a&&(I.setFieldsValue({nickname:h.nickname}),I.setFieldsValue({name:h.name}),I.setFieldsValue({phone:h.phone}),I.setFieldsValue({email:h.email}),I.setFieldsValue({password:h.password}),I.setFieldsValue({dirId:String(h.dirId)}),I.setFieldsValue({role:(h.roleList||[]).map((function(e){return e.id}))}))}),[a,h]),(0,g.useEffect)((function(){q({pageParam:{pageSize:F,currentPage:M},bgroup:P})}),[]);var q=function(e){D(e).then((function(t){if(0===t.code){var r=W.concat(t.data.dataList);G(r),r.length>0&&I.setFieldsValue({role:[r[0].id]}),J(t.data.totalRecord),z(e.pageParam.currentPage)}}))},Y=function(){I.resetFields(),r()},H=function(){var e=(0,p.default)(u.default.mark((function e(t){var r,n,l,i;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.role,n=(0,s.default)(t,y),l=E(E({},n),{},{type:0,dirId:"1"}),!a){e.next=9;break}return l=E(E({},n),{},{id:h.id,type:h.type,dirId:h.dirId}),e.next=6,R(l);case 6:i=e.sent,e.next=12;break;case 9:return e.next=11,k(l);case 11:i=e.sent;case 12:0===i.code?a?$(r):Q(r,i.data):f.default.error(res.msg);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(e){var t=(h.roleList||[]).map((function(e){return e.id})),r=(h.roleList||[]).reduce((function(e,t,r){return e[t.id]=t.roleUserId,e}),{}),n=t.reduce((function(t,n,a){return e.includes(n)||t.push(r[n]),t}),[]),a=e.reduce((function(e,r,n){return t.includes(r)||e.push(r),e}),[]);0===n.length?Q(a,h.id):Z(n).then((function(){Q(a,h.id)}))},Z=function(e){var t=e.map((function(e){return _(e)}));return Promise.all(t)},Q=function(e,t){if(Array.isArray(e)){var r=e.map((function(e){return S({userId:t,role:{id:e}})}));Promise.all(r).then((function(e){Y()}))}else{S({userId:t,role:{id:e}}).then((function(e){0===e.code&&Y()}))}},X=function(e,t,r){var n=I.getFieldValue,a=I.setFieldsValue,u=n("phone"),l=n("email"),i=n("name");if(t)switch(e.field){case"name":a({phone:u}),a({email:l});break;case"phone":a({name:i}),a({email:l});break;default:a({name:i}),a({phone:u})}else switch(e.field){case"name":u||l||r("账号、邮箱、手机号不能同时为空");break;case"phone":i||l||r("账号、邮箱、手机号不能同时为空");break;default:i||u||r("账号、邮箱、手机号不能同时为空")}r()};return g.default.createElement(l.default,{placement:"right",onClose:Y,visible:t,width:420,title:A(a?"adduser-module.editUser":"adduser-module.addUser"),bodyStyle:{padding:0},style:{top:48,height:"calc(100% - 48px)"},getContainer:!1},g.default.createElement("div",{className:"tiklab_user"},g.default.createElement("div",{className:"tiklab_user_form"},g.default.createElement(m.default,{form:I,onFinish:H,preserve:!1,layout:"vertical"},g.default.createElement(m.default.Item,{label:A("adduser-module.nickname"),name:"nickname",rules:[{required:!0,message:A("adduser-module.nicknameRequired")}]},g.default.createElement(c.default,{disabled:h.dirId&&"1"!==h.dirId||!1})),g.default.createElement(m.default.Item,{label:A("adduser-module.name"),name:"name",rules:[{pattern:/^[a-zA-Z0-9_-]{4,16}$/,message:"账号长度4-16位(字母，数字，下划线，减号)"},{validator:X}]},g.default.createElement(c.default,{disabled:h.dirId&&"1"!==h.dirId||!1})),g.default.createElement(m.default.Item,{label:A("adduser-module.phone"),name:"phone",rules:[{pattern:/^(?:(?:\+|00)86)?1[3-9]\d{9}$/,message:"手机号码不正确"},{validator:X}]},g.default.createElement(c.default,{disabled:h.dirId&&"1"!==h.dirId||!1})),g.default.createElement(m.default.Item,{label:A("adduser-module.email"),name:"email",rules:[{type:"email",message:A("adduser-module.emailFormat")},{validator:X}]},g.default.createElement(c.default,{disabled:h.dirId&&"1"!==h.dirId||!1})),!a&&g.default.createElement(m.default.Item,{label:A("adduser-module.password"),name:"password",rules:[{required:!0,message:A("adduser-module.passwordRequired")}]},g.default.createElement(c.default,{disabled:h.dirId&&"1"!==h.dirId||!1})),g.default.createElement(m.default.Item,{label:A("adduser-module.userType"),name:"dirId",initialValue:"1",rules:[{required:!0,message:A("adduser-module.userTypeRequired")}]},g.default.createElement(o.default,{disabled:!0},w.map((function(e){return g.default.createElement(o.default.Option,{key:e.id,value:e.id},e.name)})))),g.default.createElement(m.default.Item,{label:"角色",name:"role",initialValue:W.length>0?[W[0].id]:[],rules:[{required:!0,message:A("adduser-module.userTypeRequired")}]},g.default.createElement(o.default,{mode:"multiple",onPopupScroll:function(e){e.persist();var t=e.target;t.scrollTop+t.offsetHeight===t.scrollHeight&&(M*F<V&&q({pageParam:{pageSize:F,currentPage:M+1}}))}},W.map((function(e){return g.default.createElement(o.default.Option,{key:e.id,value:e.id},e.name)})))))),g.default.createElement("div",{className:"tiklab_user_footer"},g.default.createElement(i.default,{type:"primary",onClick:function(){I.submit()}},A("orga-common.save")))))},P=(0,g.memo)(w);t.default=P},816:function(e,t,r){"use strict";r.r(t)},817:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(818)).default;t.default=a},818:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(81);var l=n(r(34));r(48);var i=n(r(21));r(50);var o=n(r(19));r(82);var c=n(r(31)),f=n(r(319)),d=n(r(318));r(171);var s=n(r(33)),p=n(r(323));r(45);var m=n(r(23));r(257);var v=n(r(134)),g=n(r(130)),b=n(r(117)),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=j(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),h=r(46),O=n(r(819)),E=n(r(820)),w=r(458);r(822);var P=r(6);function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(j=function(e){return e?r:t})(e)}var S=function(){var e=(0,b.default)(u.default.mark((function e(t){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,P.Axios.post("/usergroup/deleteGroup",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,b.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.Axios.post("/usergroup/findAllGroup");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(e){var t=e.isBase,r=void 0!==t&&t,n=(0,h.useTranslation)().t,a=(0,y.useState)(!1),P=(0,g.default)(a,2),j=P[0],_=P[1],D=(0,y.useState)(null),R=(0,g.default)(D,2),x=R[0],I=R[1],A=(0,y.useState)([]),U=(0,g.default)(A,2),T=U[0],M=U[1],z=(0,y.useState)(!1),C=(0,g.default)(z,2),F=C[0],L=C[1],N=(0,y.useState)(null),W=(0,g.default)(N,2),G=W[0],B=W[1],K=[{title:"用户组",dataIndex:"name",key:"name",width:"20%",render:function(e,t){var r=t.type;return y.default.createElement(m.default,null,y.default.createElement("a",{onClick:function(){return H(t)}},e),1===r&&y.default.createElement(v.default,null,"管理员组"))}},{title:"类型",dataIndex:"group",key:"group",width:"20%",render:function(e,t){return"system"===e?"内置":"自定义"}},{title:"成员数",dataIndex:"userNum",key:"userNum",width:"20%"},{title:n("orga-common.action"),key:"action",width:"10%",render:function(e,t){var r=t.type;return y.default.createElement(m.default,{size:"middle"},1!==r&&y.default.createElement(s.default,{title:"编辑"},y.default.createElement(p.default,{onClick:function(){return J(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),1!==r&&y.default.createElement(s.default,{title:"删除"},y.default.createElement(d.default,{onClick:function(){return q(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}];(0,y.useEffect)((function(){V()}),[]);var V=function(){var e=(0,b.default)(u.default.mark((function e(){var t;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:0===(t=e.sent).code&&M(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(e){I(e),_(!0)},q=function(){var e=(0,b.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:return e.next=4,V();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=(0,b.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(null),_(!1),e.next=4,V();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(e){B(e),L(!0)},$=function(){var e=(0,b.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(null),L(!1),e.next=4,V();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return y.default.createElement("div",{className:"tiklab_userGroup"},F?y.default.createElement(E.default,{onCancel:$,groupData:G}):y.default.createElement("main",{className:"tiklab_userGroup_main"},y.default.createElement(i.default,null,y.default.createElement(o.default,{span:24},y.default.createElement(w.TitleAction,{title:"用户组",style:{paddingLeft:8}},y.default.createElement(c.default,{onClick:function(){_(!0)},type:"primary",icon:y.default.createElement(f.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},"新增组")))),y.default.createElement(i.default,null,y.default.createElement(o.default,{span:24},y.default.createElement(l.default,{columns:K,dataSource:T,rowKey:function(e){return e.id},pagination:!1})))),y.default.createElement(O.default,{open:j,onCancel:Y,data:x,isBase:r}))};t.default=_},819:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(576);var l=n(r(546));r(80);var i=n(r(26));r(67);var o=n(r(18)),c=n(r(51));r(116);var f=n(r(20)),d=n(r(130)),s=n(r(117)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=b(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),m=r(6),v=r(458),g=r(46);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(b=function(e){return e?r:t})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(){var e=(0,s.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Axios.post("/usergroup/createGroup",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,s.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Axios.post("/usergroup/updateGroup",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t=e.isBase,r=e.open,n=e.data,a=e.onCancel,c=f.default.useForm(),m=(0,d.default)(c,1)[0],b=(0,g.useTranslation)().t;(0,p.useEffect)((function(){n&&(m.setFieldsValue({name:n.name}),m.setFieldsValue({description:n.description}),m.setFieldsValue({type:n.type}))}),[n]);var y=function(){m.resetFields(),a()},w=function(){var e=(0,s.default)(u.default.mark((function e(r){var a,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=h(h({},r),{},{group:t?"system":"custom"}),!n){e.next=8;break}return l=h(h({},n),l),e.next=5,E(l);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,O(l);case 10:a=e.sent;case 11:0===a.code?(o.default.success("成功"),y()):o.default.error("失败");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return p.default.createElement(v.BaseModal,{title:"用户组",visible:r,onOk:function(){m.submit()},onCancel:y,destroyOnClose:!0,preserve:!1,forceRender:!0,cancelText:b("orga-common.back"),okText:b("orga-common.save")},p.default.createElement(f.default,{form:m,onFinish:w,layout:"vertical"},p.default.createElement(f.default.Item,{label:"用户组名称",name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},p.default.createElement(i.default,{placeholder:"用户组名称"})),t&&p.default.createElement(f.default.Item,{label:"设置管理员组",name:"type",initialValue:0},p.default.createElement(l.default.Group,null,p.default.createElement(l.default,{value:0},"普通组"),p.default.createElement(l.default,{value:1},"管理员组"))),p.default.createElement(f.default.Item,{label:"描述",name:"description"},p.default.createElement(i.default,{placeholder:"用户组名称"}))))};t.default=w},820:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(81);var l=n(r(34));r(48);var i=n(r(21));r(50);var o=n(r(19));r(82);var c=n(r(31)),f=n(r(236)),d=n(r(51)),s=n(r(130));r(45);var p=n(r(23));r(171);var m=n(r(33)),v=n(r(318)),g=n(r(117)),b=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=w(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),y=r(6),h=r(46),O=n(r(821)),E=r(458);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(w=function(e){return e?r:t})(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S=function(){var e=(0,g.default)(u.default.mark((function e(t){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("id",t),e.next=4,y.Axios.post("/usergroupUser/deleteUser",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,g.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.Axios.post("/usergroupUser/findUserList",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.onCancel,r=e.groupData,n=(0,h.useTranslation)().t,a=[{title:"昵称",dataIndex:"nickname"},{title:"账号",dataIndex:"name"},{title:n("orga-table.email"),dataIndex:"email",render:function(e){return e||"--"}},{title:n("orga-common.action"),key:"action",width:"10%",render:function(e,t){var r=t.type;return b.default.createElement(p.default,{size:"middle"},1!==r&&b.default.createElement(m.default,{title:"删除"},b.default.createElement(v.default,{onClick:function(){return T(t.groupUserLinkUserId)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}],u=(0,b.useState)([]),d=(0,s.default)(u,2),g=d[0],y=d[1],w=(0,b.useState)(!1),P=(0,s.default)(w,2),_=P[0],D=P[1],R=(0,b.useState)([]),x=(0,s.default)(R,2),I=x[0],A=x[1];(0,b.useEffect)((function(){r&&U()}),[r]);var U=function(){var e={groupId:r.id};k(e).then((function(e){if(0===e.code){var t=e.data.map((function(e){return j(j({},e.user),{},{groupUserLinkUserId:e.id})})),r=t.map((function(e){return e.id}));A(r),y(t)}}))},T=function(e){S(e).then((function(e){U()}))};return b.default.createElement("main",{className:"tiklab_userGroup_main"},b.default.createElement(i.default,null,b.default.createElement(o.default,{span:24},b.default.createElement(E.TitleAction,{title:r.name,icon:b.default.createElement(c.default,{type:"link",icon:b.default.createElement(f.default,null),onClick:t})}))),b.default.createElement(i.default,null,b.default.createElement(p.default,null,b.default.createElement("div",{className:"label_item"},b.default.createElement("label",null,"名称:"),b.default.createElement("span",null,r.name)),b.default.createElement("div",{className:"label_item"},b.default.createElement("label",null,"类型:"),b.default.createElement("span",null,"system"===r.group?"内置":"自定义")))),b.default.createElement(p.default,{direction:"vertical",size:"middle"},b.default.createElement(i.default,{justify:"space-between"},b.default.createElement(E.TitleAction,{title:"用户(".concat(g.length,")")}),b.default.createElement(c.default,{type:"primary",onClick:function(){D(!0)}},"添加用户")),b.default.createElement(l.default,{columns:a,dataSource:g,rowKey:function(e){return e.id},pagination:!1})),b.default.createElement(O.default,{open:_,onCancel:function(){D(!1),U()},defaultSelectedRowKeys:I,userGroupId:r.id,groupUserType:r.type}))};t.default=_},821:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(81);var l=n(r(34));r(48);var i=n(r(21));r(50);var o=n(r(19));r(80);var c=n(r(26)),f=n(r(321));r(67);var d=n(r(18)),s=n(r(51));r(45);var p=n(r(23)),m=n(r(130)),v=n(r(117)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=w(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),b=r(46),y=r(458),h=r(6),O=r(61),E=r(261);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(w=function(e){return e?r:t})(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S=function(){var e=(0,v.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Axios.post("/usergroupUser/createBatchUser",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=(0,O.inject)(E.USER_STORE)((0,O.observer)((function(e){var t=e.open,r=e.onCancel,n=e.defaultSelectedRowKeys,a=e.userGroupId,u=e.groupUserType,s=void 0===u?0:u,v=e.userStore.findUserPageAction,h=(0,b.useTranslation)().t,O=(0,g.useState)(""),E=(0,m.default)(O,2),w=E[0],P=E[1],k=(0,g.useState)([]),_=(0,m.default)(k,2),D=_[0],R=_[1],x=(0,g.useState)([]),I=(0,m.default)(x,2),A=I[0],U=I[1],T=(0,g.useState)(0),M=(0,m.default)(T,2),z=M[0],C=M[1],F=(0,g.useState)(10),L=(0,m.default)(F,1)[0],N=(0,g.useState)(1),W=(0,m.default)(N,2),G=W[0],B=W[1],K=(0,g.useState)({pageParam:{pageSize:L,currentPage:G}}),V=(0,m.default)(K,2),J=V[0],q=V[1],Y=[{title:h("orga-table.nickname"),dataIndex:"nickname",key:"nickname",width:"20%",ellipsis:!0,render:function(e,t){return g.default.createElement(p.default,null,g.default.createElement(y.Profile,{userInfo:t})," ",e)}},{title:h("orga-table.name"),dataIndex:"name",key:"name",width:"20%",ellipsis:!0},{title:h("orga-table.phone"),dataIndex:"phone",key:"phone",width:"20%",ellipsis:!0},{title:h("orga-table.email"),dataIndex:"email",key:"email",width:"20%",ellipsis:!0},{title:h("orga-table.org"),dataIndex:"org",key:"org",width:"20%",ellipsis:!0}],H=(0,g.useRef)(null);(0,g.useEffect)((function(){return H.current=!0,$(J),function(){H.current=!1}}),[J]),(0,g.useEffect)((function(){n&&R(n)}),[n]);var $=function(e){v(e).then((function(e){!e.code&&H.current&&(C(e.data.totalRecord),U(e.data.dataList))}))},Z=function(){r()},Q={preserveSelectedRowKeys:!0,selectedRowKeys:D,onChange:function(e){R(e)},getCheckboxProps:function(e){var t=e.type;e.id;return D.includes(e.id)&&t>0&&s>0?{disabled:!0}:{disabled:!1}}};return g.default.createElement(y.BaseModal,{title:"添加用户",visible:t,onOk:function(){S({userGroup:{id:a},userIds:D}).then((function(e){if(0!==e.code)return d.default.error(e.msg);Z()}))},onCancel:Z,width:1200,destroyOnClose:!0,cancelText:h("orga-common.back"),okText:h("orga-common.save")},g.default.createElement(i.default,null,g.default.createElement(o.default,{span:24},g.default.createElement(c.default,{placeholder:"账号搜索",prefix:g.default.createElement(f.default,null),style:{width:240},value:w,onChange:function(e){return P(e.target.value)},onPressEnter:function(e){return function(e){var t=e.target.value,r=j(j({},J),{},{nickname:t,pageParam:{pageSize:L,currentPage:1}});B(1),q(r)}(e)}}))),g.default.createElement(i.default,null,g.default.createElement(o.default,{span:24},g.default.createElement("div",{style:{width:"100%"}},g.default.createElement(l.default,{columns:Y,dataSource:A,rowSelection:Q,rowKey:function(e){return e.id},pagination:{current:G,pageSize:L,total:z,onChange:function(e){B(e);var t=j(j({},J),{},{pageParam:{pageSize:L,currentPage:e}});q(t)},position:["bottomCenter"]}})))))})));t.default=k},822:function(e,t,r){"use strict";r.r(t)},823:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(824)).default;t.default=a},824:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37)),l=n(r(461));r(48);var i=n(r(21));r(50);var o=n(r(19));r(81);var c=n(r(34)),f=n(r(319)),d=n(r(117)),s=n(r(318));r(171);var p=n(r(33)),m=n(r(326));r(45);var v=n(r(23));r(257);var g=n(r(134));r(82);var b=n(r(31)),y=n(r(130)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=S(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),O=r(61),E=r(46),w=r(173),P=r(825),j=r(458);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(S=function(e){return e?r:t})(e)}r(828);var k=(0,O.inject)(w.PRIVILEGE_DOMAIN_ROLE_STORE)((0,O.observer)((function(e){var t=(0,E.useTranslation)().t,r=e.privilegeDomainRoleStore,n=e.domainId,a=r.privilegeDomainRole,O=r.deleteDomainRoleAction,w=r.findDomainRoleListAction,S=r.setDomainRoleAction,k=(0,h.useState)(!1),_=(0,y.default)(k,2),D=_[0],R=_[1],x={domainId:n,sopce:2},I=(0,h.useState)(x),A=(0,y.default)(I,1)[0],U=(0,h.useState)(null),T=(0,y.default)(U,2),M=T[0],z=T[1],C=[{title:"角色名称",dataIndex:"name",render:function(e,t){var r=t.businessType,n=t.role;return 1===r&&1===n.defaultRole?h.default.createElement(v.default,null,h.default.createElement(b.default,{type:"link",onClick:function(){return N(t)}},n.name),h.default.createElement(g.default,{color:"#87d068"},"默认"),h.default.createElement(g.default,null,"管理员")):1===n.defaultRole?h.default.createElement(v.default,null,h.default.createElement(b.default,{type:"link",onClick:function(){return N(t)}},n.name),h.default.createElement(g.default,{color:"#87d068"},"默认")):1===r?h.default.createElement(v.default,null,h.default.createElement(b.default,{type:"link",onClick:function(){return N(t)}},n.name),h.default.createElement(g.default,null,"管理员")):h.default.createElement(b.default,{type:"link",onClick:function(){return N(t)}},n.name)}},{title:"角色类型",dataIndex:"group",render:function(e){return W(e)}},{title:"操作",dataIndex:"action",render:function(e,t){var r=t.role,n=t.businessType,a=t.id;return h.default.createElement(v.default,null,0===(null==r?void 0:r.defaultRole)&&h.default.createElement(p.default,{title:"设置默认"},h.default.createElement(m.default,{onClick:function(){return F(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),(0===n||"system"!==r.group)&&h.default.createElement(p.default,{title:"删除"},h.default.createElement(s.default,{onClick:function(){return B(a)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}];(0,h.useEffect)((function(){(0,d.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(A);case 2:case"end":return e.stop()}}),e)})))(),L(A)}),[A]);var F=function(){var e=(0,d.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:if(e.sent.code){e.next=6;break}return e.next=6,L(A);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,d.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e){z(e)},W=function(e){switch(e){case"system":return"内置";case"custom":default:return t("privilege-role.custom")}},G=function(){var e=(0,d.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!1),e.next=3,L(A);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,d.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:if(e.sent.code){e.next=6;break}return e.next=6,L(A);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return h.default.createElement("div",{className:"tiklab_domain_role"},M?h.default.createElement(P.DmRoleDetail,{roleDetailParams:M,domainId:n,close:function(){z(null)}}):h.default.createElement("div",{className:"tiklab_domain_role_table"},h.default.createElement(j.TitleAction,{title:"项目域角色列表",style:{paddingLeft:8}},h.default.createElement(b.default,{onClick:function(){R(!0)},type:"primary",icon:h.default.createElement(f.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},t("privilege-role.addRole"))),h.default.createElement(i.default,null,h.default.createElement(o.default,{span:24},h.default.createElement(c.default,{columns:C,dataSource:a,rowKey:function(e){return e.id},pagination:!1})))),h.default.createElement(P.DmRoleCreate,(0,l.default)({},e,{visible:D,domainId:n,handleCancel:G})))})));t.default=k},825:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DmRoleCreate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"DmRoleDetail",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"DmRolePeople",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"DomainRolePromise",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"DomainRoleUserCreate",{enumerable:!0,get:function(){return o.default}});var a=n(r(826)),u=n(r(827)),l=n(r(636)),i=n(r(634)),o=n(r(635))},826:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(80);var a=n(r(26)),u=n(r(51));r(116);var l=n(r(20)),i=n(r(130)),o=n(r(0)),c=r(46),f=r(458);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(e){var t=e.visible,r=e.handleCancel,n=e.domainId,u=e.privilegeDomainRoleStore.createDomainRoleAction,d=(0,c.useTranslation)().t,p=l.default.useForm(),m=(0,i.default)(p,1)[0];return o.default.createElement(f.BaseModal,{title:"新增项目域角色",visible:t,onOk:function(){m.submit()},onCancel:r,destroyOnClose:!0,cancelText:d("privilege-common.cancel"),okText:d("privilege-common.save")},o.default.createElement(l.default,{form:m,preserve:!1,onFinish:function(e){var t={domainId:n,businessType:0,role:s({},e)};u(t).then((function(e){0===e.code&&r()}))},layout:"vertical"},o.default.createElement(l.default.Item,{label:d("privilege-role.roleName"),name:"name",rules:[{required:!0,message:"用户名不能包含非法字符，如&,%，&，#……等"}]},o.default.createElement(a.default,{placeholder:d("privilege-role.roleName")})),o.default.createElement(l.default.Item,{label:d("privilege-desc"),name:"desc"},o.default.createElement(a.default,{placeholder:d("privilege-desc")}))))};t.default=p},827:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(461));r(45);var u=n(r(23));r(48);var l=n(r(21));r(50);var i=n(r(19));r(260);var o=n(r(136)),c=n(r(0)),f=r(46),d=n(r(634)),s=n(r(636)),p=r(458),m=o.default.TabPane,v=function(e){var t=(0,f.useTranslation)().t,r=e.roleDetailParams,n=e.domainId,v=e.bgroup,g=[{click:e.close,breadcrumbName:"项目域角色"},{path:"first",breadcrumbName:r.role.name||"角色详情"}];return c.default.createElement("div",{className:"tiklab_domain_role_detail"},c.default.createElement(l.default,null,c.default.createElement(i.default,{span:24},c.default.createElement(p.BreadCrumb,{routes:g}))),c.default.createElement(l.default,null,c.default.createElement(u.default,null,c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"名称:"),c.default.createElement("span",null,r.role.name)),c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"类型:"),c.default.createElement("span",null,"system"===r.group?"内置":"自定义")))),c.default.createElement(o.default,{defaultActiveKey:"people"},c.default.createElement(m,{tab:t("privilege-role.people"),key:"people"},c.default.createElement(d.default,(0,a.default)({},e,{group:r.group,dmRoleDetail:r,domainId:n,bgroup:v}))),c.default.createElement(m,{tab:t("privilege-role.promise"),key:"promise"},c.default.createElement(s.default,(0,a.default)({},e,{group:r.group,roleDetail:r,bgroup:v})))))};t.default=v},828:function(e,t,r){"use strict";r.r(t)},829:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(830)).default;t.default=a},830:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(189)),u=(n(r(0)),r(61)),l=r(6),i=r(173),o=["code","domainId","systemRoleStore"],c=(0,u.inject)(i.SYSTEM_ROLE_STORE)((0,u.observer)((function(e){var t=e.code,r=void 0===t?"":t,n=e.domainId,u=e.systemRoleStore,i=(0,a.default)(e,o),c=u.domainPermissions,f=(0,l.getUser)().userId;return c["".concat(f,"_").concat(n)]&&c["".concat(f,"_").concat(n)].includes(r)?i.children:null})));t.default=c},831:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(832)).default;t.default=a},832:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(50);var l=n(r(19));r(48);var i=n(r(21));r(80);var o=n(r(26)),c=n(r(321));r(82);var f=n(r(31)),d=n(r(336)),s=n(r(189)),p=n(r(190)),m=n(r(51));r(45);var v=n(r(23)),g=n(r(318)),b=n(r(323));r(171);var y=n(r(33)),h=n(r(319)),O=n(r(130)),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=M(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),w=r(61),P=r(4),j=r(46),S=r(567),k=r(650),_=n(r(638)),D=r(173),R=n(r(639)),x=r(175),I=r(640),A=r(458);r(836);var U=["children","sort"],T=["children","sort"];function M(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(M=function(e){return e?r:t})(e)}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,m.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=(0,w.inject)(D.PRIVILEGE_PROJECT_FEATURE_STORE,D.PRIVILEGE_SYSTEM_STORE)((0,w.observer)((function(e){var t=(0,j.useTranslation)().t,r=e.privilegeProjectFeatureStore,n=e.privilegeSystemStore,a=n.deleteFunctionAction,w=n.getFunctionListListAction,D=n.updateFunctionSortAction,M=r.privilegeProjectTreeData,z=r.getDmPrivilegeTree,F=(0,E.useState)(""),L=(0,O.default)(F,2),N=L[0],W=L[1],G=(0,E.useState)(!1),B=(0,O.default)(G,2),K=B[0],V=B[1],J=(0,E.useState)({}),q=(0,O.default)(J,2),Y=q[0],H=q[1],$=(0,E.useState)({}),Z=(0,O.default)($,2),Q=Z[0],X=Z[1],ee={type:"2",pageParam:{pageSize:99999,currentPage:1}},te=(0,E.useState)(ee),re=(0,O.default)(te,2),ne=re[0],ae=re[1],ue=[{title:t("privilege-feature-name"),dataIndex:"name",key:"name"},{title:t("privilege-feature-code"),dataIndex:"code",key:"code"},{title:"操作",dataIndex:"action",width:"10%",render:function(e,t){return E.default.createElement(v.default,{size:"middle"},!t.parentFunction&&E.default.createElement(y.default,{title:"新增"},E.default.createElement(h.default,{onClick:function(){return ce(t.id)}})),E.default.createElement(y.default,{title:"编辑"},E.default.createElement(b.default,{onClick:function(){return de(t)}})),!t.children&&E.default.createElement(y.default,{title:"删除"},E.default.createElement(g.default,{onClick:function(){return se(t)}})))}}];(0,E.useEffect)((function(){le()}),[ne]);var le=function(){w(ne).then((function(e){if(!e.code){var t=oe(e.data);z(t)}}))},ie=function(){w(ee).then((function(e){if(!e.code){var t=oe(e.data);z(t)}}))},oe=function(e){var t=(0,x.sort)(e.map((function(e){return!e.parentFunction&&e})).filter(Boolean)),r=e.map((function(e){return e.parentFunction&&e.parentFunction.id&&e})).filter(Boolean),n=[];return t.forEach((function(e){var t=e.id,a=(0,x.sort)(r.filter((function(e){return e.parentFunction.id===t})));a.length>0?n.push(C(C({},e),{},{children:a})):n.push(e)})),n},ce=(0,E.useCallback)((function(e){W(e),V(!0)}),[]),fe=(0,E.useCallback)((function(){W(""),H({}),V(!1),ie()}),[]),de=(0,E.useCallback)((function(e){H(e),V(!0)}),[]),se=(0,E.useCallback)((function(e){a(e.id).then((function(e){e.code||le()}))}),[]),pe=(0,E.useCallback)((function(e){var t,r=e.dragId,n=e.dropId,a=e.drag,u=e.drop,l=a.sort,i=-1,o=[],c=[],f={},d={};if(u.children){var m=[],v=Q[n],g=u.children[0];if(v){var b=ve(g.id);f=C(C({},a),{},{parentFunction:b.parentFunction}),l<b.sort?(m=[f].concat((0,p.default)(u.children)),me(m).then((function(e){ie()}))):(i=u.children.findIndex((function(e){return e.id===b.id})),u.children.splice(i,0,a),u.children.forEach((function(e){c.push(e.sort)})),o=(0,I.sortNum)(c),u.children=u.children.map((function(e,t){return C(C({},e),{},{sort:o[t]})})),me(u.children).then((function(e){ie()})))}}if(u.parentFunction){var y=u.parentFunction.id,h=ve(y);i=(t=h.children.filter((function(e){return e.id!==r}))).findIndex((function(e){return e.id===u.id})),t.splice(i,0,C(C({},a),{},{parentFunction:h.children[0].parentFunction})),t.forEach((function(e){c.push(e.sort)})),o=(0,I.sortNum)(c),h.children=t.map((function(e,t){return C(C({},e),{},{sort:o[t]})})),me(h.children).then((function(e){ie()}))}else{a.children;var O=a.sort,E=(0,s.default)(a,U),w=(u.children,u.sort),P=(0,s.default)(u,T);if(a.parentFunction&&!u.parentFunction){a.parentFunction.id;d=C(C({},P),{},{parentFunction:u.parentFunction,sort:O}),f=C(C({},E),{},{parentFunction:u.parentFunction,sort:w}),me([d,f]).then((function(e){ie()}))}else{var j=[C(C({},E),{},{sort:w}),C(C({},P),{},{sort:O})];me(j).then((function(e){ie()}))}}}),[M,Q]),me=function(e){return D({list:e})},ve=(0,E.useCallback)((function(e){var t={};return function r(n){for(var a=0;a<n.length;a++){var u=n[a];if(u.id===e){t=u;break}u.children&&u.children.length>0&&r(u.children)}return t}((0,P.toJS)(M)),t}),[M]);return E.default.createElement("div",{className:"privilege-dm"},E.default.createElement("div",{className:"privilege-dm_content"},E.default.createElement(A.TitleAction,{title:"项目功能管理",style:{paddingLeft:8}},E.default.createElement(f.default,{onClick:function(){return V(!0)},type:"primary",icon:E.default.createElement(d.default,null)},t("privilege-add-feature"))),E.default.createElement(i.default,null,E.default.createElement(l.default,{span:24},E.default.createElement(i.default,{justify:"space-between",style:{paddingBottom:16}},E.default.createElement(o.default,{placeholder:t("privilege-search")+t("privilege-orga-name"),onPressEnter:function(e){return function(e){var t=e.target.value;ae(C(C({},ne),{},{name:t}))}(e)},style:{width:240},prefix:E.default.createElement(c.default,null)})))),E.default.createElement(i.default,null,E.default.createElement(l.default,{span:24,id:"project-drag-sorting"},E.default.createElement(S.DndProvider,{backend:k.HTML5Backend},E.default.createElement(u.default,{dataSource:(0,P.toJS)(M),columns:ue,rowKey:"id",tableLayout:"fixed",pagination:!1,components:{body:{row:R.default}},onRow:function(e,t){return{record:e,data:(0,P.toJS)(M),index:t,moveRow:pe}},expandable:{onExpand:function(e,t){X(C(C({},Q),{},(0,m.default)({},t.id,e)))}}}))))),E.default.createElement(_.default,{data:M,editData:Y,visible:K,cancelAdd:fe,parentId:N,urlType:"project"}))})));t.default=F},836:function(e,t,r){"use strict";r.r(t)},837:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(838)).default;t.default=a},838:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(48);var u=n(r(21));r(50);var l=n(r(19));r(81);var i=n(r(34)),o=n(r(319)),c=(n(r(189)),n(r(51)),n(r(318))),f=n(r(326));r(171);var d=n(r(33)),s=n(r(323));r(45);var p=n(r(23));r(257);var m=n(r(134));r(82);var v=n(r(31)),g=n(r(130)),b=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=j(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),y=r(61),h=r(46),O=n(r(641)),E=r(839),w=r(458),P=r(173);r(841);function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(j=function(e){return e?r:t})(e)}var S=(0,y.inject)(P.PRIVILEGE_PROJECT_ROLE_STORE,P.SYSTEM_ROLE_STORE)((0,y.observer)((function(e){var t=e.privilegeProjectRoleStore,r=e.systemRoleStore,n=e.isBase,a=void 0!==n&&n,y=(0,h.useTranslation)().t,P=t.getProjectRoles,j=t.privilegeProjectRole,S=r.deleteRoleAction,k=r.findRoleListAction,_=r.setDefaultRoleAction,D=(0,b.useState)(!1),R=(0,g.default)(D,2),x=R[0],I=R[1],A=(0,b.useState)({}),U=(0,g.default)(A,2),T=U[0],M=U[1],z=(0,b.useState)(null),C=(0,g.default)(z,2),F=C[0],L=C[1],N=(0,b.useState)(""),W=(0,g.default)(N,2),G=W[0],B=W[1],K=(0,b.useState)({type:"2"}),V=(0,g.default)(K,2),J=V[0],q=(V[1],[{title:"角色名称",dataIndex:"name",render:function(e,t){var r=t.businessType,n=t.defaultRole;return 1===r&&1===n?b.default.createElement(p.default,null,b.default.createElement(v.default,{type:"link",onClick:function(){return ee(t)}},e),b.default.createElement(m.default,{color:"#87d068"},"默认"),b.default.createElement(m.default,null,"管理员")):1===n?b.default.createElement(p.default,null,b.default.createElement(v.default,{type:"link",onClick:function(){return ee(t)}},e),b.default.createElement(m.default,{color:"#87d068"},"默认")):1===r?b.default.createElement(p.default,null,b.default.createElement(v.default,{type:"link",onClick:function(){return ee(t)}},e),b.default.createElement(m.default,null,"管理员")):b.default.createElement(v.default,{type:"link",onClick:function(){return ee(t)}},e)}},{title:"类型",dataIndex:"group",render:function(e){return te(e)}},{title:"成员数",dataIndex:"user"},{title:"操作",dataIndex:"action",render:function(e,t){return a?b.default.createElement(p.default,null,b.default.createElement(d.default,{title:"编辑"},b.default.createElement(s.default,{onClick:function(){return $(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.defaultRole&&b.default.createElement(d.default,{title:"设置默认"},b.default.createElement(f.default,{onClick:function(){return H(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),b.default.createElement(d.default,{title:"删除"},b.default.createElement(c.default,{onClick:function(){return Y(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))):b.default.createElement(p.default,null,b.default.createElement(d.default,{title:"编辑"},b.default.createElement(s.default,{onClick:function(){return $(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.defaultRole&&b.default.createElement(d.default,{title:"设置默认"},b.default.createElement(f.default,{onClick:function(){return H(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.businessType&&b.default.createElement(d.default,{title:"删除"},b.default.createElement(c.default,{onClick:function(){return Y(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}]);(0,b.useEffect)((function(){Z(J)}),[J]);var Y=function(e){S(e).then((function(e){e.code||Z(J)}))},H=function(e){_(e).then((function(e){e.code||Z(J)}))},$=function(e){M(e),I(!0)},Z=function(e){k(e).then((function(e){0===e.code&&P(e.data)}))},Q=(0,b.useCallback)((function(){M({}),I(!1),Z(J)}),[x]),X=function(e){B(e),I(!0)},ee=function(e){L(e)},te=function(e){switch(e){case"system":return"内置";case"custom":default:return y("privilege-role.custom")}};return b.default.createElement("div",{className:"tiklab_project_role"},F?b.default.createElement(E.ProjectRoleDetail,{roleDetailParams:F,close:function(){L(null)}}):b.default.createElement("div",{className:"tiklab_project_role_table"},b.default.createElement(w.TitleAction,{title:"项目角色",style:{paddingLeft:8}},b.default.createElement(p.default,null,a?b.default.createElement(v.default,{onClick:function(){return X("system")},icon:b.default.createElement(o.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},y("privilege-role.addSystemRole")):b.default.createElement(v.default,{onClick:function(){return X("custom")},icon:b.default.createElement(o.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}}),type:"primary"},y("privilege-role.addRole")))),b.default.createElement(u.default,null,b.default.createElement(l.default,{span:24},b.default.createElement(i.default,{columns:q,dataSource:j,rowKey:function(e){return e.id},pagination:!1})))),b.default.createElement(O.default,{visible:x,cancel:Q,editData:T,group:G,urlType:"project"}))})));t.default=S},839:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ProjectRoleDetail",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"ProjectRoleDetailPeople",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"ProjectRoleDetailPromiss",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"ProjectRoleUserAdd",{enumerable:!0,get:function(){return i.default}});var a=n(r(840)),u=n(r(645)),l=n(r(642)),i=n(r(643))},840:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(461));r(45);var u=n(r(23));r(48);var l=n(r(21));r(50);var i=n(r(19));r(260);var o=n(r(136)),c=n(r(0)),f=r(46),d=n(r(642)),s=n(r(645)),p=r(458),m=o.default.TabPane,v=function(e){var t=e.roleDetailParams,r=e.close,n=(0,f.useTranslation)().t,v=[{click:r,breadcrumbName:t.name||"角色详情"}];return c.default.createElement("div",{className:"tiklab_project_role_detail"},c.default.createElement(l.default,null,c.default.createElement(i.default,{span:24},c.default.createElement(p.BreadCrumb,{routes:v}))),c.default.createElement(l.default,null,c.default.createElement(u.default,null,c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"名称:"),c.default.createElement("span",null,t.name)),c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"类型:"),c.default.createElement("span",null,"system"===t.group?"内置":"自定义")))),c.default.createElement(o.default,{defaultActiveKey:"people"},c.default.createElement(m,{tab:n("privilege-role.people"),key:"people"},c.default.createElement(d.default,(0,a.default)({},e,{group:t.group,roleDetail:t}))),c.default.createElement(m,{tab:n("privilege-role.promise"),key:"promise"},c.default.createElement(s.default,(0,a.default)({},e,{group:t.group,roleDetail:t})))))};t.default=v},841:function(e,t,r){"use strict";r.r(t)},842:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(843)).default;t.default=a},843:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(37));r(48);var l=n(r(21));r(50);var i=n(r(19));r(81);var o=n(r(34));r(82);var c=n(r(31)),f=n(r(319)),d=n(r(117)),s=n(r(318)),p=n(r(326));r(171);var m=n(r(33)),v=n(r(323));r(45);var g=n(r(23));r(257);var b=n(r(134)),y=n(r(130)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=k(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),O=r(61),E=r(46),w=n(r(641)),P=r(173),j=r(844),S=r(458);function k(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(k=function(e){return e?r:t})(e)}r(846);var _=(0,O.inject)(P.SYSTEM_ROLE_STORE)((0,O.observer)((function(e){var t=e.systemRoleStore,r=e.isBase,n=void 0!==r&&r,a=(0,E.useTranslation)().t,O=t.findRoleListAction,P=t.deleteRoleAction,k=t.privilegeSystemRole,_=t.setDefaultRoleAction,D=(0,h.useState)(!1),R=(0,y.default)(D,2),x=R[0],I=R[1],A=(0,h.useState)({}),U=(0,y.default)(A,2),T=U[0],M=U[1],z=(0,h.useState)(""),C=(0,y.default)(z,2),F=C[0],L=C[1],N=(0,h.useState)(null),W=(0,y.default)(N,2),G=W[0],B=W[1],K=(0,h.useState)({}),V=(0,y.default)(K,2),J=V[0],q=(V[1],[{title:"角色名称",dataIndex:"name",render:function(e,t){var r=t.businessType,n=t.defaultRole;return 1===r&&1===n?h.default.createElement("div",null,h.default.createElement("a",{onClick:function(){return ee(t)}},e),h.default.createElement(g.default,null,h.default.createElement(b.default,{color:"#87d068",style:{marginLeft:8,marginRight:0}},"默认"),h.default.createElement(b.default,{style:{marginLeft:8,marginRight:0}},"管理员"))):1===n?h.default.createElement("div",null,h.default.createElement("a",{onClick:function(){return ee(t)}},e),h.default.createElement(b.default,{color:"#87d068",style:{marginLeft:8,marginRight:0}},"默认")):1===r?h.default.createElement("div",null,h.default.createElement("a",{type:"link",onClick:function(){return ee(t)}},e),h.default.createElement(b.default,{style:{marginLeft:8,marginRight:0}},"管理员")):h.default.createElement("a",{type:"link",onClick:function(){return ee(t)}},e)}},{title:"类型",dataIndex:"group",render:function(e){return te(e)}},{title:"操作",dataIndex:"action",render:function(e,t){return n?h.default.createElement(g.default,null,h.default.createElement(m.default,{title:"编辑"},h.default.createElement(v.default,{onClick:function(){return H(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.defaultRole&&h.default.createElement(m.default,{title:"设置默认"},h.default.createElement(p.default,{onClick:function(){return $(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),h.default.createElement(m.default,{title:"删除"},h.default.createElement(s.default,{onClick:function(){return Y(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}}))):h.default.createElement(g.default,null,h.default.createElement(m.default,{title:"编辑"},h.default.createElement(v.default,{onClick:function(){return H(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.defaultRole&&h.default.createElement(m.default,{title:"设置默认"},h.default.createElement(p.default,{onClick:function(){return $(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),0===t.businessType&&h.default.createElement(m.default,{title:"删除"},h.default.createElement(s.default,{onClick:function(){return Y(t.id)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}]);(0,h.useEffect)((function(){Z(J)}),[J]);var Y=function(e){P(e).then((function(e){e.code||Z(J)}))},H=function(e){M(e),I(!0)},$=function(e){_(e).then((function(e){e.code||Z(J)}))},Z=function(){var e=(0,d.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=(0,h.useCallback)((function(){M({}),I(!1),Z(J)}),[x]),X=function(e){L(e),I(!0)},ee=function(e){B(e)},te=function(e){switch(e){case"system":return"内置";case"custom":default:return a("privilege-role.custom")}};return h.default.createElement("div",{className:"tiklab_system_role"},G?h.default.createElement(j.RoleDetail,{roleDetailParams:G,close:function(){B(null)}}):h.default.createElement("div",{className:"tiklab_system_role_main"},h.default.createElement(S.TitleAction,{title:"角色",style:{paddingLeft:8}},h.default.createElement(g.default,null,n?h.default.createElement(c.default,{onClick:function(){return X("system")},icon:h.default.createElement(f.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},a("privilege-role.addSystemRole")):h.default.createElement(c.default,{onClick:function(){return X("custom")},type:"primary",icon:h.default.createElement(f.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},a("privilege-role.addRole")))),h.default.createElement(l.default,null,h.default.createElement(i.default,{span:24},h.default.createElement(o.default,{columns:q,dataSource:k,rowKey:function(e){return e.id},pagination:!1})))),h.default.createElement(w.default,{visible:x,cancel:Q,editData:T,group:F,urlType:"system"}))})));t.default=_},844:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RoleDetail",{enumerable:!0,get:function(){return a.default}});var a=n(r(845));n(r(646)),n(r(647)),n(r(648))},845:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(461));r(45);var u=n(r(23));r(48);var l=n(r(21));r(50);var i=n(r(19));r(260);var o=n(r(136)),c=n(r(0)),f=n(r(646)),d=n(r(648)),s=r(46),p=r(458),m=o.default.TabPane,v=function(e){var t=e.roleDetailParams,r=e.close,n=(0,s.useTranslation)().t,v=[{click:r,breadcrumbName:t.name||"角色详情"}];return c.default.createElement("div",{className:"tiklab_system_role_detail"},c.default.createElement(l.default,null,c.default.createElement(i.default,{span:24},c.default.createElement(p.BreadCrumb,{routes:v}))),c.default.createElement(l.default,null,c.default.createElement(u.default,null,c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"名称:"),c.default.createElement("span",null,t.name)),c.default.createElement("div",{className:"label_item"},c.default.createElement("label",null,"类型:"),c.default.createElement("span",null,"system"===t.group?"内置":"自定义")))),c.default.createElement(o.default,{defaultActiveKey:"people"},c.default.createElement(m,{tab:n("privilege-role.people"),key:"people"},c.default.createElement(f.default,(0,a.default)({},e,{group:t.group,roleDetail:t}))),c.default.createElement(m,{tab:n("privilege-role.promise"),key:"promise"},c.default.createElement(d.default,(0,a.default)({},e,{group:t.group,roleDetail:t})))))};t.default=v},846:function(e,t,r){"use strict";r.r(t)},847:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(848)).default;t.default=a},848:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(81);var u=n(r(34));r(50);var l=n(r(19));r(48);var i=n(r(21));r(80);var o=n(r(26)),c=n(r(321));r(82);var f=n(r(31)),d=n(r(189)),s=n(r(37)),p=n(r(190)),m=n(r(51)),v=n(r(117));r(45);var g=n(r(23)),b=n(r(318)),y=n(r(323));r(171);var h=n(r(33)),O=n(r(319)),E=n(r(130)),w=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=M(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),P=r(61),j=r(46),S=r(4),k=r(567),_=r(650),D=r(173),R=n(r(639)),x=n(r(638)),I=r(458),A=r(640);r(849);var U=["children","sort"],T=["children","sort"];function M(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(M=function(e){return e?r:t})(e)}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,m.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=(0,P.inject)(D.PRIVILEGE_SYSTEM_STORE)((0,P.observer)((function(e){var t=(0,j.useTranslation)().t,r=e.privilegeSystemStore,n=r.privilegeSystemTreeData,a=r.getFunctionListListAction,P=r.deleteFunctionAction,D=r.updateFunctionSortAction,M=(0,w.useState)(""),z=(0,E.default)(M,2),F=z[0],L=z[1],N=(0,w.useState)(!1),W=(0,E.default)(N,2),G=W[0],B=W[1],K=(0,w.useState)({}),V=(0,E.default)(K,2),J=V[0],q=V[1],Y=(0,w.useState)({}),H=(0,E.default)(Y,2),$=H[0],Z=H[1],Q=(0,w.useState)({pageParam:{pageSize:9999,currentPage:1}}),X=(0,E.default)(Q,2),ee=X[0],te=X[1],re=[{title:t("privilege-feature-name"),dataIndex:"name",key:"name",className:"column_bg_w"},{title:t("privilege-feature-code"),dataIndex:"code",key:"code"},{title:"操作",dataIndex:"action",className:"column_bg_w",width:"10%",render:function(e,t){return w.default.createElement(g.default,{size:"middle"},!t.parentFunction&&w.default.createElement(h.default,{title:"新增"},w.default.createElement(O.default,{onClick:function(){return ae(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),w.default.createElement(h.default,{title:"编辑"},w.default.createElement(y.default,{onClick:function(){return le(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})),!t.children&&w.default.createElement(h.default,{title:"删除"},w.default.createElement(b.default,{onClick:function(){return ie(t)},style:{fontSize:"var(--tiklab-icon-size-16)"}})))}}];(0,w.useEffect)((function(){(0,v.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:case"end":return e.stop()}}),e)})))()}),[ee]);var ne=function(){var e=(0,v.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(ee);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=(0,w.useCallback)((function(e){L(e.id),B(!0)}),[]),ue=function(){var e=(0,v.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(""),q({}),B(!1),e.next=5,ne();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(e){q(e),B(!0)},ie=function(){var e=(0,v.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t.id);case 2:if(e.sent.code){e.next=6;break}return e.next=6,ne();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=(0,w.useCallback)(function(){var e=(0,v.default)(s.default.mark((function e(t){var r,n,a,u,l,i,o,c,f,m,v,g,b,y,h,O,E,w,P,j,S,k;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.dragId,n=t.dropId,a=t.drag,u=t.drop,l=a.sort,i=-1,o=[],c=[],f={},m={},!u.children){e.next=31;break}if([],g=$[n],b=u.children[0],!g){e.next=31;break}if(y=fe(b.id),f=C(C({},a),{},{parentFunction:y.parentFunction}),!(l<y.sort)){e.next=22;break}return v=[f].concat((0,p.default)(u.children)),e.next=18,ce(v);case 18:return e.next=20,ne();case 20:e.next=31;break;case 22:return i=u.children.findIndex((function(e){return e.id===y.id})),u.children.splice(i,0,a),u.children.forEach((function(e){c.push(e.sort)})),o=(0,A.sortNum)(c),u.children=u.children.map((function(e,t){return C(C({},e),{},{sort:o[t]})})),e.next=29,ce(u.children);case 29:return e.next=31,ne();case 31:u.parentFunction?(O=u.parentFunction.id,E=fe(O),h=E.children.filter((function(e){return e.id!==r})),i=h.findIndex((function(e){return e.id===u.id})),h.splice(i,0,C(C({},a),{},{parentFunction:E.children[0].parentFunction})),h.forEach((function(e){c.push(e.sort)})),o=(0,A.sortNum)(c),E.children=h.map((function(e,t){return C(C({},e),{},{sort:o[t]})})),ce(E.children).then((function(e){ne()}))):(a.children,w=a.sort,P=(0,d.default)(a,U),u.children,j=u.sort,S=(0,d.default)(u,T),a.parentFunction&&!u.parentFunction?(a.parentFunction.id,m=C(C({},S),{},{parentFunction:u.parentFunction,sort:w}),f=C(C({},P),{},{parentFunction:u.parentFunction,sort:j}),ce([m,f]).then((function(e){ne()}))):(k=[C(C({},P),{},{sort:j}),C(C({},S),{},{sort:w})],ce(k).then((function(e){ne()}))));case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,$]),ce=function(){var e=(0,v.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={list:t},e.next=3,D(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=(0,w.useCallback)((function(e){var t={};return function r(n){for(var a=0;a<n.length;a++){var u=n[a];if(u.id===e){t=u;break}u.children&&u.children.length>0&&r(u.children)}return t}((0,S.toJS)(n)),t}),[n]);return w.default.createElement("div",{className:"systemFeature"},w.default.createElement("div",{className:"systemFeature_content"},w.default.createElement(I.TitleAction,{title:"功能管理",style:{paddingLeft:8}},w.default.createElement(f.default,{onClick:function(){return B(!0)},type:"primary",icon:w.default.createElement(O.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})},t("privilege-add-feature"))),w.default.createElement(i.default,null,w.default.createElement(l.default,{span:24},w.default.createElement(i.default,{justify:"space-between",style:{paddingBottom:16}},w.default.createElement(o.default,{placeholder:t("privilege-search")+t("privilege-orga-name"),onPressEnter:function(e){return function(e){var t=e.target.value;te(C(C({},ee),{},{name:t}))}(e)},style:{width:300},prefix:w.default.createElement(c.default,{style:{fontSize:"var(--tiklab-icon-size-16)"}})})))),w.default.createElement(i.default,null,w.default.createElement(l.default,{span:24,id:"drag-sorting"},w.default.createElement(k.DndProvider,{backend:_.HTML5Backend},w.default.createElement(u.default,{dataSource:(0,S.toJS)(n),columns:re,rowKey:"id",tableLayout:"fixed",pagination:!1,components:{body:{row:R.default}},onRow:function(e,t){return{record:e,data:(0,S.toJS)(n),index:t,moveRow:oe}},expandable:{onExpand:function(e,t){Z(C(C({},$),{},(0,m.default)({},t.id,e)))}}}))))),w.default.createElement(x.default,{data:n,editData:J,visible:G,cancelAdd:ue,parentId:F,urlType:"system"}))})));t.default=F},849:function(e,t,r){"use strict";r.r(t)},850:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(851)).default;t.default=a},851:function(e,t,r){"use strict";var n=r(73),a=r(255);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=n(r(130));r(322);var l=n(r(144)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(0)),o=r(61),c=r(852);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}r(853);var d=l.default.SubMenu,s=(0,c.scopedClassMaker)("privilege-header"),p=(0,o.observer)((function(e){var t=e.className,r=e.onSelectMenu,n=e.allPromise,a=void 0===n?[]:n,o=(0,i.useState)(e.selectedKeys||[]),c=(0,u.default)(o,2),f=c[0],p=c[1],m=(0,i.useState)(e.openKeys||[]),v=(0,u.default)(m,2),g=v[0],b=v[1];(0,i.useEffect)((function(){e.selectedKeys.toString()!==f.toString()&&p(e.selectedKeys),e.openKeys.toString()!==g.toString()&&b(e.openKeys)}),[e.selectedKeys,e.openKeys]);return i.default.createElement("div",{className:s("menu",{extra:[t].join(" ")})},i.default.createElement(l.default,{theme:"light",mode:"inline",className:"menu-wrap",defaultSelectedKeys:e.defaultSelectedKeys,defaultOpenKeys:e.defaultOpenKeys,openKeys:g,selectedKeys:f,onClick:function(e){p([e.key]),r(e)},onOpenChange:function(e){var t=e.find((function(e){return-1===g.indexOf(e)}));-1===g.indexOf(t)?b([t]):b(t?[t]:[])},forceSubMenuRender:!0},function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t,r){if(t.children&&t.children.length){if(!t.purviewCode)return i.default.createElement(d,{key:"".concat(t.id),title:t.title,icon:t.icon},e(t.children));if(a.includes(t.purviewCode))return i.default.createElement(d,{key:"".concat(t.id),title:t.title,icon:t.icon},e(t.children))}if(!t.purviewCode||a.includes(t.purviewCode))return i.default.createElement(i.Fragment,{key:"".concat(t.id)},t.divider&&i.default.createElement(l.default.Divider,null),i.default.createElement(l.default.Item,{icon:t.icon,key:"".concat(t.id)},t.title))}))}(e.data)))}));t.default=p},852:function(e,t,r){"use strict";var n=r(73);Object.defineProperty(t,"__esModule",{value:!0}),t.scopedClassMaker=t.default=void 0;var a=n(r(51));var u=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")};t.default=u;t.scopedClassMaker=function(e){return function(t,r){return Object.entries(t instanceof Object?t:(0,a.default)({},t,t)).filter((function(e){return!1!==e[1]})).map((function(e){return e[0]})).map((function(t){return[e,t].filter(Boolean).join("-")})).concat(r&&r.extra||[]).join(" ")}}},853:function(e,t,r){"use strict";r.r(t)}}]);