(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{173:function(e,t,o){"use strict";o.r(t),function(e){o(388);var r,n=o(387),l=o(49),a=o.n(l),i=(o(266),o(257)),c=o(8),s=o.n(c),u=(o(223),o(222)),d=o(83),p=o.n(d),f=o(1),m=o.n(f),g=o(15),b=o(653),y=o(58),h=o(654),S=o(430),I=o(656),O=o(9),N=o(914),v=o(310),k="D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\modules\\config\\config\\config.js";function T(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function j(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?T(Object(o),!0).forEach((function(t){s()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var P="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},w=function(e){var t=e.configStore,o=e.giteeStore,r=e.configDataStore,l=e.githubStore,c=e.match,s=e.pipelineStore,d=t.updateConfigure,g=t.findAllConfigure,y=o.code,T=o.getState,P=l.getAccessToken,w=s.setPipelineId,E=s.pipelineId,L=s.findAllPipelineStatus,A=r.isPrompt,B=r.setIsPrompt,D=r.data,G=r.codeData,H=r.setCodeData,_=r.formInitialValues,C=r.setFormInitialValues,x=r.setLinuxShellBlock,F=r.setUnitShellBlock,M=r.setMavenShellBlock,V=r.setCodeType,J=r.setData,U=r.unitShellBlock,q=r.mavenShellBlock,z=r.linuxShellBlock,K=r.shellBlock,Q=r.orderShellBlock,R=r.setOrderShellBlock,W=u.a.useForm(),X=p()(W,1)[0],Y=Object(N.a)((function(e){return e.pluginStore})),Z=Object(f.useState)(1),$=p()(Z,2),ee=$[0],te=$[1],oe=Object(f.useState)(!1),re=p()(oe,2),ne=re[0],le=re[1],ae=Object(b.a)("code"),ie=Object(b.a)("error"),ce=Object(O.getUser)().userId,se=c.params.pipelineName;Object(f.useEffect)((function(){L(ce).then((function(e){var t=e.data;0===e.code&&t&&t&&t.map((function(e){e.pipelineName===se&&w(e.pipelineId)}))}))}),[]),Object(f.useEffect)((function(){return function(){localStorage.removeItem("gitProofId"),localStorage.removeItem("deployProofId")}}),[]),Object(f.useEffect)((function(){g("").then((function(){H(""),J([]),C({}),X.resetFields(),F(""),M(""),x(""),R("")}))}),[]),Object(f.useEffect)((function(){Y.map((function(e){"gui"===e.id?le(!0):le(!1)}))}),[]),Object(f.useEffect)((function(){if(ae){var e={code:ae,state:1};localStorage.getItem("giteeCode")?y(ae).then((function(t){localStorage.setItem("giteeToken",JSON.stringify(t.data)),localStorage.removeItem("giteeCode"),localStorage.removeItem("githubToken"),T(e),window.close()})):localStorage.getItem("githubCode")&&P(ae).then((function(t){localStorage.setItem("githubToken",t.data),localStorage.removeItem("githubCode"),localStorage.removeItem("giteeToken"),T(e),window.close()}))}ie&&(T({code:ie,state:1}),window.close())}),[ae]),Object(f.useEffect)((function(){if(G&&G.codeType){var e={codeName:_&&_.codeName,codeBranch:_&&_.codeBranch};Object.assign(G,e),H(j({},G))}}),[_]);var ue=function(e){switch(e){case 11:de("test");break;case 21:case 22:de("structure");break;case 31:case 32:de("deploy");break;default:de("git")}C(j({},_)),B(!0)},de=function(e){switch(e){case"git":_.codeName=null,_.codeBranch=null,_.proofName=null,_.gitProofName=null,H(""),V(1);break;case"test":_.testOrder=null,F("");break;case"structure":_.structureAddress=null,_.structureOrder=null,M("");break;case"deploy":_.sshPort=null,_.deployAddress=null,_.sshIp=null,_.sourceAddress=null,_.dockerProofName=null,_.startPort=null,_.mappingPort=null,_.startAddress="",_.deployOrder="",x("")}},pe=function(t){var o,r,n,l,a,c,s,u,p,f=0;switch(G){case"":o=0;break;default:o=1}D&&D.map((function(e,t){e.dataType>10&&e.dataType<20&&(r=t+2,l=e.title,s=e.dataType),e.dataType>20&&e.dataType<30&&(n=t+2,a=e.title,u=e.dataType),e.dataType>30&&e.dataType<40&&(f=t+2,c=e.title,p=e.dataType)}));var m={configureCreateTime:v.a.moment,user:{id:ce},pipeline:{pipelineId:E},pipelineCode:{codeId:localStorage.getItem("codeId"),sort:o,type:G&&G.codeType,codeBranch:t.codeBranch,codeName:t.codeName,proof:{proofId:localStorage.getItem("gitProofId")}},pipelineTest:{testId:localStorage.getItem("testId"),sort:r,testAlias:l,type:s,testOrder:U},pipelineStructure:{structureId:localStorage.getItem("structureId"),sort:n,structureAlias:a,type:u,structureAddress:t.structureAddress,structureOrder:q},pipelineDeploy:{deployId:localStorage.getItem("deployId"),sort:f,deployAlias:c,type:p,deployType:t.deployType,sshIp:0===t.deployType?t.sshIp:null,sshPort:0===t.deployType?t.sshPort:null,deployAddress:0===t.deployType?t.deployAddress:null,sourceAddress:0===t.deployType?t.sourceAddress:null,startShell:0===t.deployType?z:K,startPort:0===t.deployType?t.startPort:null,mappingPort:0===t.deployType?t.mappingPort:null,startAddress:0===t.deployType?t.startAddress:null,deployOrder:0===t.deployType?Q:null,proof:{proofId:localStorage.getItem("deployProofId")}}};d(m).then((function(t){B(!1),e.history.push("/index/task/".concat(se,"/config")),0!==t.code?i.b.error({content:"配置失败",className:"message"}):i.b.success({content:"配置成功",className:"message"})}))};return m.a.createElement(f.Fragment,{__source:{fileName:k,lineNumber:280,columnNumber:9}},m.a.createElement("div",{className:"config-top config-top-width",__source:{fileName:k,lineNumber:281,columnNumber:13}},m.a.createElement(h.a,{view:ee,setView:te,setIsPrompt:B,pipelineId:E,pipelineName:se,userId:ce,isBtn:ne,__source:{fileName:k,lineNumber:282,columnNumber:17}})),1===ee?m.a.createElement(I.a,{del:ue,form:X,onFinish:pe,__source:{fileName:k,lineNumber:294,columnNumber:21}}):m.a.createElement(f.Fragment,{__source:{fileName:k,lineNumber:300,columnNumber:21}},m.a.createElement(n.a,a()({},e,{point:"gui",pluginStore:Y,isModalType:!0,extraProps:{pipelineStore:s,configDataStore:r,onFinish:pe,form:X,del:ue},__source:{fileName:k,lineNumber:301,columnNumber:25}}))),m.a.createElement(S.a,{isPrompt:A,confirmLeave:function(t){0!==t.indexOf("/index/config")&&t&&setTimeout((function(){e.history.push(t)})),B(!1)},__source:{fileName:k,lineNumber:316,columnNumber:13}}))};P(w,"useForm{[form]}\nuseSelector{pluginStore}\nuseState{[view,setView](1)}\nuseState{[isBtn,setIsBtn](false)}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(function(){return[N.a]}));var E,L,A=Object(g.o)(Object(y.b)("configStore","giteeStore","configDataStore","githubStore","pipelineStore")(Object(y.c)(w)));t.default=A,(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(E.register(w,"Config","D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\modules\\config\\config\\config.js"),E.register(A,"default","D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\modules\\config\\config\\config.js")),(L="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&L(e)}.call(this,o(13)(e))},430:function(e,t,o){"use strict";(function(e){o(247);var r,n=o(246),l=o(1),a=o.n(l),i=o(15);(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var c,s,u=function(e){var t=e.isPrompt,o=e.confirmLeave;return a.a.createElement(i.b,{when:t,message:function(e){return!t||(n.a.confirm({title:"有编辑未保存，确定离开吗",okText:"离开",cancelText:"取消",onOk:function(){return o(e.pathname)}}),!1)},__source:{fileName:"D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\common\\prompt\\prompt.js",lineNumber:8,columnNumber:12}})},d=u;t.a=d,(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(c.register(u,"PromptContent","D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\common\\prompt\\prompt.js"),c.register(d,"default","D:\\idea\\pipeline\\doublekit-pipeline-ui\\src\\common\\prompt\\prompt.js")),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&s(e)}).call(this,o(13)(e))}}]);