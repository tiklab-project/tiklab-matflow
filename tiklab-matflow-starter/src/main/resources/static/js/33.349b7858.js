(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{179:function(e,t,o){"use strict";o.r(t),function(e){o(388);var r,a=o(387),l=o(49),c=o.n(l),n=(o(266),o(257)),s=o(8),d=o.n(s),i=(o(223),o(222)),u=o(83),p=o.n(u),f=o(1),m=o.n(f),y=o(9),g=o(914),b=o(311),h=o(656),O=o(654),S=o(15),I=o(58),w=o(653),T="D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\configDetails\\configDetails.js";function N(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function v(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?N(Object(o),!0).forEach((function(t){d()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):N(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var j="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},k=function(e){var t=e.configStore,o=e.giteeStore,r=e.configDataStore,l=e.githubStore,s=e.matFlowStore,d=t.updateConfigure,u=t.findAllConfigure,S=o.code,I=o.getState,N=l.getAccessToken,j=s.matFlowId,k=s.matFlowName,P=r.setIsPrompt,D=r.setData,A=r.data,B=r.codeData,F=r.setCodeData,E=r.formInitialValues,C=r.setFormInitialValues,_=r.setLinuxShellBlock,G=r.setUnitShellBlock,L=r.setMavenShellBlock,H=r.setCodeType,M=r.setOrderShellBlock,V=r.setShellBlock,x=r.mavenShellBlock,J=r.linuxShellBlock,U=r.shellBlock,q=r.deployProofId,z=r.setDeployProofId,K=r.gitProofId,Q=r.setGitProofId,R=r.orderShellBlock,W=r.unitShellBlock,X=i.a.useForm(),Y=p()(X,1)[0],Z=Object(g.a)((function(e){return e.pluginStore})),$=Object(f.useState)(1),ee=p()($,2),te=ee[0],oe=ee[1],re=Object(f.useState)(!1),ae=p()(re,2),le=ae[0],ce=ae[1],ne=Object(w.a)("code"),se=Object(w.a)("error"),de=Object(y.getUser)().userId;Object(f.useEffect)((function(){Z.map((function(e){"gui"===e.id?ce(!0):ce(!1)}))}),[]),Object(f.useEffect)((function(){if(ne){var e={code:ne,state:1};localStorage.getItem("giteeCode")?S(ne).then((function(t){localStorage.setItem("giteeToken",JSON.stringify(t.data)),localStorage.removeItem("giteeCode"),localStorage.removeItem("githubToken"),I(e),window.close()})):localStorage.getItem("githubCode")&&N(ne).then((function(t){localStorage.setItem("githubToken",t.data),localStorage.removeItem("githubCode"),localStorage.removeItem("giteeToken"),I(e),window.close()}))}se&&(I({code:se,state:1}),window.close())}),[ne]),Object(f.useEffect)((function(){if(B&&B.codeType){var e={codeName:E&&E.codeName,codeBranch:E&&E.codeBranch};Object.assign(B,e),F(v({},B))}}),[E,j]);var ie=[1,2,3,4,5,11,21,22,31,32],ue=[];Object(f.useEffect)((function(){j&&u(j).then((function(e){var t=e.data;0===e.code&&(0===t.length?(F(""),D([]),Y.resetFields(),C({}),G(""),L(""),_(""),M(""),Q(""),z("")):(pe(t),fe(t)))}))}),[j]);var pe=function(e){for(var t=0;t<e.length;t++)for(var o=0;o<ie.length;o++){var r=parseInt(e[t].type/10);10*r<ie[o]&&ie[o]<10*(r+1)&&(ie.splice(o,1),o--)}return ie.map((function(e){he(e,"111")}))},fe=function(e){for(var t=0;t<e.length;t++){var o=e[t];o.type<6?me(o):o.type>10&&o.type<20?ye(o):o.type>20&&o.type<30?ge(o):(o.type>30||o.type<40)&&be(o),D([].concat(ue)),Object.assign(E,o),C(v({},E))}},me=function(e){var t={codeId:e.codeId,codeType:e.type,codeName:e.codeName,codeBranch:e.codeBranch},o={gitProofName:e.proof&&e.proof.proofName+"("+e.proof.proofType+")",proofName:e.proof&&e.proof.proofName};Object.assign(E,o),Q(e.proof&&e.proof.proofId),H(e.type),F(t)},ye=function(e){ue.push({dataId:e.testId,title:e.testAlias,dataType:e.type}),G("".concat(e.testOrder?e.testOrder:""))},ge=function(e){ue.push({dataId:e.structureId,title:e.structureAlias,dataType:e.type}),L("".concat(e.structureOrder?e.structureOrder:""))},be=function(e){ue.push({dataId:e.deployId,title:e.deployAlias,dataType:e.type});var t={dockerProofName:e.proof&&e.proof.proofName+"("+e.proof.proofType+")"};Object.assign(E,t),z(e.proof&&e.proof.proofId),M("".concat(e.deployOrder?e.deployOrder:"")),0===e.deployType?_("".concat(e.startShell?e.startShell:"")):V("".concat(e.startShell?e.startShell:""))},he=function(e,t){switch(e){case 11:Oe("test");break;case 21:case 22:Oe("structure");break;case 31:case 32:Oe("deploy");break;default:Oe("git")}C(v({},E)),t||P(!0)},Oe=function(e){switch(e){case"git":E.codeName=null,E.codeBranch=null,E.proofName=null,E.gitProofName=null,F(""),H(1),Q("");break;case"test":E.testOrder=null,G("");break;case"structure":E.structureAddress=null,E.structureOrder=null,L("");break;case"deploy":E.sshPort=null,E.deployAddress=null,E.sshIp=null,E.sourceAddress=null,E.dockerProofName=null,E.startPort=null,E.mappingPort=null,E.startAddress="",E.deployOrder="",_(""),M(""),V(""),z("")}},Se=function(e){var t,o,r,a,l,c,s,i,u,p=0;switch(B){case"":t=0;break;default:t=1}A&&A.map((function(e,t){e.dataType>10&&e.dataType<20&&(o=t+2,a=e.title,s=e.dataType),e.dataType>20&&e.dataType<30&&(r=t+2,l=e.title,i=e.dataType),e.dataType>30&&e.dataType<40&&(p=t+2,c=e.title,u=e.dataType)}));var f={configureCreateTime:b.a.moment,user:{id:de},matFlow:{matflowId:j},matFlowCode:{codeId:E&&E.codeId,sort:t,type:B&&B.codeType,codeBranch:e.codeBranch,codeName:e.codeName,proof:{proofId:K}},matFlowTest:{testId:E&&E.testId,sort:o,testAlias:a,type:s,testOrder:W},matFlowStructure:{structureId:E&&E.structureId,sort:r,structureAlias:l,type:i,structureAddress:e.structureAddress,structureOrder:x},matFlowDeploy:{deployId:E&&E.deployId,sort:p,deployAlias:c,type:u,deployType:e.deployType,sshIp:0===e.deployType?e.sshIp:null,sshPort:0===e.deployType?e.sshPort:null,deployAddress:0===e.deployType?e.deployAddress:null,sourceAddress:0===e.deployType?e.sourceAddress:null,startShell:0===e.deployType?J:U,startPort:0===e.deployType?e.startPort:null,mappingPort:0===e.deployType?e.mappingPort:null,startAddress:0===e.deployType?e.startAddress:null,deployOrder:0===e.deployType?R:null,proof:{proofId:q}}};d(f).then((function(e){P(!1),0!==e.code?n.b.error({content:"配置失败",className:"message"}):n.b.success({content:"配置成功",className:"message"})}))};return m.a.createElement(f.Fragment,{__source:{fileName:T,lineNumber:361,columnNumber:9}},m.a.createElement("div",{className:"config-top",__source:{fileName:T,lineNumber:362,columnNumber:13}},m.a.createElement(O.a,{userId:de,view:te,setView:oe,setIsPrompt:P,matFlowId:j,matFlowName:k,isBtn:le,__source:{fileName:T,lineNumber:363,columnNumber:17}})),1===te?m.a.createElement(h.a,{del:he,form:Y,onFinish:Se,__source:{fileName:T,lineNumber:375,columnNumber:21}}):m.a.createElement(a.a,c()({},e,{point:"gui",pluginStore:Z,isModalType:!0,extraProps:{matFlowStore:s,configDataStore:r,form:Y,onFinish:Se,del:he},__source:{fileName:T,lineNumber:381,columnNumber:21}})))};j(k,"useForm{[form]}\nuseSelector{pluginStore}\nuseState{[view,setView](1)}\nuseState{[isBtn,setIsBtn](false)}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(function(){return[g.a]}));var P,D,A=Object(S.o)(Object(I.b)("configStore","giteeStore","structureStore","configDataStore","githubStore","matFlowStore")(Object(I.c)(k)));t.default=A,(P="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(P.register(k,"ConfigDetails","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\configDetails\\configDetails.js"),P.register(A,"default","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\configDetails\\configDetails.js")),(D="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&D(e)}.call(this,o(13)(e))}}]);