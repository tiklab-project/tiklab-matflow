(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{173:function(e,t,o){"use strict";o.r(t),function(e){o(388);var r,a=o(387),l=o(49),n=o.n(l),c=(o(266),o(257)),s=o(8),i=o.n(s),u=(o(223),o(222)),d=o(83),f=o.n(d),m=o(1),p=o.n(m),b=o(15),g=o(653),y=o(58),h=o(654),w=o(430),S=o(656),O=o(9),N=o(914),v=o(311),k="D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js";function T(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function j(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?T(Object(o),!0).forEach((function(t){i()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var I="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},P=function(e){var t=e.configStore,o=e.giteeStore,r=e.configDataStore,l=e.githubStore,s=e.match,i=e.matFlowStore,d=t.updateConfigure,b=t.findAllConfigure,y=o.code,T=o.getState,I=l.getAccessToken,P=i.setMatFlowName,F=i.setMatFlowId,E=i.matFlowId,L=i.findAllMatFlowStatus,A=r.isPrompt,B=r.setIsPrompt,D=r.data,G=r.codeData,H=r.setCodeData,_=r.formInitialValues,C=r.setFormInitialValues,M=r.setLinuxShellBlock,x=r.setUnitShellBlock,V=r.setMavenShellBlock,J=r.setCodeType,R=r.setData,U=r.unitShellBlock,q=r.mavenShellBlock,z=r.linuxShellBlock,K=r.shellBlock,Q=r.orderShellBlock,W=r.setOrderShellBlock,X=r.setShellBlock,Y=r.deployProofId,Z=r.setDeployProofId,$=r.gitProofId,ee=r.setGitProofId,te=u.a.useForm(),oe=f()(te,1)[0],re=Object(N.a)((function(e){return e.pluginStore})),ae=Object(m.useState)(1),le=f()(ae,2),ne=le[0],ce=le[1],se=Object(m.useState)(!1),ie=f()(se,2),ue=ie[0],de=ie[1],fe=Object(m.useState)(!0),me=f()(fe,2),pe=me[0],be=me[1],ge=Object(g.a)("code"),ye=Object(g.a)("error"),he=Object(O.getUser)().userId,we=s.params.matFlowName;Object(m.useEffect)((function(){P(we),L(he).then((function(e){var t=e.data;0===e.code&&t&&t&&t.map((function(e){e.matFlowName===we&&F(e.matFlowId)}))}))}),[]),Object(m.useEffect)((function(){b("").then((function(){H(""),R([]),C({}),oe.resetFields(),x(""),V(""),M(""),W(""),Z(""),ee("")}))}),[]),Object(m.useEffect)((function(){re.map((function(e){"gui"===e.id?de(!0):de(!1)}))}),[]),Object(m.useEffect)((function(){if(ge){var e={code:ge,state:1};localStorage.getItem("giteeCode")?y(ge).then((function(t){localStorage.setItem("giteeToken",JSON.stringify(t.data)),localStorage.removeItem("giteeCode"),localStorage.removeItem("githubToken"),T(e),window.close()})):localStorage.getItem("githubCode")&&I(ge).then((function(t){localStorage.setItem("githubToken",t.data),localStorage.removeItem("githubCode"),localStorage.removeItem("giteeToken"),T(e),window.close()}))}ye&&(T({code:ye,state:1}),window.close())}),[ge]),Object(m.useEffect)((function(){if(G&&G.codeType){var e={codeName:_&&_.codeName,codeBranch:_&&_.codeBranch};Object.assign(G,e),H(j({},G))}}),[_]);var Se=function(e){switch(e){case 11:Oe("test");break;case 21:case 22:Oe("structure");break;case 31:case 32:Oe("deploy");break;default:Oe("git")}C(j({},_)),B(!0)},Oe=function(e){switch(e){case"git":_.codeName=null,_.codeBranch=null,_.proofName=null,_.gitProofName=null,H(""),J(1),ee("");break;case"test":_.testOrder=null,x("");break;case"structure":_.structureAddress=null,_.structureOrder=null,V("");break;case"deploy":_.sshPort=null,_.deployAddress=null,_.sshIp=null,_.sourceAddress=null,_.dockerProofName=null,_.startPort=null,_.mappingPort=null,_.startAddress="",_.deployOrder="",M(""),W(""),X(""),Z("")}},Ne=function(t){var o,r,a,l,n,s,i,u,f,m=0;switch(G){case"":o=0;break;default:o=1}D&&D.map((function(e,t){e.dataType>10&&e.dataType<20&&(r=t+2,l=e.title,i=e.dataType),e.dataType>20&&e.dataType<30&&(a=t+2,n=e.title,u=e.dataType),e.dataType>30&&e.dataType<40&&(m=t+2,s=e.title,f=e.dataType)}));var p={configureCreateTime:v.a.moment,user:{id:he},matFlow:{matflowId:E},matFlowCode:{codeId:null,sort:o,type:G&&G.codeType,codeBranch:t.codeBranch,codeName:t.codeName,proof:{proofId:$}},matFlowTest:{testId:null,sort:r,testAlias:l,type:i,testOrder:U},matFlowStructure:{structureId:null,sort:a,structureAlias:n,type:u,structureAddress:t.structureAddress,structureOrder:q},matFlowDeploy:{deployId:null,sort:m,deployAlias:s,type:f,deployType:t.deployType,sshIp:0===t.deployType?t.sshIp:null,sshPort:0===t.deployType?t.sshPort:null,deployAddress:0===t.deployType?t.deployAddress:null,sourceAddress:0===t.deployType?t.sourceAddress:null,startShell:0===t.deployType?z:K,startPort:0===t.deployType?t.startPort:null,mappingPort:0===t.deployType?t.mappingPort:null,startAddress:0===t.deployType?t.startAddress:null,deployOrder:0===t.deployType?Q:null,proof:{proofId:Y}}};d(p).then((function(t){B(!1),pe&&e.history.push("/index/task/".concat(we,"/config")),0===t.code?c.b.success({content:"配置成功",className:"message"}):c.b.error({content:"配置失败",className:"message"})}))};return p.a.createElement(m.Fragment,{__source:{fileName:k,lineNumber:283,columnNumber:9}},p.a.createElement("div",{className:"config-top config-top-width",__source:{fileName:k,lineNumber:284,columnNumber:13}},p.a.createElement(h.a,{view:ne,setView:ce,setIsPrompt:B,matFlowId:E,matFlowName:we,userId:he,isBtn:ue,setRunOrSave:be,__source:{fileName:k,lineNumber:285,columnNumber:17}})),1===ne?p.a.createElement(S.a,{del:Se,form:oe,onFinish:Ne,__source:{fileName:k,lineNumber:298,columnNumber:21}}):p.a.createElement(m.Fragment,{__source:{fileName:k,lineNumber:304,columnNumber:21}},p.a.createElement(a.a,n()({},e,{point:"gui",pluginStore:re,isModalType:!0,extraProps:{matFlowStore:i,configDataStore:r,onFinish:Ne,form:oe,del:Se},__source:{fileName:k,lineNumber:305,columnNumber:25}}))),p.a.createElement(w.a,{isPrompt:A,confirmLeave:function(t){0!==t.indexOf("/index/config")&&t&&setTimeout((function(){e.history.push(t)})),B(!1)},__source:{fileName:k,lineNumber:320,columnNumber:13}}))};I(P,"useForm{[form]}\nuseSelector{pluginStore}\nuseState{[view,setView](1)}\nuseState{[isBtn,setIsBtn](false)}\nuseState{[runOrSave,setRunOrSave](true)}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(function(){return[N.a]}));var F,E,L=Object(b.o)(Object(y.b)("configStore","giteeStore","configDataStore","githubStore","matFlowStore")(Object(y.c)(P)));t.default=L,(F="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(F.register(P,"Config","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js"),F.register(L,"default","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js")),(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&E(e)}.call(this,o(13)(e))},430:function(e,t,o){"use strict";(function(e){o(247);var r,a=o(246),l=o(1),n=o.n(l),c=o(15);(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s,i,u=function(e){var t=e.isPrompt,o=e.confirmLeave;return n.a.createElement(c.b,{when:t,message:function(e){return!t||(a.a.confirm({title:"有编辑未保存，确定离开吗",okText:"离开",cancelText:"取消",onOk:function(){return o(e.pathname)}}),!1)},__source:{fileName:"D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js",lineNumber:8,columnNumber:12}})},d=u;t.a=d,(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(u,"PromptContent","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js"),s.register(d,"default","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js")),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,o(13)(e))}}]);