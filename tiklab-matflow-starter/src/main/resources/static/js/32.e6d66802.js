(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{173:function(e,t,o){"use strict";o.r(t),function(e){o(388);var r,a=o(387),l=o(49),n=o.n(l),c=(o(266),o(257)),s=o(8),i=o.n(s),u=(o(223),o(222)),d=o(83),f=o.n(d),m=o(1),p=o.n(m),b=o(15),g=o(653),y=o(58),h=o(654),w=o(430),S=o(656),O=o(9),N=o(914),v=o(310),k="D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js";function T(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function j(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?T(Object(o),!0).forEach((function(t){i()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var I="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},P=function(e){var t=e.configStore,o=e.giteeStore,r=e.configDataStore,l=e.githubStore,s=e.match,i=e.matFlowStore,d=t.updateConfigure,b=t.findAllConfigure,y=o.code,T=o.getState,I=l.getAccessToken,P=i.setMatFlowName,F=i.setMatFlowId,E=i.matFlowId,L=i.findAllMatFlowStatus,A=r.isPrompt,D=r.setIsPrompt,B=r.data,G=r.codeData,H=r.setCodeData,_=r.formInitialValues,C=r.setFormInitialValues,M=r.setLinuxShellBlock,x=r.setUnitShellBlock,V=r.setMavenShellBlock,J=r.setCodeType,R=r.setData,U=r.unitShellBlock,q=r.mavenShellBlock,z=r.linuxShellBlock,K=r.shellBlock,Q=r.orderShellBlock,W=r.setOrderShellBlock,X=r.deployProofId,Y=r.setDeployProofId,Z=r.gitProofId,$=r.setGitProofId,ee=u.a.useForm(),te=f()(ee,1)[0],oe=Object(N.a)((function(e){return e.pluginStore})),re=Object(m.useState)(1),ae=f()(re,2),le=ae[0],ne=ae[1],ce=Object(m.useState)(!1),se=f()(ce,2),ie=se[0],ue=se[1],de=Object(m.useState)(!0),fe=f()(de,2),me=fe[0],pe=fe[1],be=Object(g.a)("code"),ge=Object(g.a)("error"),ye=Object(O.getUser)().userId,he=s.params.matFlowName;Object(m.useEffect)((function(){P(he),L(ye).then((function(e){var t=e.data;0===e.code&&t&&t&&t.map((function(e){e.matFlowName===he&&F(e.matFlowId)}))}))}),[]),Object(m.useEffect)((function(){b("").then((function(){H(""),R([]),C({}),te.resetFields(),x(""),V(""),M(""),W(""),Y(""),$("")}))}),[]),Object(m.useEffect)((function(){oe.map((function(e){"gui"===e.id?ue(!0):ue(!1)}))}),[]),Object(m.useEffect)((function(){if(be){var e={code:be,state:1};localStorage.getItem("giteeCode")?y(be).then((function(t){localStorage.setItem("giteeToken",JSON.stringify(t.data)),localStorage.removeItem("giteeCode"),localStorage.removeItem("githubToken"),T(e),window.close()})):localStorage.getItem("githubCode")&&I(be).then((function(t){localStorage.setItem("githubToken",t.data),localStorage.removeItem("githubCode"),localStorage.removeItem("giteeToken"),T(e),window.close()}))}ge&&(T({code:ge,state:1}),window.close())}),[be]),Object(m.useEffect)((function(){if(G&&G.codeType){var e={codeName:_&&_.codeName,codeBranch:_&&_.codeBranch};Object.assign(G,e),H(j({},G))}}),[_]);var we=function(e){switch(e){case 11:Se("test");break;case 21:case 22:Se("structure");break;case 31:case 32:Se("deploy");break;default:Se("git")}C(j({},_)),D(!0)},Se=function(e){switch(e){case"git":_.codeName=null,_.codeBranch=null,_.proofName=null,_.gitProofName=null,H(""),J(1);break;case"test":_.testOrder=null,x("");break;case"structure":_.structureAddress=null,_.structureOrder=null,V("");break;case"deploy":_.sshPort=null,_.deployAddress=null,_.sshIp=null,_.sourceAddress=null,_.dockerProofName=null,_.startPort=null,_.mappingPort=null,_.startAddress="",_.deployOrder="",M("")}},Oe=function(t){var o,r,a,l,n,s,i,u,f,m=0;switch(G){case"":o=0;break;default:o=1}B&&B.map((function(e,t){e.dataType>10&&e.dataType<20&&(r=t+2,l=e.title,i=e.dataType),e.dataType>20&&e.dataType<30&&(a=t+2,n=e.title,u=e.dataType),e.dataType>30&&e.dataType<40&&(m=t+2,s=e.title,f=e.dataType)}));var p={configureCreateTime:v.a.moment,user:{id:ye},matFlow:{matflowId:E},matFlowCode:{codeId:null,sort:o,type:G&&G.codeType,codeBranch:t.codeBranch,codeName:t.codeName,proof:{proofId:Z}},matFlowTest:{testId:null,sort:r,testAlias:l,type:i,testOrder:U},matFlowStructure:{structureId:null,sort:a,structureAlias:n,type:u,structureAddress:t.structureAddress,structureOrder:q},matFlowDeploy:{deployId:null,sort:m,deployAlias:s,type:f,deployType:t.deployType,sshIp:0===t.deployType?t.sshIp:null,sshPort:0===t.deployType?t.sshPort:null,deployAddress:0===t.deployType?t.deployAddress:null,sourceAddress:0===t.deployType?t.sourceAddress:null,startShell:0===t.deployType?z:K,startPort:0===t.deployType?t.startPort:null,mappingPort:0===t.deployType?t.mappingPort:null,startAddress:0===t.deployType?t.startAddress:null,deployOrder:0===t.deployType?Q:null,proof:{proofId:X}}};d(p).then((function(t){D(!1),me&&e.history.push("/index/task/".concat(he,"/config")),0===t.code?c.b.success({content:"配置成功",className:"message"}):c.b.error({content:"配置失败",className:"message"})}))};return p.a.createElement(m.Fragment,{__source:{fileName:k,lineNumber:279,columnNumber:9}},p.a.createElement("div",{className:"config-top config-top-width",__source:{fileName:k,lineNumber:280,columnNumber:13}},p.a.createElement(h.a,{view:le,setView:ne,setIsPrompt:D,matFlowId:E,matFlowName:he,userId:ye,isBtn:ie,setRunOrSave:pe,__source:{fileName:k,lineNumber:281,columnNumber:17}})),1===le?p.a.createElement(S.a,{del:we,form:te,onFinish:Oe,__source:{fileName:k,lineNumber:294,columnNumber:21}}):p.a.createElement(m.Fragment,{__source:{fileName:k,lineNumber:300,columnNumber:21}},p.a.createElement(a.a,n()({},e,{point:"gui",pluginStore:oe,isModalType:!0,extraProps:{matFlowStore:i,configDataStore:r,onFinish:Oe,form:te,del:we},__source:{fileName:k,lineNumber:301,columnNumber:25}}))),p.a.createElement(w.a,{isPrompt:A,confirmLeave:function(t){0!==t.indexOf("/index/config")&&t&&setTimeout((function(){e.history.push(t)})),D(!1)},__source:{fileName:k,lineNumber:316,columnNumber:13}}))};I(P,"useForm{[form]}\nuseSelector{pluginStore}\nuseState{[view,setView](1)}\nuseState{[isBtn,setIsBtn](false)}\nuseState{[runOrSave,setRunOrSave](true)}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(function(){return[N.a]}));var F,E,L=Object(b.o)(Object(y.b)("configStore","giteeStore","configDataStore","githubStore","matFlowStore")(Object(y.c)(P)));t.default=L,(F="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(F.register(P,"Config","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js"),F.register(L,"default","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\modules\\config\\config\\config.js")),(E="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&E(e)}.call(this,o(13)(e))},430:function(e,t,o){"use strict";(function(e){o(247);var r,a=o(246),l=o(1),n=o.n(l),c=o(15);(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s,i,u=function(e){var t=e.isPrompt,o=e.confirmLeave;return n.a.createElement(c.b,{when:t,message:function(e){return!t||(a.a.confirm({title:"有编辑未保存，确定离开吗",okText:"离开",cancelText:"取消",onOk:function(){return o(e.pathname)}}),!1)},__source:{fileName:"D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js",lineNumber:8,columnNumber:12}})},d=u;t.a=d,(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(u,"PromptContent","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js"),s.register(d,"default","D:\\idea\\pipeline\\tiklab-matflow-ui\\src\\common\\prompt\\prompt.js")),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,o(13)(e))}}]);